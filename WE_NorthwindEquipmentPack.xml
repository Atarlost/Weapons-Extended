<?xml version="1.0" encoding="utf-8"?>

<TranscendenceModule>



	<!-- Gatling Laser Cannon -->

	<ItemType UNID="&nwiGatlingLaser;"
			name=				"Dory Gatling Laser"
			level=				"3"
			value=				"1200"
			mass=				"2500"
			frequency=			"common"
			attributes=			"NWA; EnergyWeapon; MajorItem; Laser"
			showReference=		"true"
			unknownType=		"&itUnknownLaserWeapon2;"
			description=		"The Northwind Armories Dori Gatling Laser Cannon uses multiple independent amplification chambers to achieve phenomenal rates of fire, but suffers from a corresponding heat buildup."

			sortName=			"NW Polearm 2"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"beam"

				damage=				"laser:1d4"
				fireRate=			"2"
				lifetime=			"30"
				powerUse=			"30"

				sound=				"&snLaserCannon;"

				counter=			"temperature"
				counterActivate=	"3"
				counterUpdate=		"-2"
				counterUpdateRate=	"4"
				>
			<Effect>
				<Beam
						beamType=			"laser"
						primaryColor=		"0xf1, 0x5f, 0x2a"
						secondaryColor=		"0xff, 0x00, 0x00"
						/>
			</Effect>

			<Configuration aimTolerance="0" alternating="true">
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="90" posRadius="1" angle="0"/>
				<Shot posAngle="90" posRadius="1" angle="0"/>
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="270" posRadius="1" angle="0"/>
				<Shot posAngle="270" posRadius="1" angle="0"/>
			</Configuration>
		</Weapon>
		<Events>
			<OnAIUpdate>
				(if (itmIsDamaged gItem)
					(shpRepairItem gSource gItem)
				)
			</OnAIUpdate>
		</Events>
	</ItemType>

	<!-- Gatling Laser Cannon -->

	<ItemType UNID="&nwiGatlingTurbo;"
			name=				"Sarissa Gatling Laser"
			level=				"4"
			value=				"3600"
			mass=				"3000"
			frequency=			"common"
			attributes=			"NWA; EnergyWeapon; MajorItem; Laser"
			showReference=		"true"
			unknownType=		"&itUnknownLaserWeapon3;"
			description=		"The Northwind Armories Sarissa Gatling Laser Cannon uses multiple independant amplification chambers to achieve phenomenal rates of fire, but suffers from a corresponding heat buildup."

			sortName=			"NW Polearm 3"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"beam"

				damage=				"laser:2d6"
				fireRate=			"4"
				lifetime=			"30"
				powerUse=			"50"

				hitEffect=			"&efGreenLaserHitEffect;" 
				sound=				"&snLaserCannon;"

				counter=			"temperature"
				counterActivate=	"5"
				counterUpdate=		"-2"
				counterUpdateRate=	"4"

				>
			<Effect>
				<Beam
						beamType=			"laser"
						primaryColor=		"0x5f, 0xf1, 0x2a"
						secondaryColor=		"0x00, 0xff, 0x00"
						/>
			</Effect>

			<Configuration aimTolerance="1" alternating="true">
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="90" posRadius="1" angle="0"/>
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="270" posRadius="1" angle="0"/>
			</Configuration>
		</Weapon>
		<Events>
			<OnAIUpdate>
				(if (itmIsDamaged gItem)
					(shpRepairItem gSource gItem)
				)
			</OnAIUpdate>
		</Events>
	</ItemType>

	<!-- Orion Atomic Lance Note: +% bonuses on this weapon increase shotspeed, not damage -->

	<ItemType UNID="&nwiAtomicLance;"
			name=				"Orion Atomic Lance"
			level=				"6"
			value=				"24000"
			mass=				"4000"
			frequency=			"uncommon"
			attributes=			"NWA; MajorItem; Military; EnergyWeapon ; Plasma"
			unknownType=		"&itUnknownPlasmaWeapon;"
			description=		"This weapon was intended as a short range shipkiller, but difficulties with the confinement of the fusing plasma produce devastating thermonuclear explosions at maximum range, with a tendency to damage the firing ship."

			sortName=			"NW Orion"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"
				fragmentCount=		"1"

				damage=				"plasma:1d80; WMD7"
				fireRate=			"30"
				repeating=			"4"
				missileSpeed=			"80"
				hitPoints=			"10"
				lifetime=			"10"
				failsafe=			"10"
				powerUse=			"240"
				recoil=				"0"

				directional=		"true"
				fireEffect=			"&efMediumCannonFlash;"
				hitEffect=			"&efFragmentationExplosion;"
				sound=				"&snRecoillessCannon;"
				>

			<Effect>
				<Starburst
						style=			"morningStar"
						spikeCount=		"1d6+5"
						spikeLength=	"2d10"
						primaryColor=	"0xff, 0xff, 0x80"
						secondaryColor=	"0xd0, 0x20, 0x00"
						/>
			</Effect>

			<Fragment 
					type=			"radius"
					lifetime=		"10"
					damage=			"thermo:1d10 WMD2; momentum2"
					missileSpeed=		"0"

					minRadius=		"1"
					maxRadius=		"20"

					canHitSource= "true"
					>
				<Effect>
					<Flare
							style=			"fadingBlast"
							radius=			"350"
							primaryColor=	"0xff, 0xff, 0xf0"
							lifetime=		"8"
							/>
				</Effect>
			</Fragment>
		</Weapon>
		<Events>
			<onFireWeapon>
				(block (shot speed)
					(setq speed (divide (multiply (divide (multiply (add 100 aWeaponBonus) (subtract 8 aFireRepeat)) 100) (typGetDataField aWeaponType "speed")) 8))
					(setq shot (sysCreateWeaponFire aWeaponType gSource aFirePos aFireAngle speed aTargetObj))
					(objIncVel shot (objGetVel gSource))
				)
			</onFireWeapon>
		</Events>
	</ItemType>

	<!-- Starfire Multimodal Beam System -->

	<ItemType UNID="&nwiStarfire;"
			name=				"Starfire MBS"
			level=				"5"
			value=				"10000"
			mass=				"1000"
			frequency=			"common"
			attributes=			"MajorItem; NWA; EnergyWeapon; Launcher; Ammo"

			description=		"The Starfire Multimodal Beam System uses disposable, self contained beam sources with a single electrogravitic focusing system."

			sortName=			"NW Launcher Starfire"
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="480" imageWidth="96" imageHeight="96"/>

		<Weapon
				fireRate=			"30"
				powerUse=			"60"
				launcher=			"true"

				minFireArc=			"345"
				maxFireArc=			"15"
				>


			<Missiles>
				<Missile ammoID="&nwiSMBSLaser;"
						type=			"beam"
						lifetime=		"30"
						damage=			"laser:30d4; WMD1"
						hitEffect=		"&efXRayLaserHitEffect;" 
						sound=			"&snLaserCannon;"
						>
					<Effect>
						<Beam
								beamType=			"Starblaster"
								primaryColor=		"0xc4, 0x2a, 0xf1"
								secondaryColor=		"0xc0, 0x00, 0xff"
								/>
					</Effect>
				</Missile>

				<Missile ammoID="&nwiSMBSParticle;"
						type=			"beam"
						lifetime=		"40"
						damage=			"particle:16d8; WMD3; momentum1"
						sound=			"&snLaserCannon;"
						>
					<Effect>
						<Beam
								beamType=			"Starblaster"
								primaryColor=		"0x33, 0xff, 0x33"
								secondaryColor=		"0x00, 0x99, 0x00"
								/>
					</Effect>
				</Missile>

				<Missile ammoID="&nwiSMBSEMP;"
						type=			"beam"
						lifetime=		"30"
						damage=			"ion:10d6; EMP2; deviceDisrupt5"
						sound=			"&snLaserCannon;"
						>
					<Effect>
						<Beam
								beamType=			"lightning"
								primaryColor=		"0xa0, 0xf0, 0xff"
								secondaryColor=		"0x00, 0xa9, 0xff"
								intensity=		"4"
								/>
					</Effect>
				</Missile>

				<Missile ammoID="&nwiSMBSIon;"
						type=			"beam"
						lifetime=		"60"
						damage=			"ion:20d6"
						beamType=			"starblaster"
						primaryColor=		"0x00, 0x80, 0xff"
						secondaryColor=		"0x80, 0xc0, 0xff"
						sound=			"&snLaserCannon;"
						>
					<Effect>
						<Beam
								beamType=			"Starblaster"
								primaryColor=		"0x00, 0x80, 0xff"
								secondaryColor=		"0x80, 0xc0, 0xff"
								/>
					</Effect>
				</Missile>

				<Missile ammoID="&nwiSMBSPositron;"
						type=			"beam"
						lifetime=		"50"
						damage=			"positron:20d8"
						beamType=			"starblaster"
						primaryColor=		"0xff, 0xff, 0x00"
						secondaryColor=		"0x44, 0x44, 0x00"
						sound=			"&snLaserCannon;"
						>
					<Effect>
						<Beam
								beamType=			"Starblaster"
								primaryColor=		"0xff, 0xff, 0x00"
								secondaryColor=		"0x44, 0x44, 0x00"
								/>
					</Effect>
				</Missile>

			</Missiles>

		</Weapon>
		<StaticData>
			<WE_ammotable>
				(&nwwrtStarfire;)
			</WE_ammotable>
		</StaticData>

	</ItemType>

	<!-- Trafalgar Missile Launch System (3/4 omni) -->

	<ItemType UNID="&nwiTrafalgarTurret;"
			name=				"Trafalgar MLS"
			level=				"6"
			value=				"5000"
			mass=				"3000"
			frequency=			"uncommon"
			attributes=			"MajorItem; NWA; Launcher; Military; Ammo"

			description=		"This launcher is compatible with Northwind Armories' SM and TM lines"

			sortName=			"NW Launcher Trafalgar"
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="480" imageWidth="96" imageHeight="96"/>

		<Weapon
				fireRate=			"40"
				powerUse=			"20"
				launcher=			"true"

				minFireArc=			"225"
				maxFireArc=			"135"
				>

			<Missiles>
				<Missile ammoID="&nwiSMShotput;"
						type=			"missile"
						lifetime=		"120"
						damage=			"kinetic:8d8; momentum5; WMD7"
						missileSpeed=		"60"
						hitPoints=		"15"
						
						directional=	"true"
						sound=			"&snMissileLauncher;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>
					<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>
				</Missile>

				<Missile ammoID="&nwiTMHammer;"
						type=			"missile"
						lifetime=		"30"
						damage=			"blast:6d6; WMD3"
						missileSpeed=		"40"
						hitPoints=		"15"
						
						directional=	"true"
						sound=			"&snMissileLauncher;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>
					<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>
					<Fragment
							count=			"6d6"
							type=			"missile"
							lifetime=		"8"
							damage=			"blast:2d6; WMD2"
							missileSpeed=	"20-60"
							>
						<Effect>
							<ImageAndTail 
									imageID=			"&rsMissiles4;" 
									imageX=				"0" 
									imageY=				"0" 
									imageWidth=			"16" 
									imageHeight=		"16"
									imageFrameCount=	"4"
									imageTicksPerFrame=	"1"
									
									length=				"32"
									width=				"1"
									primaryColor=		"0xff, 0xff, 0xff"
									secondaryColor=		"0xc0, 0xc2, 0x85"
									/>
						</Effect>
					</Fragment>
					<Fragment 
							type=			"radius"
							lifetime=		"10"
							damage=			"blast:6d6; WMD3"
							missileSpeed=		"0"

							minRadius=		"1"
							maxRadius=		"3"

							canHitSource= "true"
							>
						<Effect>
							<Flare
									style=			"fadingBlast"
									radius=			"5"
									primaryColor=	"0xff, 0xf0, 0xe0"
									lifetime=		"8"
									/>
						</Effect>
					</Fragment>
				</Missile>

				<Missile ammoID="&nwiTMJavelin;"
						type=			"missile"
						lifetime=		"100"
						damage=			"thermo:6d6; momentum3; WMD5"
						missileSpeed=	"40"
						hitPoints=		"15"
						maneuverability="2"
						directional=	"true"
						sound=			"&snMissileLauncher;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>
					<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>
				</Missile>

				<Missile ammoID="&nwiSMMjolnir;"
						type=			"missile"
						
						damage=			"blast:1d12; momentum6; WMD5"
						missileSpeed=	"40"
						hitPoints=		"60"
						lifetime=		"120"
						fragmentCount=	"1"		
						directional=	"true"

						sound=			"&snMissileLauncher;"
						hitEffect=		"&efFragmentationExplosion;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>
					<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>
					<Fragment 
							type=			"area"

							damage=			"ion:1d12; EMP3"
							expansionSpeed=	"100"
							missileSpeed=	"0"
							lifetime=		"10"
							>
						<Effect>
							<Shockwave
									fadeStart=	"70"
									>
								<Image imageID=				"&rsShatterShockwave;"
										imageX=				"0" 
										imageY=				"0" 
										imageWidth=			"512" 
										imageHeight=		"128"
										imageFrameCount=	"1"
										imageTicksPerFrame=	"1"/>
							</Shockwave>
						</Effect>
					</Fragment>
					<Fragment 
							type=			"radius"
							lifetime=		"10"
							damage=			"blast:1d12; WMD5"
							missileSpeed=		"0"

							minRadius=		"1"
							maxRadius=		"3"

							canHitSource= "true"
							>
						<Effect>
							<Flare
									style=			"fadingBlast"
									radius=			"5"
									primaryColor=	"0xff, 0xf0, 0xe0"
									lifetime=		"8"
									/>
						</Effect>
					</Fragment>
				</Missile>
				<Missile ammoID="&nwiSMScythe;"
						type=			"missile"
						lifetime=		"120"
						damage=			"blast:8d8; WMD5"
						missileSpeed=	"40"
						hitPoints=		"45"
						
						directional=	"true"
						hitEffect=		"&efFragmentationExplosion;"
						sound=			"&snMissileLauncher;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>

					<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>

					<Fragment
							count=			"12"
							type=			"missile"
							lifetime=		"20"
							damage=			"blast:6d6; WMD3"
							missileSpeed=	"40-60"
							>
						<Image imageID="&rsMissiles;" imageX="0" imageY="16" imageWidth="16" imageHeight="16" imageFrameCount="12" imageTicksPerFrame="3"/>
						<Fragment
								count=			"5d6"
								type=			"missile"
								lifetime=		"30"
								damage=			"kinetic:4d4; WMD1"
								missileSpeed=	"40-60"
								>
						<Image imageID="&rsMissiles;" imageX="0" imageY="0" imageWidth="16" imageHeight="16" imageFrameCount="0" imageTicksPerFrame="0"/>
						</Fragment>
						<Fragment 
								type=			"radius"
								lifetime=		"10"
								damage=			"blast:6d6; WMD3"
								missileSpeed=		"0"

								minRadius=		"1"
								maxRadius=		"3"

								canHitSource= "true"
								>
							<Effect>
								<Flare
										style=			"fadingBlast"
										radius=			"5"
										primaryColor=	"0xff, 0xf0, 0xe0"
										lifetime=		"8"
										/>
							</Effect>
						</Fragment>
					</Fragment>
					<Fragment 
							type=			"radius"
							lifetime=		"10"
							damage=			"blast:8d8; WMD5"
							missileSpeed=		"0"

							minRadius=		"1"
							maxRadius=		"3"

							canHitSource= "true"
							>
						<Effect>
							<Flare
									style=			"fadingBlast"
									radius=			"5"
									primaryColor=	"0xff, 0xf0, 0xe0"
									lifetime=		"8"
									/>
						</Effect>
					</Fragment>
				</Missile>
				<Missile ammoID="&nwiTMOdysseus;"
						type=			"missile"
						lifetime=		"120"
						damage=			"blast:1d6+2; WMD1"
						missileSpeed=	"40"
						hitPoints=		"30"
						
						directional=	"true"
						hitEffect=		"&efFragmentationExplosion;"
						sound=			"&snMissileLauncher;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>

					<Effect>
						<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>
					</Effect>

					<Fragment
							count=			"7"
							type=			"missile"
							lifetime=		"80"
							damage=			"thermo:6d6; WMD3"
							maneuverability=	"2"
							missileSpeed=		"40"
							hitpoints=		"15"
							directional=	"true"
							multiTarget=		"true"
							autoAcquireTarget=	"true"
							>
							
					
						<effect>	
						<ImageAndTail 
								imageID=			"&rsMissiles3;" 
								imageX=				"48" 
								imageY=				"0" 
								imageWidth=			"16" 
								imageHeight=		"16"
									
								length=				"32"
								width=				"1"
								primaryColor=		"0xff, 0xff, 0xff"
								secondaryColor=		"0xc0, 0xc2, 0x85"
								/>
						</effect>
					</Fragment>
				</Missile>
				<Missile ammoID="&nwiSMScythe2;"
						type=			"missile"
						lifetime=		"120"
						damage=			"blast:8d8; WMD5"
						missileSpeed=	"40"
						hitPoints=		"45"
						
						directional=	"true"
						hitEffect=		"&efFragmentationExplosion;"
						sound=			"&snMissileLauncher;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>

					<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>

					<Fragment
							count=			"12"
							type=			"missile"
							lifetime=		"20"
							damage=			"thermo:4d4; WMD3"
							missileSpeed=	"40-60"
							>
						<Image imageID="&rsMissiles;" imageX="0" imageY="16" imageWidth="16" imageHeight="16" imageFrameCount="12" imageTicksPerFrame="3"/>
						<Fragment
								count=			"5d6"
								type=			"missile"
								lifetime=		"18"
								damage=			"plasma:3d3; WMD1"
								missileSpeed=	"40-60"
								>
							<Effect>
								<Image imageID="&rsMediumExplosions;" imageX="0" imageY="64" imageWidth="64" imageHeight="64" imageFrameCount="16" imageTicksPerFrame="1" blend="brighten" />
							</Effect>
						</Fragment>
					</Fragment>
				</Missile>
				<Missile ammoID="&nwiTMMistletoe;"
						type=			"missile"
						lifetime=		"160"
						damage=			"blast:6d6; momentum3; WMD3"
						missileSpeed=	"40"
						hitPoints=		"15"
						maneuverability="2"
						directional=	"true"
						sound=			"&snMissileLauncher;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>
					<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>
				</Missile>
			</Missiles>
		</Weapon>
		<Events>
			<OnFireWeapon>
				(block (shot offset)
					(setq offset (subtract &nwviSMShotput; &nwiSMShotput;))
					(setq shot (sysCreateWeaponFire (add offset aWeaponType) gSource aFirePos aFireAngle (typGetDataField aWeaponType "speed") aTargetObj nil aWeaponBonus))
					(objIncVel shot (objGetVel gSource))
					(if (eq aWeaponType &nwiTMMistletoe;)
						(objDepleteShields gSource)
					)
					True
				)
			</OnFireWeapon>
		</Events>
		<StaticData>
			<WE_ammotable>
				(&nwwrtParthian;)
			</WE_ammotable>
		</StaticData>
	</ItemType>

	<!-- Parthian Missile Launch System -->

	<ItemType UNID="&nwiParthianMLS;"
			name=				"Parthian MLS"
			level=				"3"
			value=				"2000"
			mass=				"2000"
			frequency=			"uncommon"
			attributes=			"MajorItem; NWA; Launcher; Ammo"

			description=		"This launcher is compatible with Northwind Armories' SM and TM lines"

			sortName=			"NW Launcher Parthian"
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="480" imageWidth="96" imageHeight="96"/>

		<Weapon
				fireRate=			"30"
				powerUse=			"20"
				launcher=			"true"
				>
			<Missiles>
				<Missile ammoID="&nwiSMShotput;"
						type=			"missile"
						lifetime=		"120"
						damage=			"kinetic:8d8; momentum5; WMD7"
						missileSpeed=		"60"
						hitPoints=		"15"
						
						directional=	"true"
						sound=			"&snMissileLauncher;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>
					<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>
				</Missile>

				<Missile ammoID="&nwiTMHammer;"
						type=			"missile"
						lifetime=		"30"
						damage=			"blast:6d6; WMD3"
						missileSpeed=		"40"
						hitPoints=		"15"
						
						directional=	"true"
						sound=			"&snMissileLauncher;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>
					<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>
					<Fragment
							count=			"6d6"
							type=			"missile"
							lifetime=		"8"
							damage=			"blast:2d6; WMD2"
							missileSpeed=	"20-60"
							>
						<Effect>
							<ImageAndTail 
									imageID=			"&rsMissiles4;" 
									imageX=				"0" 
									imageY=				"0" 
									imageWidth=			"16" 
									imageHeight=		"16"
									imageFrameCount=	"4"
									imageTicksPerFrame=	"1"
									
									length=				"32"
									width=				"1"
									primaryColor=		"0xff, 0xff, 0xff"
									secondaryColor=		"0xc0, 0xc2, 0x85"
									/>
						</Effect>
					</Fragment>
					<Fragment 
							type=			"radius"
							lifetime=		"10"
							damage=			"blast:6d6; WMD3"
							missileSpeed=		"0"

							minRadius=		"1"
							maxRadius=		"3"

							canHitSource= "true"
							>
						<Effect>
							<Flare
									style=			"fadingBlast"
									radius=			"5"
									primaryColor=	"0xff, 0xf0, 0xe0"
									lifetime=		"8"
									/>
						</Effect>
					</Fragment>
				</Missile>

				<Missile ammoID="&nwiTMJavelin;"
						type=			"missile"
						lifetime=		"100"
						damage=			"thermo:6d6; momentum3; WMD5"
						missileSpeed=	"40"
						hitPoints=		"15"
						maneuverability="2"
						directional=	"true"
						sound=			"&snMissileLauncher;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>
					<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>
				</Missile>

				<Missile ammoID="&nwiSMMjolnir;"
						type=			"missile"
						
						damage=			"blast:1d12; momentum6; WMD5"
						missileSpeed=	"40"
						hitPoints=		"60"
						lifetime=		"120"
						fragmentCount=	"1"		
						directional=	"true"

						sound=			"&snMissileLauncher;"
						hitEffect=		"&efFragmentationExplosion;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>
					<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>
					<Fragment 
							type=			"area"

							damage=			"ion:1d12; EMP3"
							expansionSpeed=	"100"
							missileSpeed=	"0"
							lifetime=		"10"
							>
						<Effect>
							<Shockwave
									fadeStart=	"70"
									>
								<Image imageID=				"&rsShatterShockwave;"
										imageX=				"0" 
										imageY=				"0" 
										imageWidth=			"512" 
										imageHeight=		"128"
										imageFrameCount=	"1"
										imageTicksPerFrame=	"1"/>
							</Shockwave>
						</Effect>
					</Fragment>
					<Fragment 
							type=			"radius"
							lifetime=		"10"
							damage=			"blast:1d12; WMD5"
							missileSpeed=		"0"

							minRadius=		"1"
							maxRadius=		"3"

							canHitSource= "true"
							>
						<Effect>
							<Flare
									style=			"fadingBlast"
									radius=			"5"
									primaryColor=	"0xff, 0xf0, 0xe0"
									lifetime=		"8"
									/>
						</Effect>
					</Fragment>
				</Missile>
				<Missile ammoID="&nwiSMScythe;"
						type=			"missile"
						lifetime=		"120"
						damage=			"blast:8d8; WMD5"
						missileSpeed=	"40"
						hitPoints=		"45"
						
						directional=	"true"
						hitEffect=		"&efFragmentationExplosion;"
						sound=			"&snMissileLauncher;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>

					<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>

					<Fragment
							count=			"12"
							type=			"missile"
							lifetime=		"20"
							damage=			"blast:6d6; WMD3"
							missileSpeed=	"40-60"
							>
						<Image imageID="&rsMissiles;" imageX="0" imageY="16" imageWidth="16" imageHeight="16" imageFrameCount="12" imageTicksPerFrame="3"/>
						<Fragment
								count=			"5d6"
								type=			"missile"
								lifetime=		"30"
								damage=			"kinetic:4d4; WMD1"
								missileSpeed=	"40-60"
								>
						<Image imageID="&rsMissiles;" imageX="0" imageY="0" imageWidth="16" imageHeight="16" imageFrameCount="0" imageTicksPerFrame="0"/>
						</Fragment>
						<Fragment 
								type=			"radius"
								lifetime=		"10"
								damage=			"blast:6d6; WMD3"
								missileSpeed=		"0"

								minRadius=		"1"
								maxRadius=		"3"

								canHitSource= "true"
								>
							<Effect>
								<Flare
										style=			"fadingBlast"
										radius=			"5"
										primaryColor=	"0xff, 0xf0, 0xe0"
										lifetime=		"8"
										/>
							</Effect>
						</Fragment>
					</Fragment>
					<Fragment 
							type=			"radius"
							lifetime=		"10"
							damage=			"blast:8d8; WMD5"
							missileSpeed=		"0"

							minRadius=		"1"
							maxRadius=		"3"

							canHitSource= "true"
							>
						<Effect>
							<Flare
									style=			"fadingBlast"
									radius=			"5"
									primaryColor=	"0xff, 0xf0, 0xe0"
									lifetime=		"8"
									/>
						</Effect>
					</Fragment>
				</Missile>
				<Missile ammoID="&nwiTMOdysseus;"
						type=			"missile"
						lifetime=		"120"
						damage=			"blast:1d6+2; WMD1"
						missileSpeed=	"40"
						hitPoints=		"30"
						
						directional=	"true"
						hitEffect=		"&efFragmentationExplosion;"
						sound=			"&snMissileLauncher;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>

					<Effect>
						<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>
					</Effect>

					<Fragment
							count=			"7"
							type=			"missile"
							lifetime=		"80"
							damage=			"thermo:6d6; WMD3"
							maneuverability=	"2"
							missileSpeed=		"40"
							hitpoints=		"15"
							directional=	"true"
							multiTarget=		"true"
							autoAcquireTarget=	"true"
							>
							
					
						<effect>	
						<ImageAndTail 
								imageID=			"&rsMissiles3;" 
								imageX=				"48" 
								imageY=				"0" 
								imageWidth=			"16" 
								imageHeight=		"16"
									
								length=				"32"
								width=				"1"
								primaryColor=		"0xff, 0xff, 0xff"
								secondaryColor=		"0xc0, 0xc2, 0x85"
								/>
						</effect>
					</Fragment>
				</Missile>
				<Missile ammoID="&nwiSMScythe2;"
						type=			"missile"
						lifetime=		"120"
						damage=			"blast:8d8; WMD5"
						missileSpeed=	"40"
						hitPoints=		"45"
						
						directional=	"true"
						hitEffect=		"&efFragmentationExplosion;"
						sound=			"&snMissileLauncher;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>

					<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>

					<Fragment
							count=			"12"
							type=			"missile"
							lifetime=		"20"
							damage=			"thermo:4d4; WMD3"
							missileSpeed=	"40-60"
							>
						<Image imageID="&rsMissiles;" imageX="0" imageY="16" imageWidth="16" imageHeight="16" imageFrameCount="12" imageTicksPerFrame="3"/>
						<Fragment
								count=			"5d6"
								type=			"missile"
								lifetime=		"18"
								damage=			"plasma:3d3; WMD1"
								missileSpeed=	"40-60"
								>
							<Effect>
								<Image imageID="&rsMediumExplosions;" imageX="0" imageY="64" imageWidth="64" imageHeight="64" imageFrameCount="16" imageTicksPerFrame="1" blend="brighten" />
							</Effect>
						</Fragment>
					</Fragment>
				</Missile>
				<Missile ammoID="&nwiTMMistletoe;"
						type=			"missile"
						lifetime=		"160"
						damage=			"blast:6d6; momentum3; WMD3"
						missileSpeed=	"40"
						hitPoints=		"15"
						maneuverability="2"
						directional=	"true"
						sound=			"&snMissileLauncher;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>
					<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>
				</Missile>
			</Missiles>
		</Weapon>
		<Events>
			<OnFireWeapon>
				(block (shot offset newFireangle)
					(setq newFireAngle 
						(if (itmGetData gItem "tailgunMode")
							(add 180 aFireAngle)
							aFireAngle
						)
					)
					(setq offset (subtract &nwviSMShotput; &nwiSMShotput;))
					(setq shot (sysCreateWeaponFire (add offset aWeaponType) gSource aFirePos newFireAngle (typGetDataField aWeaponType "speed") aTargetObj nil aWeaponBonus))

					(objIncVel shot (objGetVel gSource))
					(if (eq aWeaponType &nwiTMMistletoe;)
						(objDepleteShields gSource)
					)
					True
				)
			</OnFireWeapon>
		</Events>
		<StaticData>
			<WE_ammotable>
				(&nwwrtParthian;)
			</WE_ammotable>
		</StaticData>
		<Invoke key="M" installedOnly="true">
		(block (mode)
			(setq mode (not (itmGetData gItem "tailgunMode")))
			(objSetItemData gSource gItem "tailgunMode" mode)
			(if mode
				(objSendMessage gSource Nil (cat "Firing from Aft tubes"))
				(objSendMessage gSource Nil (cat "Firing from Forward tubes"))
			)
		)
		</Invoke>
	</ItemType>


	<!-- Claymore Variable Projectile Launcher -->

	<ItemType UNID="&nwiClaymore15;"
			name=				"Claymore VPL (15)"
			level=				"3"
			value=				"1000"
			mass=				"1000"
			frequency=			"common"
			attributes=			"MajorItem; NWA; Launcher; Ammo"

			description=		"Northwind Armories' versatile Claymore launcher can fire a variety of munitions with varying degrees of spread."

			sortName=			"NW Launcher Claymore"
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="480" imageWidth="96" imageHeight="96"/>

		<Weapon
				fireRate=			"15"
				powerUse=			"20"
				launcher=			"true"
				>

			<Missiles>
				<Missile ammoID="&nwiCVPLKinetic;"
						type=			"particles"
						lifetime=		"80"
						damage=			"kinetic:45; WMD2"
						missileSpeed=	"50"
						
						sound=			"&snRecoillessCannon;"
						particleCount=		"1d11+44"
						particleSpreadAngle=	"15"
						>

					<Effect>
						<Image imageID="&rsMissiles4;" imageX="0" imageY="0" imageWidth="16" imageHeight="16" imageFrameCount="4" imageTicksPerFrame="1" randomStartFrame="true"/>
					</Effect>
				</Missile>

				<Missile ammoID="&nwiCVPLRadio;"
						type=			"particles"
						lifetime=		"80"
						damage=			"kinetic:40; WMD1; radiation1"
						missileSpeed=	"50"
						
						sound=			"&snRecoillessCannon;"
						particleCount=		"1d11+44"
						particleSpreadAngle=	"15"
						accelerationFactor=	"60"
						>

					<Effect>
						<Image imageID="&rsDebris1;" imageX="0" imageY="32" imageWidth="4" imageHeight="4" imageFrameCount="8" imageTicksPerFrame="4"/>
					</Effect>
				</Missile>

				<Missile ammoID="&nwiCVPLBlast;"
						type=			"particles"
						lifetime=		"80"
						damage=			"blast:8d6+8; WMD3"
						missileSpeed=	"50"

						particleCount=		"8"
						particleSpreadAngle=	"15"
						
						sound=			"&snRecoillessCannon;"
						>
					<Effect>
						<ImageAndTail 
							imageID=			"&rsMissiles;" 
							imageX=				"96" 
							imageY=				"0" 
							imageWidth=			"16" 
							imageHeight=		"16"
							imageFrameCount=	"2"
							imageTicksPerFrame=	"2"
						
							length=				"32"
							width=				"3"
							primaryColor=		"0xff, 0xff, 0xff"
							secondaryColor=		"0xc0, 0xc2, 0x85"
						/>
					</Effect>
				</Missile>

				<Missile ammoID="&nwiCVPLThermo;"
						type=			"missile"
						
						damage=			"thermo:6d6; WMD7"
						lifetime=		"200"
						missileSpeed=	"50"
						hitPoints=		"30"
						fragmentCount=	"1"
						
						sound=			"&snMissileLauncher;"
						>

					<Image imageID="&rsMissiles;" imageX="0" imageY="16" imageWidth="16" imageHeight="16" imageFrameCount="12" imageTicksPerFrame="3"/>
					
					<Fragment 
							type=			"area"

							damage=			"thermo:1d6; WMD3"
							expansionSpeed=	"50"
							missileSpeed=	"0"
							lifetime=		"12"

							areaDamageDensity=	"40"
							passthrough=		"20"
							>

						<Effect>
							<Shockwave
									fadeStart=	"70"
									>
								<Image imageID=				"&rsShockwave1;"
										imageX=				"0" 
										imageY=				"0" 
										imageWidth=			"512" 
										imageHeight=		"128"
										imageFrameCount=	"1"
										imageTicksPerFrame=	"1"/>
							</Shockwave>
						</Effect>
					</Fragment>
				</Missile>
				<Missile ammoID="&nwiCVPLPlasma;"
						type=			"particles"
						lifetime=		"40"
						damage=			"plasma:40; WMD2"
						missileSpeed=	"60"
						
						sound=			"&snRecoillessCannon;"
						particleCount=		"500"
						particleSpreadAngle="15"
						particleSplashChance="50"
						>

					<Effect>
						<Particle
						style=			"flame"
						minWidth=		"3" 
						maxWidth=		"3-7"
						/>
					</Effect>
				</Missile>
			</Missiles>

		</Weapon>
		<StaticData>
			<WE_ammotable>
				(&nwwrtClaymore;)
			</WE_ammotable>
		</StaticData>
		<Invoke key="M" installedOnly="true">
			(block Nil
				(nwfSwitchweapon (itmCreate &nwiClaymore5; 1))
				(objSendMessage gSource Nil (cat "Switched to 5 degree firing angle"))
			)
		</Invoke>
		<Events>
			<OnAIUpdate>
			;	(if (leq 1 (random 1 2)))
					(nwfSwitchweapon (itmCreate &nwiClaymore5; 1))
			;	)
			</OnAIUpdate>
		</Events>
	</ItemType>

	<ItemType UNID="&nwiClaymore5;"
			name=				"Claymore VPL (5)"
			level=				"3"
			value=				"1000"
			mass=				"1000"
			frequency=			"notrandom"
			attributes=			"MajorItem; NWA; Launcher; Ammo"

			description=		"Northwind Armories' versatile Claymore launcher can fire a variety of munitions with varying degrees of spread."

			sortName=			"NW Launcher Claymore"
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="480" imageWidth="96" imageHeight="96"/>

		<Weapon
				fireRate=			"15"
				powerUse=			"20"
				launcher=			"true"
				>

			<Missiles>
				<Missile ammoID="&nwiCVPLKinetic;"
						type=			"particles"
						lifetime=		"150"
						damage=			"kinetic:45; WMD2"
						missileSpeed=	"50"
						
						sound=			"&snRecoillessCannon;"
						particleCount=		"1d11+44"
						particleSpreadAngle=	"5"
						>

					<Effect>
						<Image imageID="&rsMissiles4;" imageX="0" imageY="0" imageWidth="16" imageHeight="16" imageFrameCount="4" imageTicksPerFrame="1" randomStartFrame="true"/>
					</Effect>
				</Missile>

				<Missile ammoID="&nwiCVPLRadio;"
						type=			"particles"
						lifetime=		"150"
						damage=			"kinetic:40; WMD1; radiation1"
						missileSpeed=	"50"
						
						sound=			"&snRecoillessCannon;"
						particleCount=		"1d11+44"
						particleSpreadAngle=	"5"
						accelerationFactor=	"60"
						>

					<Effect>
						<Image imageID="&rsDebris1;" imageX="0" imageY="32" imageWidth="4" imageHeight="4" imageFrameCount="8" imageTicksPerFrame="4"/>
					</Effect>
				</Missile>

				<Missile ammoID="&nwiCVPLBlast;"
						type=			"particles"
						lifetime=		"150"
						damage=			"blast:8d6+8; WMD3"
						missileSpeed=	"50"

						particleCount=		"8"
						particleSpreadAngle=	"5"
						
						sound=			"&snRecoillessCannon;"
						>

					<Configuration aimTolerance="5">
						<Shot angle="1d5-3"/>
						<Shot angle="1d5-3"/>
						<Shot angle="1d5-3"/>
						<Shot angle="1d3-3"/>
					</Configuration>

					<Effect>
						<ImageAndTail 
							imageID=			"&rsMissiles;" 
							imageX=				"96" 
							imageY=				"0" 
							imageWidth=			"16" 
							imageHeight=		"16"
							imageFrameCount=	"2"
							imageTicksPerFrame=	"2"
						
							length=				"32"
							width=				"3"
							primaryColor=		"0xff, 0xff, 0xff"
							secondaryColor=		"0xc0, 0xc2, 0x85"
						/>
					</Effect>
				</Missile>

				<Missile ammoID="&nwiCVPLThermo;"
						type=			"missile"
						
						damage=			"thermo:6d6; WMD7"
						lifetime=		"200"
						missileSpeed=	"50"
						hitPoints=		"30"
						fragmentCount=	"1"
						
						sound=			"&snMissileLauncher;"
						>

					<Image imageID="&rsMissiles;" imageX="0" imageY="16" imageWidth="16" imageHeight="16" imageFrameCount="12" imageTicksPerFrame="3"/>
					
					<Fragment 
							type=			"area"

							damage=			"thermo:1d6; WMD3"
							expansionSpeed=	"50"
							missileSpeed=	"0"
							lifetime=		"12"

							areaDamageDensity=	"40"
							passthrough=		"20"
							>

						<Effect>
							<Shockwave
									fadeStart=	"70"
									>
								<Image imageID=				"&rsShockwave1;"
										imageX=				"0" 
										imageY=				"0" 
										imageWidth=			"512" 
										imageHeight=		"128"
										imageFrameCount=	"1"
										imageTicksPerFrame=	"1"/>
							</Shockwave>
						</Effect>
					</Fragment>
				</Missile>
				<Missile ammoID="&nwiCVPLPlasma;"
						type=			"particles"
						lifetime=		"75"
						damage=			"plasma:40; WMD3"
						missileSpeed=	"60"
						
						sound=			"&snRecoillessCannon;"
						particleCount=		"500"
						particleSpreadAngle="5"
						particleSplashChance="50"
						>

					<Effect>
						<Particle
						style=			"flame"
						minWidth=		"3" 
						maxWidth=		"3-7"
						/>
					</Effect>
				</Missile>
			</Missiles>

		</Weapon>
		<StaticData>
			<WE_ammotable>
				(&nwwrtClaymore;)
			</WE_ammotable>
		</StaticData>
		<Invoke key="M" installedOnly="true">
			(block Nil
				(nwfSwitchweapon (itmCreate &nwiClaymore15; 1))
				(objSendMessage gSource Nil (cat "Switched to 15 degree firing angle"))
			)
		</Invoke>
		<Events>
			<OnAIUpdate>
				(block (target)
					(setq target (objGetTarget gSource))
					(if (leq (sysVectorDistance (objGetPos target) (objGetPos gSource) 20))
						(nwfSwitchweapon (itmCreate &nwiClaymore15; 1))
					)
				)
			</OnAIUpdate>
		</Events>
	</ItemType>

	<!-- Cerberus Fusion Cannon -->

	<ItemType UNID="&nwiCerberus;"
			name=				"Cerberus Fusion Cannon"
			level=				"8"
			value=				"65000"
			mass=				"6000"
			frequency=			"uncommon"
			attributes=			"MajorItem; NWA; Military; ThermoCannon"
			showReference=		"true"
			unknownType=		"&itUnknownThermoCannon2;"
			description=		"The Cerberus Fusion Cannon fires fires three atomic fireballs and tracks them on nearby targets."

			sortName=			"NW Cerberus"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"

				damage=				"thermo:8d4; momentum3; WMD5"
				fireRate=			"40"
				missileSpeed=		"40"
				maneuverability="1"
				multitarget="true"
				lifetime=			"30"
				powerUse=			"3000"
				fireEffect=			"&efMediumCannonFlash;"
				sound=				"&snRecoillessCannon;"
				>

			<Configuration aimTolerance="180">
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="0" posRadius="0" angle="-60"/>
				<Shot posAngle="0" posRadius="0" angle="60"/>
			</Configuration>
			
			<Effect>
				<Starburst
						style=			"flare"
						spikeCount=		"1d6+5"
						spikeLength=	"3d10"
						primaryColor=	"0xff, 0xff, 0x80"
						secondaryColor=	"0xd0, 0x20, 0x00"
						/>
			</Effect>

		</Weapon>

	</ItemType>

	<!-- Heavy Particle Blaster -->

	<ItemType UNID="&nwiHvyParticleBlaster;"
			name=				"Svärdstav Particle Blaster"
			level=				"5"
			value=				"8000"
			mass=				"3000"
			frequency=			"uncommon"
			numberAppearing=	"1"
			attributes=			"NWA; Particle; EnergyWeapon; MajorItem"
			unknownType=		"&itUnknownParticleCannon2;"
			description=		"The Northwind Armories Svärdstav Particle Blaster is a high output, penetrating particle weapon using multiple firing chambers.  The heat sensor and automatic cutoff is more reliable than on the Gatling Laser."

			sortName=			"NW Polearm 3"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>


		<Weapon
				type=				"beam"

				damage=				"particle:4d4"
				fireRate=			"4"
				lifetime=			"40"
				passthrough=		"33"
				powerUse=			"500"

				counter=			"capacitor"
				counterActivate=	"-10"
				counterUpdate=		"10"
				counterUpdateRate=	"8"

				sound=				"&snLaserCannon;"
				>
			<Effect>
				<Beam
						beamType=			"starblaster"
						primaryColor=		"0x00, 0xff, 0x40"
						secondaryColor=		"0x40, 0xff, 0x60"
						/>
			</Effect>


			<Configuration aimTolerance="1" alternating="true">
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="90" posRadius="1" angle="-1"/>
				<Shot posAngle="90" posRadius="1" angle="-1"/>
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="270" posRadius="1" angle="1"/>
				<Shot posAngle="270" posRadius="1" angle="1"/>
			</Configuration>

		</Weapon>

	</ItemType>

	<!-- Oxybeles -->

	<ItemType UNID="&nwiOxybeles;"
			name=				"Oxybeles Light Howitzer"
			level=				"6"
			value=				"15000"
			mass=				"4000"
			frequency=			"uncommon"
			attributes=			"Howitzer; MajorItem; NWA; BlastCannon; Military"
			unknownType=		"&itUnknownBlastCannon3;"
			description=		"The Oxybeles Light Howitzer fires multiple small disposable lasers powered by hexagene driven MHD generators."
			sortName=			"NW Howitzer 2"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"

				damage=				"blast:1d12; momentum1; WMD4"
				fireRate=			"40"
				missileSpeed=		"25"
				lifetime=			"240"
				hitPoints=			"20"
				powerUse=			"300"
				recoil=				"1"
				fragmentCount=		"1"
				repeating=		"5"

				directional=		"true"
				fireEffect=			"&efMediumCannonFlash;"
				hitEffect=			"&efFragmentationExplosion;"
				sound=				"&snRecoillessCannon;"


				>

			<Effect>
				<MoltenBolt
						width=				"5"
						length=				"20"
						growth=				"3"
						primaryColor=		"0xea, 0xed, 0xae"
						secondaryColor=		"0xc0, 0xc2, 0x85"
						/>
			</Effect>
			<Fragment 
					count=			"2"
					type=			"beam"
					lifetime=		"60"
					damage=			"laser:2d6; WMD1"
					passthrough=		"50"
					multitarget=		"true"
					hitEffect=		"&efGreenLaserHitEffect;"
					sound=			"&snLaserCannon;"
					>
				<Effect>
					<Beam
							beamType=			"laser"
							primaryColor=		"0x5f, 0xf1, 0x2a"
							secondaryColor=		"0x00, 0xff, 0x00"
							/>
				</Effect>
			</Fragment>
			<Fragment 
					count=			"1"
					type=			"radius"
					lifetime=		"10"
					damage=			"blast:1d12; momentum1; WMD4"
					missileSpeed=		"0"

					minRadius=		"1"
					maxRadius=		"3"

					canHitSource= "true"
					>
				<Effect>
					<Flare
							style=			"fadingBlast"
							radius=			"5"
							primaryColor=	"0xff, 0xf0, 0xe0"
							lifetime=		"8"
							/>
				</Effect>
			</Fragment>
		</Weapon>

	</ItemType>

	<!-- Mangonel -->

	<ItemType UNID="&nwiMangonel;"
			name=				"Mangonel Light Howitzer"
			level=				"7"
			value=				"65000"
			mass=				"5000"
			frequency=			"uncommon"
			attributes=			"Howitzer; MajorItem; NWA; ThermoCannon; Military"
			unknownType=		"&itUnknownThermoCannon;"
			description=		"The Mangonel Light Howitzer fires multiple bomb pumped x-ray submunitions."

			sortName=			"NW Howitzer 4"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"

				damage=				"thermo:2d10; momentum1; WMD5"
				fireRate=			"40"
				missileSpeed=			"30"
				lifetime=			"200"
				hitPoints=			"20"
				powerUse=			"450"
				recoil=				"1"
				repeating=		"3"
				failsafe=			"5"

				directional=		"true"
				fireEffect=			"&efMediumCannonFlash;"
				hitEffect=			"&efFragmentationExplosion;"
				sound=				"&snRecoillessCannon;"
				>
			<Effect>
				<MoltenBolt
						width=				"5"
						length=				"20"
						growth=				"3"
						primaryColor=		"0xea, 0xed, 0xae"
						secondaryColor=		"0xc0, 0xc2, 0x85"
						/>
			</Effect>
			<Fragment
					count=			"3"
					type=			"beam"
					lifetime=		"30"
					damage=			"laser:8d4; WMD1"
					multiTarget=		"true"
					autoAcquireTarget=	"true"

					hitEffect=			"&efXRayLaserHitEffect;"
					sound=				"&snLaserCannon;"
					>
				<Effect>
					<Beam
							beamType=			"laser"
							primaryColor=		"0xc4, 0x2a, 0xf1"
							secondaryColor=		"0xc0, 0x00, 0xff"
							/>
				</Effect>
			</Fragment>
			<Fragment 
					count=				"6"
					type=				"beam"
					damage=				"thermo:1d10; WMD5"
					lifetime=			"2"
					beamType=			"heavyblaster"
					primaryColor=		"0xe6, 0xff, 0x6f"
					secondaryColor=		"0xff, 0x8c, 0x00"
					intensity=			"5"
					>
			</Fragment>
		</Weapon>
	</ItemType>

	<!-- Atgeir Ion Blaster -->

	<ItemType UNID="&nwiAtgeir;"
			name=				"Atgeir Ion Blaster"
			level=				"7"
			value=				"40000"
			mass=				"6000"
			frequency=			"uncommon"
			numberAppearing=	"1"
			attributes=			"NWA; Ion; EnergyWeapon; MajorItem; Military"
			unknownType=		"&itUnknownIonCannon5;"
			description=		"The Northwind Armories Atgeir Ion Blaster uses twin arcs to produce distortions in shields it hits."

			sortName=			"NW Polearm 4"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>


		<Weapon
				type=				"beam"

				damage=				"ion:3d6; shield:7"
				fireRate=			"4"
				lifetime=			"18"
				powerUse=			"1500"

				counter=			"capacitor"
				counterActivate=	"-10"
				counterUpdate=		"10"
				counterUpdateRate=	"4"

				sound=				"&snLaserCannon;"
				>
			<Effect>
				<Beam
						beamType=			"starblaster"
						primaryColor=		"0x00, 0xc0, 0xff"
						secondaryColor=		"0xc0, 0xe0, 0xff"
						/>
			</Effect>


			<Configuration aimTolerance="0" alternating="true">
				<Shot posAngle="90" posRadius="14" angle="-1"/>
				<Shot posAngle="270" posRadius="14" angle="1"/>
			</Configuration>

		</Weapon>

	</ItemType>

	<!-- Guisarme Positron Blaster -->

	<ItemType UNID="&nwiGuisarme;"
			name=				"Guisarme Positron Blaster"
			level=				"9"
			value=				"200000"
			mass=				"3000"
			frequency=			"uncommon"
			numberAppearing=	"1"
			attributes=			"NWA; Positron; EnergyWeapon; MajorItem; Military"
			unknownType=		"&itUnknownPositronWeapon;"
			description=		"Adaptations of Northwind Gatling designs to positron sources have required stricter limiting of throughput and have proved less accurate than particle versions."

			sortName=			"NW Polearm 5"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>


		<Weapon
				type=				"beam"

				damage=				"positron:4d8"
				fireRate=			"4"
				lifetime=			"40"
				powerUse=			"2000"

				counter=			"capacitor"
				counterActivate=	"-20"
				counterUpdate=		"20"
				counterUpdateRate=	"8"

				sound=				"&snLaserCannon;"
				>
			<Effect>
				<Beam
						beamType=			"starblaster"
						primaryColor=		"0xe0, 0xc0, 0x00"
						secondaryColor=		"0xc0, 0xe0, 0x00"
						/>
			</Effect>


			<Configuration aimTolerance="1" alternating="true">
				<Shot posAngle="0" posRadius="0" angle="1d3-2"/>
				<Shot posAngle="90" posRadius="1" angle="1d3-3"/>
				<Shot posAngle="90" posRadius="1" angle="1d3-3"/>
				<Shot posAngle="0" posRadius="0" angle="1d3-2"/>
				<Shot posAngle="270" posRadius="1" angle="1d3-1"/>
				<Shot posAngle="270" posRadius="1" angle="1d3-1"/>
			</Configuration>

		</Weapon>

	</ItemType>

	<!-- Hoedhr Archcannon -->

	<ItemType UNID="&nwiHoedhr;"
			name=				"Hoedhr Contra-Terrene Lance"
			level=				"10"
			value=				"600000"
			mass=				"4000"
			frequency=			"notrandom"
			attributes=			"NWA; MajorItem; EnergyWeapon ; Antimatter; Cannotorder"

			description=		"This advanced development of the Orion Atomic Lance was designed specifically for use against the Iocrym."

			sortName=			"NW Hoedhr"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"
				fragmentCount=		"1"

				damage=				"antimatter:10; WMD7"
				fireRate=			"30"
				repeating=			"5"
				missileSpeed=			"80"
				hitPoints=			"15"
				lifetime=			"20"
				failsafe=			"32"
				powerUse=			"2400"
				recoil=				"0"

				directional=		"true"
				fireEffect=			"&efMediumCannonFlash;"
				hitEffect=			"&efFragmentationExplosion;"
				sound=				"&snRecoillessCannon;"
				>
					<Effect>
						<Flare
								style=			"fadingBlast"
								radius=			"32"
								primaryColor=	"0xf0, 0xff, 0xc0"
								lifetime=		"32"
								/>
					</Effect>
			<Fragment 
					type=			"radius"
					lifetime=		"50"
					damage=			"plasma:2d6-1; WMD4; momentum1"
					missileSpeed=		"0"

					minRadius=		"1"
					maxRadius=		"10"

					canHitSource= "true"
					>
				<Effect>
					<Flare
							style=			"fadingBlast"
							radius=			"175"
							primaryColor=	"0xff, 0xff, 0xf0"
							lifetime=		"8"
							/>
				</Effect>
			</Fragment>
		</Weapon>
		<Events>
			<OnDamageShields>
				(list
					nil
					(divide (multiply (subtract 100 (multiply 4 (itmGetLevel aDeviceItem))) aDamageHP) 100)
					(subtract aDamageHP (divide (multiply (subtract 100 (multiply 4 (itmGetLevel aDeviceItem))) aDamageHP) 100))
				)
			</OnDamageShields>
		</Events>
	</ItemType>

	<!-- Ranseur Cannon -->

	<ItemType UNID="&nwiRanseur;"
			name=				"ranseur cannon"
			level=				"2"
			value=				"1500"
			mass=				"3500"
			frequency=			"uncommon"
			attributes=			"MajorItem; NWA; Cannon"
			showReference=		"true"
			unknownType=		"&itUnknownKineticCannon;"
			description=		"The Northwind Armories Ranseur cannon uses burst fire similar to the NAMI DK10 Arbalest with a traversal system that allows it to also compete with NAMI's TK10 Trident."

			sortName=			"NW Polearm 1"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"

				damage=				"kinetic:1d6+1; momentum1"
				fireRate=			"20"
				repeating=		"2"
				missileSpeed=		"60"
				interaction=		"60"
				lifetime=			"50"
				powerUse=			"40"

				sound=				"&snRecoillessCannon;"
				>

			<Effect>
				<Bolt
						length=				"12"
						width=				"2"
						primaryColor=		"0xcd, 0xf3, 0xff"
						secondaryColor=		"0x8f, 0xa9, 0xb2"
						/>
			</Effect>

		</Weapon>

		<Invoke key="W" installedOnly="true">
		(block (mode)
			(setq mode (not (itmGetData gItem "spreadMode")))
			(objSetItemData gSource gItem "spreadMode" mode)
			(if mode
				(objSendMessage gSource Nil (cat "Ranseur in spread mode"))
				(objSendMessage gSource Nil (cat "Ranseur in repeat mode"))
			)
		)
		</Invoke>

		<Events>
			<onFireWeapon>
				(block (angle speed mode)
					(setq mode (not (itmGetData gItem "spreadMode")))
					(setq angle aFireAngle)
					(if mode
						(setq speed (divide (multiply (typGetDataField aWeaponType "speed") 2) 3))
						(setq speed (typGetDataField aWeaponType "speed"))
					)
					(if (and mode (eq aFireRepeat 0))
						(setq angle (subtract angle 4))
					)
					(if (and mode (eq aFireRepeat 2))
						(setq angle (add angle 4))
					)
					(setq shot (sysCreateWeaponFire aWeaponType gSource aFirePos angle speed aTargetObj nil aWeaponBonus))
					(objIncVel shot (objGetVel gSource))
				)
			</onFireWeapon>
			<OnAIUpdate>
				(block (target)
					(setq target (objGetTarget gSource))
					(if (leq 1 (random 1 2))
						(objSetItemData gSource gItem "spreadMode" nil)
						(objSetItemData gSource gItem "spreadMode" "true")
					)
				)
			</OnAIUpdate>
		</Events>

	</ItemType>

	<!-- Chain Lightning Turret -->

	<ItemType UNID="&nwiChainLightning;"
			name=				"Chain Lightning Turret"
			level=				"8"
			value=				"230000"
			mass=				"4000"
			frequency=			"rare"
			attributes=			"NWA; EnergyWeapon; Military; MajorItem; Ion"
			unknownType=		"&itOmniIon2;"
			description=		"This weapon is effective against swarms, but can be deadly to friends as well as foes, or even to the firing ship."

			sortName=			"ion blaster, chain"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"beam"

				omnidirectional=	"true"
				damage=				"ion:4d6"
				fireRate=			"40"
				lifetime=			"30"
				powerUse=			"1400"

				sound=				"&snLaserCannon;"

				passthrough="20"
				>
			<Effect>
				<Beam
						beamType=			"lightning"
						primaryColor=		"0xff, 0xc7, 0xa0"
						secondaryColor=		"0xff, 0x95, 0x00"
						intensity=			"8"
						/>
			</Effect>
		</Weapon>
		<Events>
			<OnFireWeapon>
				(block (shot)
					(setq shot (sysCreateWeaponFire aWeaponType gSource aFirePos aFireAngle 100 aTargetObj))
					(objIncVel shot (objGetVel gSource))
					(objSetData shot "Bonus" aWeaponBonus)
				)
			</OnFireWeapon>
			<OnDamageShields>
				(block (bonus shieldDamage armorDamage target shot offset)
					(setq target (random (sysFindObject gSource "sTAN:60")))
					(if (eq target gSource) (setq target aAttacker))
					(setq bonus (objGetData aCause "Bonus"))
					(if (not bonus) (setq bonus 0))
					(setq shieldDamage (divide (multiply (add 100 bonus) aShieldDamageHP) 100))
					(setq armorDamage (divide (multiply (add 100 bonus) aArmorDamageHP) 100))
					(if (gr shieldDamage aShieldHP)
							(setq armorDamage (add armorDamage (subtract shieldDamage aShieldHP)))
					)
					(if (leq -90 bonus)
						(block (shot)
							(setq shot (sysCreateWeaponFire aWeaponType gSource aHitPos 
								(sysVectorAngle (sysVectorSubtract (objGetPos target) aHitPos)) 
								100 target))
							(objIncVel shot (objGetVel target))
							(objSetData shot "Bonus" (subtract bonus 10))
						)
					)
(dbgoutput bonus)
					(list aShieldReflect shieldDamage armordamage))
				)
(gSource aArmorSeg aAtacker aCause aHitDir aWeaponType)
			</OnDamageShields>
			<OnDamageArmor>
				(block (bonus)
					(setq target (random (sysFindObject gSource "sTAN:60")))
					(if (eq target gSource) (setq target aAttacker))
					(setq bonus (objGetData aCause "Bonus"))
					(if (not bonus) (setq bonus 0))
					(if (leq -90 bonus)
						(block (shot)
							(setq shot (sysCreateWeaponFire aWeaponType gSource aHitPos 
								(sysVectorAngle (sysVectorSubtract (objGetPos target) aHitPos)) 
								100 target))
							(objIncVel shot (objGetVel target))
							(objSetData shot "Bonus" (subtract bonus 10))
						)
					)
(dbgoutput bonus)
					(divide (multiply (add 100 bonus) aDamageHP) 100))
				)
			</OnDamageArmor>
		</Events>
	</ItemType>

	<!-- Polybolos -->

	<ItemType UNID="&nwiPolybolos;"
			name=				"Polybolos light howitzer"
			level=				"5"
			value=				"9000"
			mass=				"4000"
			frequency=			"common"
			numberAppearing=	"1"
			attributes=			"MajorItem; NWI; Howitzer; BlastCannon"
			unknownType=		"&itUnknownBlastCannon2;"
			description=		"The Polybolos Light Howitzer is a relatively fast firing weapon based on Urak designs."

			sortName=			"NW Howitzer 1"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"

				damage=				"blast:2d12; momentum2; WMD3"
				fireRate=			"20"
				missileSpeed=		"50"
				hitPoints=			"3"
				lifetime=			"90"
				powerUse=			"200"
				recoil=				"1"

				directional=		"true"
				sound=				"&snRecoillessCannon;"
				>



			<Effect>
				<MoltenBolt
						width=				"5"
						length=				"20"
						growth=				"3"
						primaryColor=		"0xea, 0xed, 0xae"
						secondaryColor=		"0xc0, 0xc2, 0x85"
						/>
			</Effect>

			<HitEffect
					sound="&snArmorHit1;"
					>
				<Image imageID="&rsMediumExplosions;" 
						imageX="0" 
						imageY="0" 
						imageWidth="64" 
						imageHeight="64"
						imageFrameCount="16"
						imageTicksPerFrame="2"/>
			</HitEffect>

			<Fragment 
					count=			"1d3+3"
					type=			"missile"
					lifetime=		"8"
					damage=			"blast:1d4+2; momentum2; WMD4"
					missileSpeed=	"24-48"
					>

				<Effect>
					<ImageAndTail 
							imageID=			"&rsMissiles;" 
							imageX=				"96" 
							imageY=				"0" 
							imageWidth=			"16" 
							imageHeight=		"16"
							imageFrameCount=	"2"
							imageTicksPerFrame=	"2"

							length=				"48"
							width=				"3"
							primaryColor=		"0xff, 0xff, 0xff"
							secondaryColor=		"0xc0, 0xc2, 0x85"
							/>
				</Effect>
			</Fragment>
			<Fragment 
					count=			"1"
					type=			"radius"
					lifetime=		"10"
					damage=			"blast:2d12; momentum1; WMD3"
					missileSpeed=		"0"

					minRadius=		"1"
					maxRadius=		"3"
					>
				<Effect>
					<Flare
							style=			"fadingBlast"
							radius=			"5"
							primaryColor=	"0xff, 0xf0, 0x30"
							lifetime=		"8"
							/>
				</Effect>
			</Fragment>
		</Weapon>

	</ItemType>

	<!-- Helepolis Howitzer -->

	<ItemType UNID="&nwiHelepolis;"
			name=				"Helepolis howitzer"
			level=				"8"
			value=				"90000"
			mass=				"10000"
			frequency=			"common"
			numberAppearing=	"1"
			attributes=			"Howitzer; MajorItem; Military; NWA; ThermoCannon"
			unknownType=		"&itUnknownThermoCannon2;"
			description=		"This weapon, the heaviest howitzer Northwind produces, is also the most traditional."

			sortName=			"NW Howitzer 6"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"

				damage=				"thermo:2d8+1; momentum2; WMD6"
				fireRate=			"40"
				missileSpeed=		"50"
				lifetime=			"150"
				hitPoints=			"10"
				powerUse=			"1200"
				recoil=				"1"
				repeating=		"2"

				fireEffect=			"&efMediumCannonFlash;"
				sound=				"&snRecoillessCannon;"
				>

			<Effect>
				<MoltenBolt
						width=				"6"
						length=				"56"
						growth=				"3"
						primaryColor=		"0xff, 0xff, 0x80"
						secondaryColor=		"0xff, 0x65, 0x21"
						/>
			</Effect>

			<HitEffect
					sound="&snArmorHit1;"
					>
				<Image imageID="&rsExplosionsAG96;" 
						imageX="0" 
						imageY="0" 
						imageWidth="96" 
						imageHeight="96"
						imageFrameCount="16"
						imageTicksPerFrame="2"/>
			</HitEffect>

			<Configuration aimTolerance="0">
				<Shot posAngle="10" posRadius="10" angle="1d2"/>
				<Shot posAngle="350" posRadius="10" angle="1d2-1"/>
			</Configuration>
		</Weapon>

	</ItemType>

	<!-- Plasma Carronade -->

	<ItemType UNID="&nwiPlasmaCarronade;"
			name=				"plasma carronade"
			level=				"10"
			value=				"400000"
			mass=				"2000"
			frequency=			"rare"
			attributes=			"NWA; MajorItem; Military"
			unknownType=		"&itUnknownPlasmaWeapon2;"
			description=		"This weapon can quickly fire small bursts or build up charge to fire a devastating blast."
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				fireRate=			"2"

				type=				"particles"

				lifetime=			"40"
				hitPoints=			"100"
				interaction=			"0"
				damage=				"plasma:6d2-5; WMD7"
				powerUse=			"2000"

				counter=			"temperature"
				counterActivate=	"1"
				counterUpdate=		"-2"
				counterUpdateRate=	"3"

				missileSpeed=		"40"
				particleCount=		"2"
				particleSpreadAngle=	"1"
				sound=				"&snLaserCannon;"
				>

			<Effect>
				<MoltenBolt
						width=				"2"
						growth=				"3"
						primaryColor=		"0xff, 0xff, 0x80"
						secondaryColor=		"0xff, 0x80, 0x40"
						/>
			</Effect>

			<HitEffect
					sound="&snArmorHit1;"
					>
				<Image imageID="&rsMediumExplosions;" 
						imageX="0" 
						imageY="0" 
						imageWidth="64" 
						imageHeight="64"
						imageFrameCount="16"
						imageTicksPerFrame="2"/>
			</HitEffect>
		</Weapon>

		<StaticData>
			<PowerBuildupIncreaseSquareFactor>34</PowerBuildupIncreaseSquareFactor>
			<BaseMultiplierCap>100</BaseMultiplierCap>
			<MinFireRate>4</MinFireRate>
		</StaticData>

				<Events>
			<OnFireWeapon>
				(block (counter)
					(setq counter (objGetData gSource "PowerupCounter"))
					(if (not counter) (setq counter 0))
					(if (not (objGetData gSource "PowerupTimerExists"))
						(block (station)
							(setq station (sysCreateStation &nwtCounterPowerup; nil))
							(objSetData gSource "PowerupTimerExists" "true")
							(objSetData station "UNID" (itmGetUnid gItem))
							(objSetData station "source" (objGetId gSource))
							(objSetData gSource "PowerupCounter" 1)
							(sysAddObjRecurringTimerEvent 2 station "Powerup")
						) 
						(block nil
							(objSetData gSource "PowerupCounter" (add 1 counter))
							(objSetData gSource "PowerupFlag" 1)
						)
					)
					(objSetData gSource "FireAngle" aFireAngle)
					(block (multiplierCap percentage)
						; do something with enhancments: increase maximum charge
						(setq multiplierCap (divide (multiply (typGetStaticData (itmGetUnid gItem) 'BaseMultiplierCap) (add 100 aWeaponBonus)) 100))
						(objSetData gSource "MultiplierCap" multiplierCap)
						(setq percentage (divide (multiply 100 counter) multiplierCap))
						(objSendMessage gSource gSource (cat (min percentage 100) "% power" ))
					)
					(sysCreateEffect &efMediumCannonFlash; gSource aFirePosaFireAngle)
					"shotFired"
                                )
			</OnFireWeapon>
			<OnAIUpdate>
				(if (itmIsDamaged gItem)
					(shpRepairItem gSource gItem)
				)
			</OnAIUpdate>
		</Events>
	</ItemType>

<!--	timer holder station to count power buildup	-->

	<StationType UNID="&nwtCounterPowerup;"
                        name=                           "(powerup timer)"
			backgroundObject=	"true"
                        >
                
                <Image                  imageID="&rsStations1;" imageX="0" imageY="256" imageWidth="1" imageHeight="1"/>
 
                <Events>
                        <Powerup>
				(block (source counter UNID multiplierCap)
					(setq source (objGetObjByID (objGetData gSource "source")))
					(setq counter (objGetData source "PowerupCounter"))
					(setq UNID (objGetData gSource "UNID"))
					(setq multiplierCap (objGetData source "MultiplierCap"))
					(if (gr counter multiplierCap) (setq counter multiplierCap))
					(if (objGetData source "PowerupFlag")
						(objsetdata source "PowerupFlag" nil)
						(block (shotcounter shot)
							(if (gr counter (typGetStaticData UNID 'MinFireRate))
								; fire multiple shots, both so the weapon works against stations and for the visual effect 
								; with stacked particles weapons.
								(for shotcounter 1 counter 
								(block nil
									(setq shot (sysCreateWeaponFire UNID source (objGetPos source) (objGetData source "FireAngle") (typGetDataField UNID "speed") nil))
                                                        		(objIncVel shot (objGetVel source))
									; The later shots do more damage, giving charging up an advantage to compensate for 
									; the heat sink counter. This extra damage is not applied against stations. 
									(objSetData shot "damageMultiplier" (divide shotcounter (typGetStaticData UNID 'PowerBuildupIncreaseSquareFactor)))
									(objSetData source "PowerupTimerExists" nil)
									(objDestroy gSource)
								))
							)
                                                )
					)
				)
                        </Powerup>
                </Events>
        </StationType> 


	<!-- Plumbata Minigun -->

	<ItemType UNID="&nwiMinigun;"
			name=				"Plumbata minigun"
			level=				"1"
			value=				"250"
			mass=				"2000"
			frequency=			"rare"
			attributes=			"MajorItem; NWA; Cannon"
			showReference=		"true"
			unknownType=		"&itUnknownKineticCannon8;"
			description=		"This specialized version of the recoilless cannon shoots lighter projectiles but has a higher fire rate."

			sortName=			"NW polearm, 0"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"

				damage=				"kinetic:1d3+1; momentum1"
				fireRate=			"2"
				missileSpeed=		"60"
				interaction=		"50"
				lifetime=			"30"
				powerUse=			"15"

				counter=			"temperature"
				counterActivate=	"1"
				counterUpdate=		"-1"
				counterUpdateRate=	"2"

				sound=				"&snRecoillessCannon;"
				>

			<Effect>
				<Bolt
						length=				"12"
						width=				"2"
						primaryColor=		"0xcd, 0xf3, 0xff"
						secondaryColor=		"0x8f, 0xa9, 0xb2"
						/>
			</Effect>
		</Weapon>
		<StaticData>
			<initialFireRateAdj>10</initialFireRateAdj>
		</StaticData>
		<Events>
			<OnFireWeapon>
				(block (fireDelayCounter fireRateCounter doNotFire)
					(setq fireDelayCounter (objGetData gSource "FireDelayCounter"))
					(setq fireRateCounter (objGetData gSource "FireRateCounter"))
					(setq spinUpCounter (objGetData gSource "SpinUpCounter"))


					(if (not (objGetData gSource "SpinUpTimerExists"))
						(block (station)
							(setq station (sysCreateStation &nwtCounterSpinUp; nil))

							(objSetData gSource "SpinUpTimerExists" "true")
							(objSetData station "source" (objgetid gSource))
							(setq fireRateCounter (typGetStaticData (itmGetUNID gItem) 'initialFireRateAdj))
;							(setq fireRateCounter 10)

							(objSetData gSource "FireRateCounter" fireRateCounter)
							(setq fireDelayCounter 1)
							(objSetData gSource "FireDelayCounter" 1)
							(sysAddObjRecurringTimerEvent 2 station "SpinUp")
						) 
						(block nil
							(setq fireDelayCounter (add fireDelayCounter 1))
							(objSetData gSource "SpinUpFlag" "true")
						)
					)

					(if (gr fireDelayCounter fireRateCounter)
						(setq fireDelayCounter 1)
					)
					(if (gr spinUpCounter (typGetStaticData (itmGetUNID gItem) 'initialFireRateAdj))
						(block nil
							(setq fireRateCounter (subtract fireRateCounter 1))
							(setq spinUpCounter 0)
						)
					)
					(setq spinUpCounter (add spinUpCounter 1))

					(objSetData gSource "FireDelayCounter" fireDelayCounter)
					(objSetData gSource "FireRateCounter" fireRateCounter)
					(objSetData gSource "SpinUpCounter" spinUpCounter)

					(if (geq 1 fireDelayCounter)
						; returning nil lets the engine handle the shot normally so we don't lose enhancments.
						(setq doNotFire nil)
						; returning anything else prevents any firing
						(setq doNotFire "true")
					)
					doNotFire
				)
			</OnFireWeapon>
			<OnAIUpdate>
				(if (itmIsDamaged gItem)
					(shpRepairItem gSource gItem)
				)
			</OnAIUpdate>
		</Events>
	</ItemType>

<!--	timer holder station to count speed buildup	-->

        <StationType UNID="&nwtCounterSpinUp;"
                        name=                           "(spin up timer)"
			backgroundObject=	"true"
                        >
                
                <Image                  imageID="&rsStations1;" imageX="0" imageY="256" imageWidth="1" imageHeight="1"/>
 
                <Events>
 
                        <SpinUp>
				(block (source fireDelayCounter fireRateCounter)
					(setq source (objGetObjByID (objGetData gSource "source")))
					(if (objGetData source "SpinUpFlag")
						(objsetdata source "SpinUpFlag" nil)
						(block nil
							(objSetData source "SpinUpTimerExists" nil)
							(objDestroy gSource)
						)
					)
				)
                        </SpinUp>
                </Events>
        </StationType> 

	<!-- Ion Howitzer -->

	<ItemType UNID="&nwiIonHowitzer;"
			name=				"Tesla ion howitzer"
			level=				"8"
			value=				"90000"
			mass=				"4000"
			frequency=			"rare"
			numberAppearing=	"1"
			attributes=			"Howitzer; MajorItem; Military; NWA; EnergyWeapon; Recoil"

			description=		"This powerful weapon strips helium to produce a burst of electrons followed by a burst of alpha particles.  Its open cycle cooling provides further danger at short range."

			sortName=			"NW Howitzer 7"
			charges=			"0"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>
		<Weapon
				fireRate=			"45"
				powerUse=			"120"
				recoil=				"4"
				>

			<Missiles>
				<Missile ammoID="&nwviTeslaAmmo;"
						type=			"missile"

						damage=			"ion:10d10; momentum5; WMD6"
						missileSpeed=	"60"
						lifetime=		"100"

						sound=			"&snShieldHit1;"
						>

					<Effect>
						<PlasmaSphere
								spikeCount=		"2d6+2"
								spikeLength=	"2d30"
								radius=		"10"
								primaryColor=	"0xff, 0xa0, 0xa0"
								secondaryColor=	"0xf0, 0xf0, 0xff"
								/>
					</Effect>

				</Missile>
				
			</Missiles>

		</Weapon>

		<Events>
			<onFireWeapon>
				(block (shot speed charges)
					; check charges
					(setq charges (itmGetCharges gItem))
					(if (gr charges 0)
						(shpRechargeItem gsource gItem -1)
						; remove fuel rod and replenish charges
						(block (ammotype)
							(if (objHasItem gsource (itmCreate &itHelium3FuelRod; 1))
								(setq ammotype &itHelium3FuelRod;)
								(if (objHasItem gsource (itmCreate &itHeliumAssembly; 1))
									(setq ammotype &itHeliumAssembly;)
								)
							)
							; give charges
							(switch
								(eq &itHelium3FuelRod; ammotype)
									(shpRechargeItem gsource gItem 1)
								(eq &itHeliumAssembly; ammotype)
									(shpRechargeItem gsource gItem 7)
							)
							(objRemoveItem gSource (itmCreate ammotype 1))
						)
					)

					; fire the extra shots
					(setq shot (sysCreateWeaponFire &nwviTeslaElectron; gSource aFirePos aFireAngle 100 aTargetObj))
					(objIncVel shot (objGetVel gSource))
					(setq shot (sysCreateWeaponFire &nwviCoolantVent1; gSource aFirePos aFireAngle 40 aTargetObj))
					(objIncVel shot (objGetVel gSource))
					(setq shot (sysCreateWeaponFire &nwviCoolantVent2; gSource aFirePos aFireAngle 30 aTargetObj))
					(objIncVel shot (objGetVel gSource))

					; and the normal shot
					nil
				)
			</onFireWeapon>
			<onUpdate>
				(block (rods assemblies charges shots realshots)
					; count charges
					(setq charges (itmGetCharges gItem))
					; count fuel
					(objEnumItems gSource "f" theItem
						(switch 
							(eq (itmGetUnid theItem) &itHelium3FuelRod;)
								(setq rods (itmGetCount theItem))
							(eq (itmGetUnid theItem) &itHeliumAssembly;)
								(setq assemblies (itmGetCount theItem))
						)
					)
					; count shots
					(objEnumItems gSource "*V" theItem
						(if (eq (itmGetUnid theItem) &nwviTeslaAmmo;)
							(setq shots (itmGetCount theItem))
						)
					)
					(setq realshots (add (multiply 2 rods) (multiply 8 assemblies) charges))
					(switch
						(gr realshots shots)
							(objadditem gSource (itmCreate &nwviTeslaAmmo; (subtract realshots shots)))
						(ls realshots shots)
							(objremoveitem gSource (itmCreate &nwviTeslaAmmo; (subtract shots realshots)))
					)
				)
			</onUpdate>
		</Events>

	</ItemType>

	<ItemType UNID="&nwviTeslaElectron;"
			name=				"<Tesla Electron Burst>"
			virtual=			"true"
			>
		<Weapon
				type=				"particles"

				damage=				"ion:10d10"
				fireRate=			"30"
				missileSpeed=		"100"
				lifetime=			"60"

				particleCount=		"100"
				particleSpreadAngle="1"
				sound=				"&snRecoillessCannon;"
				>

			<Effect>
				<Particle
						style=			"line"
						primaryColor=	"0x80, 0xc0, 0xff"
						secondaryColor=	"0x00, 0x80, 0xff"
						/>
			</Effect>
		</Weapon>
	</ItemType>

	<ItemType UNID="&nwviCoolantVent1;"
			name=				"<Narrow Spray>"
			virtual=			"true"
			>
		<Weapon
				type=				"particles"

				damage=				"plasma:30; WMD7"
				fireRate=			"30"
				missileSpeed=		"40"
				lifetime=			"50"

				particleCount=		"300"
				particleSpreadAngle="30"
				sound=				"&snRecoillessCannon;"
				>

			<Effect>
				<Particle
						style=			"flame"
						minWidth=		"3" 
						maxWidth=		"3-7"
						/>
			</Effect>
		</Weapon>
	</ItemType>

	<ItemType UNID="&nwviCoolantVent2;"
			name=				"<Wide Spray>"
			virtual=			"true"
			>
		<Weapon
				type=				"particles"

				damage=				"plasma:60; WMD7"
				fireRate=			"30"
				missileSpeed=		"40"
				lifetime=			"30"

				particleCount=		"500"
				particleSpreadAngle="45"
				particleSplashChance="50"
				sound=				"&snRecoillessCannon;"
				>

			<Effect>
				<Particle
						style=			"flame"
						minWidth=		"3" 
						maxWidth=		"3-7"
						/>
			</Effect>
		</Weapon>
	</ItemType>


	<ItemType UNID="&nwviTeslaAmmo;"
			name=				"<virtual Tesla Howitzer ammo>"
			level=				"5"
			virtual=			"true"
			attributes=			"Consumable; Missile; NWA"
			>

		<Image imageID="&rsItems1;" imageX="288" imageY="192" imageWidth="96" imageHeight="96"/>
	</ItemType>

	<!-- Orthrus Fusion Cannon -->

	<ItemType UNID="&nwiOrthrus;"
			name=				"Orthrus Fusion Cannon"
			level=				"7"
			value=				"15000"
			mass=				"4000"
			frequency=			"uncommon"
			attributes=			"MajorItem; NWA; Military; ThermoCannon"
			showReference=		"true"

			description=		"Though released later than the Cerberus, the Orthrus Fusion Cannon is developed from an early prototype without automatic tracking. It has three manual tracking modes."

			sortName=			"NW Orthrus"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"

				damage=				"thermo:8d4; momentum3; WMD5"

				fireRate=			"20"
				missileSpeed=			"40"
				lifetime=			"150"
				powerUse=			"600"
				fireEffect=			"&efMediumCannonFlash;"
				sound=				"&snRecoillessCannon;"
				>
			
			<Effect>
				<Starburst
						style=			"flare"
						spikeCount=		"1d6+5"
						spikeLength=	"3d10"
						primaryColor=	"0xff, 0xff, 0x80"
						secondaryColor=	"0xd0, 0x20, 0x00"
						/>
			</Effect>
			<Configuration aimTolerance="5" alternating="true">
				<Shot posAngle="90" posRadius="20" angle="-6"/>
				<Shot posAngle="270" posRadius="20" angle="6"/>
			</Configuration>
		</Weapon>
		<Invoke key="W" installedOnly="true">
		(block (mode modes strings)
			(setq modes (itmGetStaticData gItem "ModeCount"))
			(setq mode (modulo (add (itmGetData gItem "controlMode") 1) modes))
			(setq strings (itmGetStaticData gItem "ModeStrings"))
			(objSetItemData gSource gItem "controlMode" mode)
			(objSendMessage gSource Nil (item strings mode))
			(if (eq 1 mode) 
				(objSetItemData gSource gItem "overlayIndex" (objAddOverlay gSource &nwoOrthrusGUI;))
				(objSetItemData gSource gItem "overlayIndex" (objRemoveOverlay gSource (itmGetData gItem "overlayIndex")))
			)
		)
		</Invoke>
		<Events>
			<onFireWeapon>
				(block (shot mode eventNames)
					(setq mode (itmGetData gItem "controlMode"))
					(setq eventNames (itmGetStaticData gItem "EventNames"))
					(if (not mode) (setq mode 0))
					(setq shot (sysCreateWeaponFire aWeaponType gSource aFirePos aFireAngle (typGetDataField aWeaponType "speed") aTargetObj nil aWeaponBonus))
					(objIncVel shot (objGetVel gSource))
					(objSetEventHandler shot &nwsOrthrusController;)
					(sysAddObjRecurringTimerEvent 1 shot (item eventNames mode))
					(objSetData shot "parent" (objgetid gsource))
					(objSetData shot "weapon" aWeaponType)
;	NB-- adjust this to determine how far from the source shots go ballistic
					(objSetData shot "trackRange" 60)
				)
			</onFireWeapon>
			<OnUninstall>
				(block nil
					(if (objGetData gSource "overlayIndex") (objRemoveOverlay gSource (objGetData gSource "overlayIndex")))
					(objSetData gSource "overlayIndex" nil)
				)
			</OnUninstall>
			<OnAIUpdate>
				(objSetItemData gSource gItem "controlMode" (modulo (onjGetDesting gSource) modes))
				
			</OnAIUpdate>
		</Events>
		<StaticData>
			<ModeCount>3</ModeCount>
			<ModeStrings>(
				"Ship Facing Guided"
				"Line Tracking Active"
				"Shield Mode"
			)</ModeStrings>
			<EventNames>(
				"Follow"
				"Track"
				"Defend"
			)</EventNames>
		</StaticData>
	</ItemType>

	<ShipClass UNID="&nwsOrthrusController;"
			manufacturer=		""
			class=				"if this appears you have a bug"
			type=				""
			score=				"0"
			techOrder=			"mech"

			mass=				"1"
			cargoSpace=			"1"
			thrust=				"1"
			maneuver=			"1"
			maxSpeed=			"1"

			>


		<Events>
			<Follow>
				(block (maxShotSpeed maxTrackingRange firingSource firingWeapon)
					(setq maxShotSpeed (typGetDataField (objgetdata gsource "weapon") "speed"))
					(setq maxTrackingRange (objgetdata gsource "trackRange"))
					(setq firingSource (objgetobjbyid (objgetdata gsource "parent")))
					(objIncVel gSource (sysVectorDivide (objGetVel gSource) -10))
					(objIncVel gSource (sysVectorPolarVelocity (shpGetDirection firingSource) (probabilisticDivide maxshotspeed 10)))
					(if (gr (objGetDistance firingSource gsource) maxTrackingRange)
						(sysCancelTimerEvent gsource "Follow")
					)
				)
			</Follow>
			<Track>
				(block (maxShotSpeed maxTrackingRange firingSource firingWeapon baseVel newAngle)
					(setq maxShotSpeed (typGetDataField (objgetdata gsource "weapon") "speed"))
					(setq maxTrackingRange (objgetdata gsource "trackRange"))
					(setq firingSource (objgetobjbyid (objgetdata gsource "parent")))

					; track ship direction
					(if
						(ls 
							(angleNormalize
								(subtract
									(shpGetDirection firingSource)
									(sysvectorangle (sysvectorsubtract (objGetPos gSource) (objGetPos firingSource)))
								)
							)
							180
						)
						(setq newAngle (angleNormalize (add (sysvectorangle (objgetvel gsource)) 90)))
						(setq newAngle (angleNormalize (subtract (sysvectorangle (objgetvel gsource)) 90)))
					)

					; angle forward to avoid shots hanging
					(setq newAngle (angleBisect newAngle (shpGetDirection firingSource)))

					(objIncVel gSource (sysVectorDivide (objGetVel gSource) -10))
					(objIncVel gSource (sysVectorPolarVelocity newAngle (probabilisticDivide maxshotspeed 10)))
					(if (gr (objGetDistance firingSource gsource) maxTrackingRange)
						(sysCancelTimerEvent gsource "Track")
					)
				)
			</Track>
			<Defend>
				(block (maxShotSpeed maxTrackingRange firingSource firingWeapon baseVel newAngle)
					(setq maxShotSpeed (typGetDataField (objgetdata gsource "weapon") "speed"))
					(setq maxTrackingRange (objgetdata gsource "trackRange"))
					(setq firingSource (objgetobjbyid (objgetdata gsource "parent")))

					; track ship direction
					(if
						(ls 
							(angleNormalize
								(subtract
									(shpGetDirection firingSource)
									(sysvectorangle (sysvectorsubtract (objGetPos gSource) (objGetPos firingSource)))
								)
							)
							180
						)
						(setq newAngle (angleNormalize (add (sysvectorangle (sysvectorsubtract (objGetPos gSource) (objGetPos firingSource))) (random 120 135))))
						(setq newAngle (angleNormalize (subtract (sysvectorangle (sysvectorsubtract (objGetPos gSource) (objGetPos firingSource))) (random 120 135))))
					)

					; angle forward to avoid shots hanging
					(if (leq (objGetDistance gSource firingSource) 10)
						(setq newAngle (angleBisect newAngle (shpGetDirection firingSource)))
					)


					(objIncVel gSource (sysVectorDivide (objGetVel gSource) -10))
					(objIncVel gSource (sysVectorPolarVelocity newAngle (probabilisticDivide maxshotspeed 10)))
					(if (gr (objGetDistance firingSource gsource) maxTrackingRange)
						(sysCancelTimerEvent gsource "Defend")
					)
				)
			</Defend>
		</Events>
	</ShipClass>

	<OverlayType UNID="&nwoOrthrusGUI;">
		<Effect>
			<Shape width="1" length="100" widthInc="1" lengthInc="1" color="0xff, 0x00, 0x00" opacity="64" directional="true" />
		</Effect>
	</OverlayType>

	<!-- Schiltron Laser Array -->

	<ItemType UNID="&nwiSchiltron;"
			name=				"Schiltron Laser Array"
			level=				"4"
			value=				"3200"
			mass=				"20000"
			frequency=			"common"
			attributes=			"NWA; EnergyWeapon; MajorItem; Laser"
			showReference=		"true"

			description=		"The Schiltron Laser Array relies on transponders to control the many laser emitters spaced around the ship."

			sortName=			"NW Polearm 3a"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>
		<Weapon
				type=				"beam"

				damage=				"laser:2d6"
				fireRate=			"16"
				lifetime=			"30"
				powerUse=			"180"

				hitEffect=			"&efGreenLaserHitEffect;" 
				sound=				"&snLaserCannon;"
				>
			<Effect>
				<Beam
						beamType=			"laser"
						primaryColor=		"0x5f, 0xf1, 0x2a"
						secondaryColor=		"0x00, 0xff, 0x00"
						/>
			</Effect>

		<Configuration aimTolerance="360">
		<Shot posAngle="180" posRadius="25" angle="0"/>
		<Shot posAngle="180" posRadius="25" angle="3"/>
		<Shot posAngle="180" posRadius="25" angle="9"/>
		<Shot posAngle="180" posRadius="25" angle="14"/>
		<Shot posAngle="180" posRadius="25" angle="20"/>
		<Shot posAngle="180" posRadius="25" angle="30"/>
		<Shot posAngle="180" posRadius="25" angle="40"/>
		<Shot posAngle="180" posRadius="25" angle="50"/>
		<Shot posAngle="180" posRadius="25" angle="60"/>
		<Shot posAngle="180" posRadius="25" angle="70"/>
		<Shot posAngle="180" posRadius="25" angle="80"/>
		<Shot posAngle="180" posRadius="25" angle="90"/>
		<Shot posAngle="180" posRadius="25" angle="100"/>
		<Shot posAngle="180" posRadius="25" angle="110"/>
		<Shot posAngle="180" posRadius="25" angle="120"/>
		<Shot posAngle="180" posRadius="25" angle="130"/>
		<Shot posAngle="180" posRadius="25" angle="140"/>
		<Shot posAngle="180" posRadius="25" angle="150"/>
		<Shot posAngle="180" posRadius="25" angle="160"/>
		<Shot posAngle="180" posRadius="25" angle="170"/>
		<Shot posAngle="180" posRadius="25" angle="180"/>
		<Shot posAngle="180" posRadius="25" angle="190"/>
		<Shot posAngle="180" posRadius="25" angle="200"/>
		<Shot posAngle="180" posRadius="25" angle="210"/>
		<Shot posAngle="180" posRadius="25" angle="220"/>
		<Shot posAngle="180" posRadius="25" angle="230"/>
		<Shot posAngle="180" posRadius="25" angle="240"/>
		<Shot posAngle="180" posRadius="25" angle="250"/>
		<Shot posAngle="180" posRadius="25" angle="260"/>
		<Shot posAngle="180" posRadius="25" angle="270"/>
		<Shot posAngle="180" posRadius="25" angle="280"/>
		<Shot posAngle="180" posRadius="25" angle="290"/>
		<Shot posAngle="180" posRadius="25" angle="300"/>
		<Shot posAngle="180" posRadius="25" angle="310"/>
		<Shot posAngle="180" posRadius="25" angle="320"/>
		<Shot posAngle="180" posRadius="25" angle="330"/>
		<Shot posAngle="180" posRadius="25" angle="340"/>
		<Shot posAngle="180" posRadius="25" angle="346"/>
		<Shot posAngle="180" posRadius="25" angle="351"/>
		<Shot posAngle="180" posRadius="25" angle="357"/>
		</Configuration>

		</Weapon>
		<Events>
			<onFireWeapon>
				(block (targetlist)
					(setq targetlist (filter (append (sysfindobject gsource "sTAEN:60") aTargetObj) target 
						(ls 
							(abs 
								(subtract 
									(sysCalcFireSolution 
										(sysVectorSubtract (objGetPos target) (objGetPos gsource)) 
										(objGetVel target) 
										(typGetDataField aWeaponType "speed")
									) 
									aFireAngle
								)
							) 
						7
						)
					))
					(if (item targetlist 0) nil true)
				)
			</onFireWeapon>
		</Events>
	</ItemType>


<!--	WE weapons	-->

	<!-- Spetum Cannon -->

	<ItemType UNID="&nwiRanseurSpetum;"
			name=				"spetum cannon"
			level=				"2"
			value=				"1600"
			mass=				"3500"
			frequency=			"notrandom"
			attributes=			"MajorItem; NWI; Cannon"
			showReference=		"true"
			unknownType=		"&itUnknownKineticCannon;"
			description=		"The Northwind Armories Spetum cannon uses burst fire similar to the NAMI DK10 Arbalest with a traversal system that allows it to also compete with NAMI's TK10 Trident. The Spetum fires faster than the Ranseur"

			sortName=			"NW Polearm 0"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"

				damage=				"kinetic:1d6; momentum1"
				fireRate=			"20"
				repeating=		"3"
				missileSpeed=		"60"
				interaction=		"60"
				lifetime=			"50"
				powerUse=			"40"

				sound=				"&snRecoillessCannon;"
				>

			<Effect>
				<Bolt
						length=				"12"
						width=				"2"
						primaryColor=		"0xcd, 0xf3, 0xff"
						secondaryColor=		"0x8f, 0xa9, 0xb2"
						/>
			</Effect>

		</Weapon>
		<Invoke key="W" installedOnly="true">
		(block (mode)
			(setq mode (not (itmGetData gItem "spreadMode")))
			(objSetItemData gSource gItem "spreadMode" mode)
			(if mode
				(objSendMessage gSource Nil (cat "Spetum in spread mode"))
				(objSendMessage gSource Nil (cat "Spetum in repeat mode"))
			)
		)
		</Invoke>

		<Events>
			<onFireWeapon>
				(block (angle speed mode)
					(setq mode (not (itmGetData gItem "spreadMode")))
					(setq angle aFireAngle)
					(if mode
						(setq speed (divide (multiply (typGetDataField aWeaponType "speed") 2) 3))
						(setq speed (typGetDataField aWeaponType "speed"))
					)
					(if (and mode (eq aFireRepeat 1))
						(setq angle (subtract angle 5))
					)
					(if (and mode (eq aFireRepeat 3))
						(setq angle (add angle 5))
					)
					(setq shot (sysCreateWeaponFire aWeaponType gSource aFirePos angle speed aTargetObj nil aWeaponBonus))
					(objIncVel shot (objGetVel gSource))
				)
			</onFireWeapon>
			<OnAIUpdate>
					(block (target)
					(setq target (objGetTarget gSource))
					(if (leq 1 (random 1 2))
						(objSetItemData gSource gItem "spreadMode" nil)
						(objSetItemData gSource gItem "spreadMode" "true")
					)
				)
			</OnAIUpdate>
		</Events>

	</ItemType>

	<!-- Ranseur Cannon -->

	<ItemType UNID="&nwiRanseurOxTongue;"
			name=				"ox tongue cannon"
			level=				"2"
			value=				"1400"
			mass=				"3500"
			frequency=			"notrandom"
			attributes=			"MajorItem; NWI; Cannon"
			showReference=		"true"
			unknownType=		"&itUnknownKineticCannon;"
			description=		"The Northwind Armories Ox Tongue cannon uses burst fire similar to the NAMI DK10 Arbalest with a traversal system that allows it to also compete with NAMI's TK10 Trident. The Ox Tongue is heavier than the Ranseur"

			sortName=			"NW Polearm 0"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"

				damage=				"kinetic:2d6-1; momentum1"
				fireRate=			"20"
				repeating=		"1"
				missileSpeed=		"60"
				interaction=		"60"
				lifetime=			"50"
				powerUse=			"30"

				sound=				"&snRecoillessCannon;"
				>

			<Effect>
				<Bolt
						length=				"12"
						width=				"2"
						primaryColor=		"0xcd, 0xf3, 0xff"
						secondaryColor=		"0x8f, 0xa9, 0xb2"
						/>
			</Effect>

		</Weapon>

				<Invoke key="W" installedOnly="true">
		(block (mode)
			(setq mode (not (itmGetData gItem "spreadMode")))
			(objSetItemData gSource gItem "spreadMode" mode)
			(if mode
				(objSendMessage gSource Nil (cat "Ox Tongue in spread mode"))
				(objSendMessage gSource Nil (cat "Ox Tongue in repeat mode"))
			)
		)
		</Invoke>

		<Events>
			<onFireWeapon>
				(block (angle speed mode)
					(setq mode (not (itmGetData gItem "spreadMode")))
					(setq angle aFireAngle)
					(if mode
						(setq speed (divide (multiply (typGetDataField aWeaponType "speed") 2) 3))
						(setq speed (typGetDataField aWeaponType "speed"))
					)
					(if (and mode (eq aFireRepeat 0))
						(setq angle (subtract angle 2))
					)
					(if (and mode (eq aFireRepeat 1))
						(setq angle (add angle 2))
					)
					(setq shot (sysCreateWeaponFire aWeaponType gSource aFirePos angle speed aTargetObj nil aWeaponBonus))
					(objIncVel shot (objGetVel gSource))
				)
			</onFireWeapon>
			<OnAIUpdate>
				(block (target)
					(setq target (objGetTarget gSource))
					(if (leq 1 (random 1 2))
						(objSetItemData gSource gItem "spreadMode" nil)
						(objSetItemData gSource gItem "spreadMode" "true")
					)
				)
			</OnAIUpdate>
		</Events>

	</ItemType>

	<!-- Gatling Laser Cannon -->

	<ItemType UNID="&nwiGatlingLaserPike;"
			name=				"Pike Gatling Laser"
			level=				"3"
			value=				"1500"
			mass=				"2500"
			frequency=			"common"
			attributes=			"NWA; EnergyWeapon; MajorItem; Laser"
			showReference=		"true"
			unknownType=		"&itUnknownLaserWeapon2;"
			description=		"The Northwind Armories Pike Gatling Laser Cannon uses multiple independent amplification chambers to achieve phenomenal rates of fire, but suffers from a corresponding heat buildup. The Pike is more powerful than the Dory, but runs hotter."

			sortName=			"NW Polearm 2"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"beam"

				damage=				"laser:1d6"
				fireRate=			"2"
				lifetime=			"30"
				powerUse=			"30"

				sound=				"&snLaserCannon;"

				counter=			"temperature"
				counterActivate=	"5"
				counterUpdate=		"-2"
				counterUpdateRate=	"4"
				>
			<Effect>
				<Beam
						beamType=			"blaster"
						primaryColor=		"0xff, 0xff, 0x00"
						secondaryColor=		"0xff, 0x00, 0x00"
						/>
			</Effect>

			<Configuration aimTolerance="0" alternating="true">
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="90" posRadius="1" angle="0"/>
				<Shot posAngle="90" posRadius="1" angle="0"/>
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="270" posRadius="1" angle="0"/>
				<Shot posAngle="270" posRadius="1" angle="0"/>
			</Configuration>
		</Weapon>
		<Events>
			<OnAIUpdate>
				(if (itmIsDamaged gItem)
					(shpRepairItem gSource gItem)
				)
			</OnAIUpdate>
		</Events>
	</ItemType>

	<!-- Gatling Laser Cannon -->

	<ItemType UNID="&nwiGatlingLaserSpiculum;"
			name=				"Spiculum Gatling Laser"
			level=				"3"
			value=				"2000"
			mass=				"4000"
			frequency=			"common"
			attributes=			"NWA; EnergyWeapon; MajorItem; Laser"
			showReference=		"true"
			unknownType=		"&itUnknownLaserWeapon2;"
			description=		"The Northwind Armories Spiculum Gatling Laser Cannon uses multiple independent amplification chambers to achieve phenomenal rates of fire. The Spiculum avoids the overheating problems of the Dory and Pike at the expense of much greater mass and bulk."

			sortName=			"NW Polearm 2"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"beam"
				deviceSlots=		"2"

				damage=				"laser:1d4"
				fireRate=			"2"
				lifetime=			"30"
				powerUse=			"30"

				sound=				"&snLaserCannon;"
				>
			<Effect>
				<Beam
						beamType=			"laser"
						primaryColor=		"0xf1, 0x5f, 0x2a"
						secondaryColor=		"0xff, 0x00, 0x00"
						/>
			</Effect>

			<Configuration aimTolerance="0" alternating="true">
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="90" posRadius="1" angle="0"/>
				<Shot posAngle="90" posRadius="1" angle="0"/>
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="270" posRadius="1" angle="0"/>
				<Shot posAngle="270" posRadius="1" angle="0"/>
			</Configuration>
		</Weapon>

	</ItemType>

	<!-- Gatling Laser Cannon -->

	<ItemType UNID="&nwiGatlingTurboKontos;"
			name=				"Kontos Gatling Laser"
			level=				"4"
			value=				"6000"
			mass=				"6000"
			frequency=			"common"
			attributes=			"NWA; EnergyWeapon; MajorItem; Laser"
			showReference=		"true"
			unknownType=		"&itUnknownLaserWeapon3;"
			description=		"The Northwind Armories Kontos Gatling Laser Cannon uses multiple independant amplification chambers to achieve phenomenal rates of fire. The Spiculum avoids the overheating problems of the Sarissa and Xyston at the expense of much greater mass and bulk."

			sortName=			"NW Polearm 3"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"beam"
				deviceSlots=		"2"

				damage=				"laser:2d6"
				fireRate=			"4"
				lifetime=			"30"
				powerUse=			"50"

				hitEffect=			"&efGreenLaserHitEffect;" 
				sound=				"&snLaserCannon;"
				>
			<Effect>
				<Beam
						beamType=			"laser"
						primaryColor=		"0x5f, 0xf1, 0x2a"
						secondaryColor=		"0x00, 0xff, 0x00"
						/>
			</Effect>

			<Configuration aimTolerance="1" alternating="true">
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="90" posRadius="1" angle="0"/>
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="270" posRadius="1" angle="0"/>
			</Configuration>
		</Weapon>

	</ItemType>

	<!-- Gatling Laser Cannon -->

	<ItemType UNID="&nwiGatlingTurboXyston;"
			name=				"Xyston Gatling Laser"
			level=				"4"
			value=				"3600"
			mass=				"4000"
			frequency=			"common"
			attributes=			"NWA; EnergyWeapon; MajorItem; Laser"
			showReference=		"true"
			unknownType=		"&itUnknownLaserWeapon3;"
			description=		"The Northwind Armories Xyston Gatling Laser Cannon uses multiple independant amplification chambers to achieve phenomenal rates of fire, but suffers from a corresponding heat buildup. The Xyston is larger than the Sarissa and fires more rapidly."

			sortName=			"NW Polearm 3"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"beam"

				damage=				"laser:1d12"
				fireRate=			"2"
				lifetime=			"30"
				powerUse=			"50"
				hitEffect=			"&efGreenLaserHitEffect;" 
				sound=				"&snLaserCannon;"

				counter=			"temperature"
				counterActivate=	"5"
				counterUpdate=		"-2"
				counterUpdateRate=	"4"
				>
			<Effect>
				<Beam
						beamType=			"laser"
						primaryColor=		"0x5f, 0xf1, 0x2a"
						secondaryColor=		"0x00, 0xff, 0x00"
						/>
			</Effect>

			<Configuration aimTolerance="1" alternating="true">
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="90" posRadius="1" angle="0"/>
				<Shot posAngle="90" posRadius="1" angle="0"/>
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="270" posRadius="1" angle="0"/>
				<Shot posAngle="270" posRadius="1" angle="0"/>
			</Configuration>
		</Weapon>
		<Events>
			<OnAIUpdate>
				(if (itmIsDamaged gItem)
					(shpRepairItem gSource gItem)
				)
			</OnAIUpdate>
		</Events>
	</ItemType>

	<!-- Heavy Particle Blaster -->

	<ItemType UNID="&nwiHvyParticleBlasterGlaive;"
			name=				"Glaive Particle Blaster"
			level=				"5"
			value=				"8000"
			mass=				"3000"
			frequency=			"uncommon"
			numberAppearing=	"1"
			attributes=			"NWA; Particle; EnergyWeapon; MajorItem"
			unknownType=		"&itUnknownParticleCannon2;"
			description=		"The Northwind Armories Glaive Particle Blaster is a high output particle weapon using multiple firing chambers. The heat sensor and automatic cutoff is more reliable than on the Gatling Laser. The Glaive is heavier, but shorter ranged than the Svärdstav."

			sortName=			"NW Polearm 4"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>


		<Weapon
				type=				"beam"

				damage=				"particle:4d6"
				fireRate=			"4"
				lifetime=			"30"
				powerUse=			"500"

				counter=			"capacitor"
				counterActivate=	"-15"
				counterUpdate=		"10"
				counterUpdateRate=	"8"

				beamType=			"Heavyblaster"
				primaryColor=		"0x00, 0xff, 0x40"
				secondaryColor=		"0x40, 0xff, 0x60"
				sound=				"&snLaserCannon;"
				>


			<Configuration aimTolerance="1" alternating="true">
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="90" posRadius="1" angle="-1"/>
				<Shot posAngle="90" posRadius="1" angle="-1"/>
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="270" posRadius="1" angle="1"/>
				<Shot posAngle="270" posRadius="1" angle="1"/>
			</Configuration>

		</Weapon>

	</ItemType>

	<!-- Heavy Particle Blaster -->

	<ItemType UNID="&nwiHvyParticleBlasterRhomphaia;"
			name=				"Rhomphaia Particle Blaster"
			level=				"5"
			value=				"8000"
			mass=				"3000"
			frequency=			"uncommon"
			numberAppearing=	"1"
			attributes=			"NWA; Particle; EnergyWeapon; MajorItem"
			unknownType=		"&itUnknownParticleCannon2;"
			description=		"The Northwind Armories Rhomphaia Particle Blaster is a high output, penetrating particle weapon using multiple firing chambers. The heat sensor and automatic cutoff is more reliable than on the Gatling Laser. The Rhomphaia is lighter but longer ranged than the Svärdstav."

			sortName=			"NW Polearm 4"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>


		<Weapon
				type=				"beam"

				damage=				"particle:3d4"
				fireRate=			"4"
				lifetime=			"50"
				passthrough=		"40"
				powerUse=			"500"

				counter=			"capacitor"
				counterActivate=	"-8"
				counterUpdate=		"10"
				counterUpdateRate=	"8"

				sound=				"&snLaserCannon;"
				>
			<Effect>
				<Beam
						beamType=			"starblaster"
						primaryColor=		"0x00, 0xff, 0x40"
						secondaryColor=		"0x40, 0xff, 0x60"
						/>
			</Effect>


			<Configuration aimTolerance="1" alternating="true">
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="90" posRadius="1" angle="-1"/>
				<Shot posAngle="90" posRadius="1" angle="-1"/>
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="270" posRadius="1" angle="1"/>
				<Shot posAngle="270" posRadius="1" angle="1"/>
			</Configuration>

		</Weapon>

	</ItemType>

	<!-- Polybolos -->

	<ItemType UNID="&nwiPolybolosRibauldequin;"
			name=				"Ribauldequin light howitzer"
			level=				"5"
			value=				"8000"
			mass=				"4000"
			frequency=			"common"
			numberAppearing=	"1"
			attributes=			"MajorItem; NWI; Howitzer; BlastCannon"
			unknownType=		"&itUnknownBlastCannon2;"
			description=		"The Ribauldequin Light Howitzer is a burst firing weapon based on Urak designs."

			sortName=			"NW Howitzer 1"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"
				fragmentCount=		"1d3+3"

				damage=				"blast:2d12; momentum2; WMD3"
				fireRate=			"60"
				repeating=			"2"
				missileSpeed=		"50"
				hitPoints=			"3"
				lifetime=			"90"
				powerUse=			"200"
				recoil=				"1"

				directional=		"true"
				sound=				"&snRecoillessCannon;"
				>

			<Configuration aimTolerance="0">
				<Shot posAngle="0" posRadius="0" angle="1d3-1"/>
			</Configuration>



			<Effect>
				<MoltenBolt
						width=				"5"
						length=				"20"
						growth=				"3"
						primaryColor=		"0xea, 0xed, 0xae"
						secondaryColor=		"0xc0, 0xc2, 0x85"
						/>
			</Effect>

			<HitEffect
					sound="&snArmorHit1;"
					>
				<Image imageID="&rsMediumExplosions;" 
						imageX="0" 
						imageY="0" 
						imageWidth="64" 
						imageHeight="64"
						imageFrameCount="16"
						imageTicksPerFrame="2"/>
			</HitEffect>

			<Fragment 
					type=			"missile"
					lifetime=		"8"
					damage=			"blast:1d4+2; momentum2; WMD3"
					missileSpeed=	"24-48"
					>

				<Effect>
					<ImageAndTail 
							imageID=			"&rsMissiles;" 
							imageX=				"96" 
							imageY=				"0" 
							imageWidth=			"16" 
							imageHeight=		"16"
							imageFrameCount=	"2"
							imageTicksPerFrame=	"2"

							length=				"48"
							width=				"3"
							primaryColor=		"0xff, 0xff, 0xff"
							secondaryColor=		"0xc0, 0xc2, 0x85"
							/>
				</Effect>
			</Fragment>

		</Weapon>

	</ItemType>

	<!-- Polybolos -->

	<ItemType UNID="&nwiPolybolosTurret;"
			name=				"Polybolos Turret"
			level=				"6"
			value=				"12000"
			mass=				"8000"
			frequency=			"common"
			numberAppearing=	"1"
			attributes=			"MajorItem; NWI; Howitzer; BlastCannon; OmniWeapon"
			unknownType=		"&itUnknownBlastCannon3;"
			description=		"The Polybolos Light Howitzer is a relatively fast firing weapon based on Urak designs."

			sortName=			"NW Howitzer 1"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"
				omnidirectional=		"true"
				damage=				"blast:2d12; momentum2; WMD3"
				fireRate=			"20"
				missileSpeed=		"50"
				hitPoints=			"3"
				lifetime=			"90"
				powerUse=			"300"
				recoil=				"1"

				directional=		"true"
				sound=				"&snRecoillessCannon;"
				>



			<Effect>
				<MoltenBolt
						width=				"5"
						length=				"20"
						growth=				"3"
						primaryColor=		"0xea, 0xed, 0xae"
						secondaryColor=		"0xc0, 0xc2, 0x85"
						/>
			</Effect>

			<HitEffect
					sound="&snArmorHit1;"
					>
				<Image imageID="&rsMediumExplosions;" 
						imageX="0" 
						imageY="0" 
						imageWidth="64" 
						imageHeight="64"
						imageFrameCount="16"
						imageTicksPerFrame="2"/>
			</HitEffect>

			<Fragment 
					count=			"1d3+3"
					type=			"missile"
					lifetime=		"8"
					damage=			"blast:1d4+2; momentum2; WMD4"
					missileSpeed=	"24-48"
					>

				<Effect>
					<ImageAndTail 
							imageID=			"&rsMissiles;" 
							imageX=				"96" 
							imageY=				"0" 
							imageWidth=			"16" 
							imageHeight=		"16"
							imageFrameCount=	"2"
							imageTicksPerFrame=	"2"

							length=				"48"
							width=				"3"
							primaryColor=		"0xff, 0xff, 0xff"
							secondaryColor=		"0xc0, 0xc2, 0x85"
							/>
				</Effect>
			</Fragment>
			<Fragment 
					count=			"1"
					type=			"radius"
					lifetime=		"10"
					damage=			"blast:2d12; momentum1; WMD3"
					missileSpeed=		"0"

					minRadius=		"1"
					maxRadius=		"3"
					>
				<Effect>
					<Flare
							style=			"fadingBlast"
							radius=			"5"
							primaryColor=	"0xff, 0xf0, 0x30"
							lifetime=		"8"
							/>
				</Effect>
			</Fragment>
		</Weapon>

	</ItemType>

	<!-- Orion Atomic Lance Note: +% bonuses on this weapon increase shotspeed, not damage -->

	<ItemType UNID="&nwiAtomicLanceSpread;"
			name=				"Orion Atomic Wall"
			level=				"6"
			value=				"25000"
			mass=				"4000"
			frequency=			"uncommon"
			attributes=			"NWA; MajorItem; Military; EnergyWeapon ; Plasma"
			unknownType=		"&itUnknownPlasmaWeapon;"
			description=		"This weapon was intended as a short range shipkiller, but difficulties with the confinement of the fusing plasma produce devastating thermonuclear explosions at maximum range, with a tendency to damage the firing ship."

			sortName=			"NW Orion"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"
				fragmentCount=		"1"

				damage=				"plasma:1d10; WMD7"
				fireRate=			"30"
				missileSpeed=			"60"
				hitPoints=			"10"
				lifetime=			"10"
				failsafe=			"10"
				powerUse=			"240"
				recoil=				"0"

				directional=		"true"
				fireEffect=			"&efMediumCannonFlash;"
				hitEffect=			"&efFragmentationExplosion;"
				sound=				"&snRecoillessCannon;"
				>

			<Configuration aimTolerance="5">
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="0" posRadius="0" angle="-9"/>
				<Shot posAngle="0" posRadius="0" angle="9"/>
				<Shot posAngle="0" posRadius="0" angle="-18"/>
				<Shot posAngle="0" posRadius="0" angle="18"/>
			</Configuration>

			<Effect>
				<Starburst
						style=			"morningStar"
						spikeCount=		"1d6+5"
						spikeLength=	"2d10"
						primaryColor=	"0xff, 0xff, 0x80"
						secondaryColor=	"0xd0, 0x20, 0x00"
						/>
			</Effect>

			<Fragment 
					type=			"radius"
					lifetime=		"10"
					damage=			"thermo:1d10 WMD2; momentum2"
					missileSpeed=		"0"

					minRadius=		"1"
					maxRadius=		"20"

					canHitSource= "true"
					>
				<Effect>
					<Flare
							style=			"fadingBlast"
							radius=			"350"
							primaryColor=	"0xff, 0xff, 0xf0"
							lifetime=		"8"
							/>
				</Effect>
			</Fragment>
		</Weapon>
		<StaticData>
			<TotalShots>5</TotalShots>
		</StaticData>
		<Events>
			<OnFireWeapon>
				(block (fireCount maxCount)
					; replace value with the number of shots expected per firing cycle when applying to a new weapon
					(setq maxCount (typGetStaticData (itmGetUnid gItem) 'TotalShots))

					(setq fireCount (objGetData gSource "fireCountOrion"))

					(if (or (not fireCount) (gr fireCount maxCount))
						(setq fireCount 1)
					)

					; count off a shot so we know when the engine has handled ammo use on its own
					(objSetData gSource "fireCountOrion" (add 1 fireCount))
					(block (shot speed shotRank)
						(setq shotRank (multiply (divide fireCount 2) 2))
						(setq speed (divide (multiply (divide (multiply (add 100 aWeaponBonus) (subtract 11 shotRank)) 100) 60) 12))
						(setq shot (sysCreateWeaponFire aWeaponType gSource aFirePos aFireAngle speed aTargetObj))
						(objIncVel shot (objGetVel gSource))
					)
				)
			</OnFireWeapon>
		</Events>
	</ItemType>

	<!-- Oxybeles -->

	<ItemType UNID="&nwiOxybelesArcuballista;"
			name=				"Arcuballista Light Howitzer"
			level=				"6"
			value=				"15000"
			mass=				"4000"
			frequency=			"uncommon"
			attributes=			"Howitzer; MajorItem; NWA; BlastCannon; Military"
			unknownType=		"&itUnknownBlastCannon3;"
			description=		"The Arcuballista Light Howitzer fires multiple small disposable lasers powered by hexagene driven MHD generators. The Arcuballista fires smaller bursts than the Oxybeles"
			sortName=			"NW Howitzer 2"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"

				damage=				"blast:1d12; momentum1; WMD4"
				fireRate=			"27"
				missileSpeed=			"25"
				lifetime=			"240"
				hitPoints=			"20"
				powerUse=			"300"
				recoil=				"1"
				repeating=			"3"

				directional=		"true"
				fireEffect=			"&efMediumCannonFlash;"
				hitEffect=			"&efFragmentationExplosion;"
				sound=				"&snRecoillessCannon;"


				>

			<Effect>
				<MoltenBolt
						width=				"5"
						length=				"20"
						growth=				"3"
						primaryColor=		"0xea, 0xed, 0xae"
						secondaryColor=		"0xc0, 0xc2, 0x85"
						/>
			</Effect>
			<Fragment 
					count=			"1"
					type=			"beam"
					lifetime=		"60"
					damage=			"laser:2d6; WMD1"
					passthrough=		"50"
					multitarget=		"true"
					hitEffect=		"&efGreenLaserHitEffect;"
					sound=			"&snLaserCannon;"
					>
				<Effect>
					<Beam
							beamType=			"laser"
							primaryColor=		"0x5f, 0xf1, 0x2a"
							secondaryColor=		"0x00, 0xff, 0x00"
							/>
				</Effect>
			</Fragment>
			<Fragment 
					count=			"1"
					type=			"radius"
					lifetime=		"10"
					damage=			"blast:1d12; momentum1; WMD4"
					missileSpeed=		"0"

					minRadius=		"1"
					maxRadius=		"3"

					canHitSource= "true"
					>
				<Effect>
					<Flare
							style=			"fadingBlast"
							radius=			"5"
							primaryColor=	"0xff, 0xf0, 0xe0"
							lifetime=		"8"
							/>
				</Effect>
			</Fragment>
		</Weapon>

	</ItemType>

	<!-- Oxybeles -->

	<ItemType UNID="&nwiOxybelesCheiroballistra;"
			name=				"Cheiroballistra Light Howitzer"
			level=				"6"
			value=				"15000"
			mass=				"4000"
			frequency=			"uncommon"
			attributes=			"Howitzer; MajorItem; NWA; BlastCannon; Military"
			unknownType=		"&itUnknownBlastCannon3;"
			description=		"The Cheiroballistra Light Howitzer fires multiple small disposable lasers powered by hexagene driven MHD generators. Cheiroballistra shells are heavier than Oxybeles or Arcuballista shells"
			sortName=			"NW Howitzer 2"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"

				damage=				"blast:2d12; momentum1; WMD4"
				fireRate=			"40"
				missileSpeed=		"40"
				lifetime=			"150"
				hitPoints=			"15"
				powerUse=			"300"
				recoil=				"1"
				repeating=		"2"

				directional=		"true"
				fireEffect=			"&efMediumCannonFlash;"
				hitEffect=			"&efFragmentationExplosion;"
				sound=				"&snRecoillessCannon;"


				>

			<Effect>
				<MoltenBolt
						width=				"5"
						length=				"20"
						growth=				"3"
						primaryColor=		"0xea, 0xed, 0xae"
						secondaryColor=		"0xc0, 0xc2, 0x85"
						/>
			</Effect>
			<Fragment 
					count=			"1"
					type=			"beam"
					lifetime=		"60"
					damage=			"laser:4d6; WMD2"
					passthrough=		"50"
					multitarget=		"true"
					hitEffect=		"&efGreenLaserHitEffect;"
					sound=			"&snLaserCannon;"
					>
				<Effect>
					<Beam
							beamType=			"laser"
							primaryColor=		"0x5f, 0xf1, 0x2a"
							secondaryColor=		"0x00, 0xff, 0x00"
							/>
				</Effect>
			</Fragment>
			<Fragment 
					count=			"1"
					type=			"radius"
					lifetime=		"10"
					damage=			"blast:3d12; momentum1; WMD4"
					missileSpeed=		"0"

					minRadius=		"1"
					maxRadius=		"3"

					canHitSource= "true"
					>
				<Effect>
					<Flare
							style=			"fadingBlast"
							radius=			"5"
							primaryColor=	"0xff, 0xf0, 0xe0"
							lifetime=		"8"
							/>
				</Effect>
			</Fragment>
		</Weapon>

	</ItemType>

	<!-- Mangonel -->

	<ItemType UNID="&nwiMangonelOnager;"
			name=				"Onager Light Howitzer"
			level=				"7"
			value=				"70000"
			mass=				"5000"
			frequency=			"uncommon"
			attributes=			"Howitzer; MajorItem; NWA; ThermoCannon; Military"
			unknownType=		"&itUnknownThermoCannon;"
			description=		"The Onager Light Howitzer fires a single bomb pumped x-ray laser with multiple lasing rods."

			sortName=			"NW Howitzer 4"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"

				damage=				"thermo:8d10; momentum2; WMD5"
				fireRate=			"40"
				missileSpeed=			"30"
				lifetime=			"200"
				hitPoints=			"20"
				powerUse=			"450"
				recoil=				"3"
				failsafe=			"5"

				directional=		"true"
				fireEffect=			"&efMediumCannonFlash;"
				hitEffect=			"&efFragmentationExplosion;"
				sound=				"&snRecoillessCannon;"


				>

			<Effect>
				<MoltenBolt
						width=				"5"
						length=				"20"
						growth=				"3"
						primaryColor=		"0xea, 0xed, 0xae"
						secondaryColor=		"0xc0, 0xc2, 0x85"
						/>
			</Effect>
			<Fragment
					count=			"12"
					type=			"beam"
					lifetime=		"30"
					damage=			"laser:8d4; WMD1"
					multiTarget=		"true"
					autoAcquireTarget=	"true"
					hitEffect=			"&efXRayLaserHitEffect;" 
					sound=				"&snLaserCannon;"
					>
				<Effect>
					<Beam
							beamType=			"laser"
							primaryColor=		"0xc4, 0x2a, 0xf1"
							secondaryColor=		"0xc0, 0x00, 0xff"
							/>
				</Effect>
			</Fragment>
			<Fragment 
					count=				"12"
					type=				"beam"
					damage=				"thermo:2d10; WMD5"
					lifetime=			"2"
					beamType=			"heavyblaster"
					primaryColor=		"0xe6, 0xff, 0x6f"
					secondaryColor=		"0xff, 0x8c, 0x00"
					intensity=			"5"
					/>

		</Weapon>
	</ItemType>

	<!-- Mangonel -->

	<ItemType UNID="&nwiMangonelLithobolos;"
			name=				"Lithobolos Light Howitzer"
			level=				"7"
			value=				"67500"
			mass=				"5000"
			frequency=			"uncommon"
			attributes=			"Howitzer; MajorItem; NWA; ThermoCannon; Military"
			unknownType=		"&itUnknownThermoCannon;"
			description=		"The Lithobolos Light Howitzer fires multiple bomb pumped x-ray submunitions. The Lithobolos fires larger shells than the Mangonel."

			sortName=			"NW Howitzer 4"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"

				damage=				"thermo:4d6; momentum1; WMD5"
				fireRate=			"40"
				missileSpeed=			"30"
				lifetime=			"200"
				hitPoints=			"20"
				powerUse=			"450"
				recoil=				"1"
				repeating=			"2"
				failsafe=			"5"

				directional=		"true"
				fireEffect=			"&efMediumCannonFlash;"
				hitEffect=			"&efFragmentationExplosion;"
				sound=				"&snRecoillessCannon;"


				>

			<Effect>
				<MoltenBolt
						width=				"5"
						length=				"20"
						growth=				"3"
						primaryColor=		"0xea, 0xed, 0xae"
						secondaryColor=		"0xc0, 0xc2, 0x85"
						/>
			</Effect>
			<Fragment
					count=			"4"
					type=			"beam"
					lifetime=		"30"
					damage=			"laser:8d4; WMD1"
					multiTarget=		"true"
					autoAcquireTarget=	"true"
					hitEffect=			"&efXRayLaserHitEffect;" 
					sound=				"&snLaserCannon;"
					>
				<Effect>
					<Beam
							beamType=			"laser"
							primaryColor=		"0xc4, 0x2a, 0xf1"
							secondaryColor=		"0xc0, 0x00, 0xff"
							/>
				</Effect>
			</Fragment>
			<Fragment 
					count=				"8"
					type=				"beam"
					damage=				"thermo:1d12; WMD5"
					lifetime=			"2"
					beamType=			"heavyblaster"
					primaryColor=		"0xe6, 0xff, 0x6f"
					secondaryColor=		"0xff, 0x8c, 0x00"
					intensity=			"5"
					/>

		</Weapon>

	</ItemType>

	<!-- Atgeir Ion Blaster -->

	<ItemType UNID="&nwiAtgeirHalberd;"
			name=				"Halberd Ion Blaster"
			level=				"7"
			value=				"40000"
			mass=				"6000"
			frequency=			"uncommon"
			numberAppearing=	"1"
			attributes=			"NWA; Ion; EnergyWeapon; MajorItem; Military"
			unknownType=		"&itUnknownIonCannon5;"
			description=		"The Northwind Armories Halberd Ion Blaster lacks the shield disrupting effects of the Atgeir, but has superior range."

			sortName=			"NW Polearm 5"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>


		<Weapon
				type=				"beam"

				damage=				"ion:3d6"
				fireRate=			"6"
				lifetime=			"40"
				powerUse=			"1500"

				counter=			"capacitor"
				counterActivate=	"-10"
				counterUpdate=		"10"
				counterUpdateRate=	"4"

				sound=				"&snLaserCannon;"
				>
			<Effect>
				<Beam
						beamType=			"Heavyblaster"
						primaryColor=		"0x00, 0xc0, 0xff"
						secondaryColor=		"0xc0, 0xe0, 0xff"
						/>
			</Effect>
		</Weapon>

	</ItemType>

	<!-- Atgeir Ion Blaster -->

	<ItemType UNID="&nwiAtgeirVoulge;"
			name=				"Voulge Ion Blaster"
			level=				"7"
			value=				"40000"
			mass=				"6000"
			frequency=			"uncommon"
			numberAppearing=	"1"
			attributes=			"NWA; Ion; EnergyWeapon; MajorItem; Military"
			unknownType=		"&itUnknownIonCannon5;"
			description=		"The Northwind Armories Voulge Ion Blaster is optimised for armor penetration."

			sortName=			"NW Polearm 5"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>


		<Weapon
				type=				"beam"

				damage=				"ion:3d6"
				passthrough=			"50"
				fireRate=			"5"
				lifetime=			"36"
				powerUse=			"1500"

				counter=			"capacitor"
				counterActivate=	"-10"
				counterUpdate=		"10"
				counterUpdateRate=	"4"

				sound=				"&snLaserCannon;"
				>
			<Effect>
				<Beam
						beamType=			"Heavyblaster"
						primaryColor=		"0x00, 0xc0, 0xff"
						secondaryColor=		"0xc0, 0xe0, 0xff"
						/>
			</Effect>


			<Configuration aimTolerance="0" alternating="true">
				<Shot posAngle="90" posRadius="14" angle="-1"/>
				<Shot posAngle="270" posRadius="14" angle="1"/>
			</Configuration>

		</Weapon>

	</ItemType>

	<!-- Cerberus Fusion Cannon -->

	<ItemType UNID="&nwiCerberusChimera;"
			name=				"Chimera Fusion Cannon"
			level=				"8"
			value=				"65000"
			mass=				"6000"
			frequency=			"uncommon"
			attributes=			"MajorItem; NWA; Military; ThermoCannon"
			showReference=		"true"
			unknownType=		"&itUnknownThermoCannon2;"
			description=		"The Chimera Fusion Cannon fires fires three atomic fireballs and tracks them on nearby targets."

			sortName=			"NW Cerberus"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"

				damage=				"thermo:8d4; momentum3; WMD5"
				fireRate=			"40"
				missileSpeed=		"40"
				maneuverability="1"
				multitarget="true"
				lifetime=			"30"
				powerUse=			"3000"
				fireEffect=			"&efMediumCannonFlash;"
				sound=				"&snRecoillessCannon;"
				>

			<Configuration aimTolerance="360">
				<Shot posAngle="0" posRadius="0" angle="-120"/>
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="0" posRadius="0" angle="120"/>
			</Configuration>
			
			<Effect>
				<Starburst
						style=			"flare"
						spikeCount=		"1d6+5"
						spikeLength=	"3d10"
						primaryColor=	"0xff, 0xff, 0x80"
						secondaryColor=	"0xd0, 0x20, 0x00"
						/>
			</Effect>

		</Weapon>

	</ItemType>

	<!-- Cerberus Fusion Cannon -->

	<ItemType UNID="&nwiCerberusHydra;"
			name=				"Hydra Fusion Cannon"
			level=				"8"
			value=				"65000"
			mass=				"7000"
			frequency=			"uncommon"
			attributes=			"MajorItem; NWA; Military; ThermoCannon"
			showReference=		"true"
			unknownType=		"&itUnknownThermoCannon2;"
			description=		"The Hydra Fusion Cannon fires fires six atomic fireballs and tracks them on nearby targets."

			sortName=			"NW Cerberus"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"

				damage=				"thermo:6d4; momentum2; WMD5"
				fireRate=			"60"
				missileSpeed=		"40"
				maneuverability="1"
				multitarget="true"
				lifetime=			"30"
				powerUse=			"3000"
				fireEffect=			"&efMediumCannonFlash;"
				sound=				"&snRecoillessCannon;"
				>

			<Configuration aimTolerance="180">
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="0" posRadius="0" angle="60"/>
				<Shot posAngle="0" posRadius="0" angle="120"/>
				<Shot posAngle="0" posRadius="0" angle="180"/>
				<Shot posAngle="0" posRadius="0" angle="240"/>
				<Shot posAngle="0" posRadius="0" angle="300"/>
			</Configuration>
			
			<Effect>
				<Starburst
						style=			"flare"
						spikeCount=		"1d6+5"
						spikeLength=	"3d10"
						primaryColor=	"0xff, 0xff, 0x80"
						secondaryColor=	"0xd0, 0x20, 0x00"
						/>
			</Effect>

		</Weapon>

	</ItemType>

	<!-- Helepolis Howitzer -->

	<ItemType UNID="&nwiHelepolisKorax;"
			name=				"Korax howitzer"
			level=				"8"
			value=				"85000"
			mass=				"10000"
			frequency=			"common"
			numberAppearing=	"1"
			attributes=			"Howitzer; MajorItem; Military; NWA; ThermoCannon"
			unknownType=		"&itUnknownThermoCannon2;"
			description=		"The Korax howitzer is slightly weaker than the Helepolis, but more precise"

			sortName=			"NW Howitzer 6"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"

				damage=				"thermo:2d8; momentum2; WMD6"
				fireRate=			"40"
				missileSpeed=		"40"
				lifetime=			"180"
				hitPoints=			"10"
				powerUse=			"1200"
				recoil=				"1"
				repeating=		"5"

				fireEffect=			"&efMediumCannonFlash;"
				sound=				"&snRecoillessCannon;"
				>

			<Effect>
				<MoltenBolt
						width=				"6"
						length=				"56"
						growth=				"3"
						primaryColor=		"0xff, 0xff, 0x80"
						secondaryColor=		"0xff, 0x65, 0x21"
						/>
			</Effect>

			<HitEffect
					sound="&snArmorHit1;"
					>
				<Image imageID="&rsExplosionsAG96;" 
						imageX="0" 
						imageY="0" 
						imageWidth="96" 
						imageHeight="96"
						imageFrameCount="16"
						imageTicksPerFrame="2"/>
			</HitEffect>

		</Weapon>

	</ItemType>

	<!-- Guisarme Positron Blaster -->

	<ItemType UNID="&nwiGuisarmeBill;"
			name=				"Bill Positron Blaster"
			level=				"9"
			value=				"175000"
			mass=				"2000"
			frequency=			"uncommon"
			numberAppearing=	"1"
			attributes=			"NWA; Positron; EnergyWeapon; MajorItem; Military"
			unknownType=		"&itUnknownPositronWeapon;"
			description=		"Adaptations of Northwind Gatling designs to positron sources have required stricter limiting of throughput and have proved less accurate than particle versions. The Bill is a less massive version of the Guisarme."

			sortName=			"NW Polearm 6"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>


		<Weapon
				type=				"beam"

				damage=				"positron:4d8"
				fireRate=			"6"
				lifetime=			"50"
				powerUse=			"1600"

				counter=			"capacitor"
				counterActivate=	"-20"
				counterUpdate=		"20"
				counterUpdateRate=	"12"

				sound=				"&snLaserCannon;"
				>
			<Effect>
				<Beam
						beamType=			"heavyblaster"
						primaryColor=		"0xe0, 0xc0, 0x00"
						secondaryColor=		"0xc0, 0xe0, 0x00"
						/>
			</Effect>


			<Configuration aimTolerance="1" alternating="true">
				<Shot posAngle="0" posRadius="0" angle="1d3-2"/>
				<Shot posAngle="90" posRadius="1" angle="1d3-3"/>
				<Shot posAngle="0" posRadius="0" angle="1d3-2"/>
				<Shot posAngle="270" posRadius="1" angle="1d3-1"/>
			</Configuration>

		</Weapon>

	</ItemType>

	<!-- Guisarme Positron Blaster -->

	<ItemType UNID="&nwiGuisarmeBardiche;"
			name=				"Bardiche Positron Blaster"
			level=				"9"
			value=				"250000"
			mass=				"4000"
			frequency=			"uncommon"
			numberAppearing=	"1"
			attributes=			"NWA; Positron; EnergyWeapon; MajorItem; Military"
			unknownType=		"&itUnknownPositronWeapon;"
			description=		"Adaptations of Northwind Gatling designs to positron sources have required stricter limiting of throughput and have proved less accurate than particle versions. The Bardiche is a heavy, short ranged design."

			sortName=			"NW Polearm 6"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>


		<Weapon
				type=				"beam"

				damage=				"positron:6d8"
				fireRate=			"4"
				lifetime=			"20"
				powerUse=			"3000"

				counter=			"capacitor"
				counterActivate=	"-20"
				counterUpdate=		"20"
				counterUpdateRate=	"12"
		
				sound=				"&snLaserCannon;"
				>
			<Effect>
				<Beam
						beamType=			"starblaster"
						primaryColor=		"0xe0, 0xc0, 0x00"
						secondaryColor=		"0xc0, 0xe0, 0x00"
						/>
			</Effect>


			<Configuration aimTolerance="1" alternating="true">
				<Shot posAngle="0" posRadius="0" angle="1d3-2"/>
				<Shot posAngle="90" posRadius="1" angle="1d3-3"/>
				<Shot posAngle="90" posRadius="2" angle="1d3-4"/>
				<Shot posAngle="90" posRadius="1" angle="1d3-3"/>
				<Shot posAngle="0" posRadius="0" angle="1d3-2"/>
				<Shot posAngle="270" posRadius="1" angle="1d3-1"/>
				<Shot posAngle="270" posRadius="2" angle="1d3"/>
				<Shot posAngle="270" posRadius="1" angle="1d3-1"/>
			</Configuration>

		</Weapon>

	</ItemType>

	<!-- Orthrus Fusion Cannon -->

	<ItemType UNID="&nwiOrthrusCharybdis;"
			name=				"Charybdis Fusion Cannon"
			level=				"7"
			value=				"15000"
			mass=				"14000"
			frequency=			"uncommon"
			attributes=			"MajorItem; NWA; Military; ThermoCannon"
			showReference=		"true"

			description=		"The Charybdis improves on the Orthrus with more and more widely spread emitters and more powerful tracking projectors."

			sortName=			"NW Orthrus"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"
				deviceSlots=		"2"

				damage=				"thermo:4d4; momentum3; WMD5"

				fireRate=			"7"
				missileSpeed=			"40"
				lifetime=			"150"
				powerUse=			"600"
				fireEffect=			"&efMediumCannonFlash;"
				sound=				"&snRecoillessCannon;"
				>
			
			<Effect>
				<Starburst
						style=			"flare"
						spikeCount=		"1d6+5"
						spikeLength=	"3d10"
						primaryColor=	"0xff, 0xff, 0x80"
						secondaryColor=	"0xd0, 0x20, 0x00"
						/>
			</Effect>
			<Configuration aimTolerance="5" alternating="true">
				<Shot posAngle="0" posRadius="0" angle="0"/>
				<Shot posAngle="0" posRadius="0" angle="60"/>
				<Shot posAngle="0" posRadius="0" angle="120"/>
				<Shot posAngle="0" posRadius="0" angle="180"/>
				<Shot posAngle="0" posRadius="0" angle="240"/>
				<Shot posAngle="0" posRadius="0" angle="300"/>
			</Configuration>
		</Weapon>
		<Invoke key="W" installedOnly="true">
		(block (mode modes strings)
			(setq modes (itmGetStaticData gItem "ModeCount"))
			(setq mode (modulo (add (itmGetData gItem "controlMode") 1) modes))
			(setq strings (itmGetStaticData gItem "ModeStrings"))
			(objSetItemData gSource gItem "controlMode" mode)
			(objSendMessage gSource Nil (item strings mode))
			(if (eq 1 mode) 
				(objSetItemData gSource gItem "overlayIndex" (objAddOverlay gSource &nwoOrthrusGUI;))
				(objSetItemData gSource gItem "overlayIndex" (objRemoveOverlay gSource (itmGetData gItem "overlayIndex")))
			)
		)
		</Invoke>
		<Events>
			<onFireWeapon>
				(block (shot mode eventNames)
					(setq mode (itmGetData gItem "controlMode"))
					(setq eventNames (itmGetStaticData gItem "EventNames"))
					(if (not mode) (setq mode 0))
					(setq shot (sysCreateWeaponFire aWeaponType gSource aFirePos aFireAngle (typGetDataField aWeaponType "speed") aTargetObj nil aWeaponBonus))
					(objIncVel shot (objGetVel gSource))
					(objSetEventHandler shot &nwsOrthrusController;)
					(sysAddObjRecurringTimerEvent 1 shot (item eventNames mode))
					(objSetData shot "parent" (objgetid gsource))
					(objSetData shot "weapon" aWeaponType)
;	NB-- adjust this to determine how far from the source shots go ballistic
					(objSetData shot "trackRange" 80)
				)
			</onFireWeapon>
			<OnUninstall>
				(block nil
					(if (objGetData gSource "overlayIndex") (objRemoveOverlay gSource (objGetData gSource "overlayIndex")))
					(objSetData gSource "overlayIndex" nil)
				)
			</OnUninstall>
			<OnAIUpdate>
				(objSetItemData gSource gItem "controlMode" (modulo (onjGetDesting gSource) modes))
				
			</OnAIUpdate>
		</Events>
		<StaticData>
			<ModeCount>3</ModeCount>
			<ModeStrings>(
				"Ship Facing Guided"
				"Line Tracking Active"
				"Shield Mode"
			)</ModeStrings>
			<EventNames>(
				"Follow"
				"Track"
				"Defend"
			)</EventNames>
		</StaticData>
	</ItemType>

	<!-- Orthrus Fusion Cannon -->

	<ItemType UNID="&nwiOrthrusDragon;"
			name=				"Dragon Fusion Cannon"
			level=				"7"
			value=				"15000"
			mass=				"3000"
			frequency=			"uncommon"
			attributes=			"MajorItem; NWA; Military; ThermoCannon"
			showReference=		"true"

			description=		"The Dragon is a single emitter variant on the Orthrus."

			sortName=			"NW Orthrus"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"
				deviceSlots=		"2"

				damage=				"thermo:2d4; momentum3; WMD4"

				fireRate=			"40"
				repeating=			"7"
				missileSpeed=			"30"
				lifetime=			"200"
				powerUse=			"600"
				fireEffect=			"&efMediumCannonFlash;"
				sound=				"&snRecoillessCannon;"
				>
			
			<Effect>
				<Starburst
						style=			"flare"
						spikeCount=		"1d6+5"
						spikeLength=	"3d10"
						primaryColor=	"0xff, 0xff, 0x80"
						secondaryColor=	"0xd0, 0x20, 0x00"
						/>
			</Effect>
			<Configuration aimTolerance="5">
				<Shot angle="3d5-9"/>
			</Configuration>
		</Weapon>
		<Invoke key="W" installedOnly="true">
		(block (mode modes strings)
			(setq modes (itmGetStaticData gItem "ModeCount"))
			(setq mode (modulo (add (itmGetData gItem "controlMode") 1) modes))
			(setq strings (itmGetStaticData gItem "ModeStrings"))
			(objSetItemData gSource gItem "controlMode" mode)
			(objSendMessage gSource Nil (item strings mode))
			(if (eq 1 mode) 
				(objSetItemData gSource gItem "overlayIndex" (objAddOverlay gSource &nwoOrthrusGUI;))
				(objSetItemData gSource gItem "overlayIndex" (objRemoveOverlay gSource (itmGetData gItem "overlayIndex")))
			)
		)
		</Invoke>
		<Events>
			<onFireWeapon>
				(block (shot mode eventNames)
					(setq mode (itmGetData gItem "controlMode"))
					(setq eventNames (itmGetStaticData gItem "EventNames"))
					(if (not mode) (setq mode 0))
					(setq shot (sysCreateWeaponFire aWeaponType gSource aFirePos aFireAngle (typGetDataField aWeaponType "speed") aTargetObj nil aWeaponBonus))
					(objIncVel shot (objGetVel gSource))
					(objSetEventHandler shot &nwsOrthrusController;)
					(sysAddObjRecurringTimerEvent 1 shot (item eventNames mode))
					(objSetData shot "parent" (objgetid gsource))
					(objSetData shot "weapon" aWeaponType)
;	NB-- adjust this to determine how far from the source shots go ballistic
					(objSetData shot "trackRange" 40)
				)
			</onFireWeapon>
			<OnUninstall>
				(block nil
					(if (objGetData gSource "overlayIndex") (objRemoveOverlay gSource (objGetData gSource "overlayIndex")))
					(objSetData gSource "overlayIndex" nil)
				)
			</OnUninstall>
			<OnAIUpdate>
				(objSetItemData gSource gItem "controlMode" (modulo (onjGetDesting gSource) modes))
				
			</OnAIUpdate>
		</Events>
		<StaticData>
			<ModeCount>3</ModeCount>
			<ModeStrings>(
				"Ship Facing Guided"
				"Line Tracking Active"
				"Shield Mode"
			)</ModeStrings>
			<EventNames>(
				"Follow"
				"Track"
				"Defend"
			)</EventNames>
		</StaticData>
	</ItemType>

	<!-- Plumbata Minigun -->

	<ItemType UNID="&nwiMinigunPilum;"
			name=				"Pilum minigun"
			level=				"1"
			value=				"250"
			mass=				"3000"
			frequency=			"rare"
			attributes=			"MajorItem; NWA; Cannon"
			showReference=		"true"
			unknownType=		"&itUnknownKineticCannon8;"
			description=		"This specialized version of the recoilless cannon shoots lighter projectiles but has a higher fire rate."

			sortName=			"NW polearm, 0"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>

		<Weapon
				type=				"missile"

				damage=				"kinetic:1d6+1; momentum1"
				fireRate=			"2"
				missileSpeed=		"40"
				interaction=		"50"
				lifetime=			"30"
				powerUse=			"15"

				counter=			"temperature"
				counterActivate=	"2"
				counterUpdate=		"-3"
				counterUpdateRate=	"2"

				sound=				"&snRecoillessCannon;"
				>

			<Effect>
				<Bolt
						length=				"16"
						width=				"3"
						primaryColor=		"0xcd, 0xf3, 0xff"
						secondaryColor=		"0x8f, 0xa9, 0xb2"
						/>
			</Effect>
		</Weapon>
		<StaticData>
			<initialFireRateAdj>15</initialFireRateAdj>
		</StaticData>
		<Events>
			<OnFireWeapon>
				(block (fireDelayCounter fireRateCounter doNotFire)
					(setq fireDelayCounter (objGetData gSource "FireDelayCounter"))
					(setq fireRateCounter (objGetData gSource "FireRateCounter"))
					(setq spinUpCounter (objGetData gSource "SpinUpCounter"))


					(if (not (objGetData gSource "SpinUpTimerExists"))
						(block (station)
							(setq station (sysCreateStation &nwtCounterSpinUp; nil))

							(objSetData gSource "SpinUpTimerExists" "true")
							(objSetData station "source" (objgetid gSource))
							(setq fireRateCounter (typGetStaticData (itmGetUNID gItem) 'initialFireRateAdj))
;							(setq fireRateCounter 10)

							(objSetData gSource "FireRateCounter" fireRateCounter)
							(setq fireDelayCounter 1)
							(objSetData gSource "FireDelayCounter" 1)
							(sysAddObjRecurringTimerEvent 2 station "SpinUp")
						) 
						(block nil
							(setq fireDelayCounter (add fireDelayCounter 1))
							(objSetData gSource "SpinUpFlag" "true")
						)
					)

					(if (gr fireDelayCounter fireRateCounter)
						(setq fireDelayCounter 1)
					)
					(if (gr spinUpCounter (typGetStaticData (itmGetUNID gItem) 'initialFireRateAdj))
						(block nil
							(setq fireRateCounter (subtract fireRateCounter 1))
							(setq spinUpCounter 0)
						)
					)
					(setq spinUpCounter (add spinUpCounter 1))

					(objSetData gSource "FireDelayCounter" fireDelayCounter)
					(objSetData gSource "FireRateCounter" fireRateCounter)
					(objSetData gSource "SpinUpCounter" spinUpCounter)

					(if (geq 1 fireDelayCounter)
						; returning nil lets the engine handle the shot normally so we don't lose enhancments.
						(setq doNotFire nil)
						; returning anything else prevents any firing
						(setq doNotFire "true")
					)
					doNotFire
				)
			</OnFireWeapon>
			<OnAIUpdate>
				(if (itmIsDamaged gItem)
					(shpRepairItem gSource gItem)
				)
			</OnAIUpdate>
		</Events>
	</ItemType>

	<!-- Schiltron Laser Array -->

	<ItemType UNID="&nwiSchiltronTestudo;"
			name=				"Testudo Laser Array"
			level=				"4"
			value=				"3200"
			mass=				"20000"
			frequency=			"uncommon"
			attributes=			"NWA; EnergyWeapon; MajorItem; Laser"
			showReference=		"true"

			description=		"The Schiltron Laser Array relies on transponders to control the many laser emitters spaced around the ship."

			sortName=			"NW Polearm 3a"
			>

		<Image imageID="&rsItems1;" imageX="96" imageY="0" imageWidth="96" imageHeight="96"/>
		<Weapon
				type=				"particles"

				damage=				"laser:1d8"
				fireRate=			"16"
				missileSpeed=			"100"
				lifetime=			"30"
				powerUse=			"180"

				particleCount=		"10"
				particleSpreadAngle="10"
				hitEffect=			"&efCornflowerLaserHitEffect;" 
				sound=				"&snLaserCannon;"
				>
			<Effect>
				<Particle
						style=			"line"
						primaryColor=		"0x97, 0xc0, 0xdf"
						secondaryColor=		"0x01, 0xaf, 0xff"
						/>
			</Effect>

		<Configuration aimTolerance="360">
		<Shot posAngle="180" posRadius="25" angle="0"/>
		<Shot posAngle="180" posRadius="25" angle="10"/>
		<Shot posAngle="180" posRadius="25" angle="20"/>
		<Shot posAngle="180" posRadius="25" angle="30"/>
		<Shot posAngle="180" posRadius="25" angle="40"/>
		<Shot posAngle="180" posRadius="25" angle="50"/>
		<Shot posAngle="180" posRadius="25" angle="60"/>
		<Shot posAngle="180" posRadius="25" angle="70"/>
		<Shot posAngle="180" posRadius="25" angle="80"/>
		<Shot posAngle="180" posRadius="25" angle="90"/>
		<Shot posAngle="180" posRadius="25" angle="100"/>
		<Shot posAngle="180" posRadius="25" angle="110"/>
		<Shot posAngle="180" posRadius="25" angle="120"/>
		<Shot posAngle="180" posRadius="25" angle="130"/>
		<Shot posAngle="180" posRadius="25" angle="140"/>
		<Shot posAngle="180" posRadius="25" angle="150"/>
		<Shot posAngle="180" posRadius="25" angle="160"/>
		<Shot posAngle="180" posRadius="25" angle="170"/>
		<Shot posAngle="180" posRadius="25" angle="180"/>
		<Shot posAngle="180" posRadius="25" angle="190"/>
		<Shot posAngle="180" posRadius="25" angle="200"/>
		<Shot posAngle="180" posRadius="25" angle="210"/>
		<Shot posAngle="180" posRadius="25" angle="220"/>
		<Shot posAngle="180" posRadius="25" angle="230"/>
		<Shot posAngle="180" posRadius="25" angle="240"/>
		<Shot posAngle="180" posRadius="25" angle="250"/>
		<Shot posAngle="180" posRadius="25" angle="260"/>
		<Shot posAngle="180" posRadius="25" angle="270"/>
		<Shot posAngle="180" posRadius="25" angle="280"/>
		<Shot posAngle="180" posRadius="25" angle="290"/>
		<Shot posAngle="180" posRadius="25" angle="300"/>
		<Shot posAngle="180" posRadius="25" angle="310"/>
		<Shot posAngle="180" posRadius="25" angle="320"/>
		<Shot posAngle="180" posRadius="25" angle="330"/>
		<Shot posAngle="180" posRadius="25" angle="340"/>
		<Shot posAngle="180" posRadius="25" angle="350"/>
		</Configuration>

		</Weapon>
		<Events>
			<onFireWeapon>
				(block (targetlist)
					(setq targetlist (filter (append (sysfindobject gsource "sTAEN:60") aTargetObj) target 
						(ls 
							(abs 
								(subtract 
									(sysCalcFireSolution 
										(sysVectorSubtract (objGetPos target) (objGetPos gsource)) 
										(objGetVel target) 
										(typGetDataField aWeaponType "speed")
									) 
									aFireAngle
								)
							) 
						7
						)
					))
					(if (item targetlist 0) nil true)
				)
			</onFireWeapon>
		</Events>
	</ItemType>

	<!-- Starfire Laser -->

	<ItemType UNID="&nwiSMBSLaser;"
			name=				"Disposable Laser Unit"
			level=				"5"
			value=				"30"
			mass=				"15"
			frequency=			"common"
			numberAppearing=	"20d40"
			attributes=			"Consumable; Missile; NWA"

			description=		"This is a disposable laser source for use with the Starfire Multimodal Beam System."

			sortName=			"starfire.laser"
			>

		<Image imageID="&rsItems1;" imageX="288" imageY="192" imageWidth="96" imageHeight="96"/>
	</ItemType>

	<!-- Starfire Particle -->

	<ItemType UNID="&nwiSMBSParticle;"
			name=				"Disposable Particle Source"
			level=				"6"
			value=				"60"
			mass=				"15"
			frequency=			"common"
			numberAppearing=	"20d40"
			attributes=			"Consumable; Missile; NWA"

			description=		"This is a disposable neutron source for use with the Starfire Multimodal Beam System."

			sortName=			"starfire.particle"
			>

		<Image imageID="&rsItems1;" imageX="288" imageY="192" imageWidth="96" imageHeight="96"/>
	</ItemType>

	<!-- Starfire EMP -->

	<ItemType UNID="&nwiSMBSEMP;"
			name=				"Disposable Ion Disrupter"
			level=				"5"
			value=				"40"
			mass=				"15"
			frequency=			"common"
			numberAppearing=	"20d40"
			attributes=			"Consumable; Missile; NWA"

			description=		"This is a disposable ion source for use with the Starfire Multimodal Beam System.  It is optimized for disrupting electronics."

			sortName=			"starfire.emp"
			>

		<Image imageID="&rsItems1;" imageX="288" imageY="192" imageWidth="96" imageHeight="96"/>
	</ItemType>

	<!-- Starfire Ion -->

	<ItemType UNID="&nwiSMBSIon;"
			name=				"Disposable Ion Source"
			level=				"7"
			value=				"100"
			mass=				"15"
			frequency=			"common"
			numberAppearing=	"20d40"
			attributes=			"Consumable; Missile; NWA; Military"

			description=		"This is a disposable laser source for use with the Starfire Multimodal Beam System."

			sortName=			"starfire.ion"
			>

		<Image imageID="&rsItems1;" imageX="288" imageY="192" imageWidth="96" imageHeight="96"/>
	</ItemType>

	<!-- Starfire Positron -->

	<ItemType UNID="&nwiSMBSPositron;"
			name=				"Disposable Positron Source"
			level=				"9"
			value=				"250"
			mass=				"15"
			frequency=			"uncommon"
			numberAppearing=	"20d40"
			attributes=			"Consumable; Missile; NWA; Military"

			description=		"This is a disposable positron source for use with the Starfire Multimodal Beam System."

			sortName=			"starfire.positron"
			>

		<Image imageID="&rsItems1;" imageX="288" imageY="192" imageWidth="96" imageHeight="96"/>
	</ItemType>

	<!-- Claymore Kinetic -->

	<ItemType UNID="&nwiCVPLKinetic;"
			name=				"Light Grapeshot"
			level=				"2"
			value=				"10"
			mass=				"30"
			frequency=			"common"
			numberAppearing=	"10d20"
			attributes=			"Consumable; Missile; NWA"

			description=		"This shell cartridge is used by the Claymore Variable Projectile Launcher.  It is loaded with many small tungsten penetrators."

			sortName=			"claymore.light grapeshot"
			>

		<Image imageID="&rsItems1;" imageX="288" imageY="192" imageWidth="96" imageHeight="96"/>
	</ItemType>

	<!-- Claymore Radioactive -->

	<ItemType UNID="&nwiCVPLRadio;"
			name=				"Dirty Grapeshot"
			level=				"3"
			value=				"20"
			mass=				"30"
			frequency=			"common"
			numberAppearing=	"1d20"
			attributes=			"Consumable; Missile; NWA; Illegal"

			description=		"This shell cartridge is used by the Claymore Variable Projectile Launcher.  It contains radioactive elements."

			sortName=			"claymore.dirty grapeshot"
			>

		<Image imageID="&rsItems1;" imageX="288" imageY="192" imageWidth="96" imageHeight="96"/>
	</ItemType>

	<!-- Claymore Blast -->

	<ItemType UNID="&nwiCVPLBlast;"
			name=				"Heavy Grapeshot"
			level=				"5"
			value=				"50"
			mass=				"30"
			frequency=			"common"
			numberAppearing=	"10d20"
			attributes=			"Consumable; Missile; NWA"

			description=		"This shell cartridge is used by the Claymore Variable Projectile Launcher.  It is loaded with six explosive submunitions."

			sortName=			"claymore.heavy grapeshot"
			>

		<Image imageID="&rsItems1;" imageX="288" imageY="192" imageWidth="96" imageHeight="96"/>
	</ItemType>

	<!-- Claymore Thermo -->

	<ItemType UNID="&nwiCVPLThermo;"
			name=				"Atomic Slug"
			level=				"6"
			value=				"150"
			mass=				"60"
			frequency=			"common"
			numberAppearing=	"5d20"
			attributes=			"Consumable; Missile; NWA; Military"

			description=		"This shell cartridge is used by the Claymore Variable Projectile Launcher.  It contains a single small fission device."

			sortName=			"claymore.atomic slug"
			>

		<Image imageID="&rsItems1;" imageX="288" imageY="192" imageWidth="96" imageHeight="96"/>
	</ItemType>

	<!-- Claymore Thermo -->

	<ItemType UNID="&nwiCVPLPlasma;"
			name=				"Plasma Shell"
			level=				"8"
			value=				"180"
			mass=				"30"
			frequency=			"common"
			numberAppearing=	"5d20"
			attributes=			"Consumable; Missile; NWA; Military"

			description=		"This shell cartridge is used by the Claymore Variable Projectile Launcher.  It explodes in a focused plasma lance immediately after leaving the weapon."

			sortName=			"claymore.plasma shell"
			>

		<Image imageID="&rsItems1;" imageX="288" imageY="192" imageWidth="96" imageHeight="96"/>
	</ItemType>

	<!-- Shotput Strategic Missile  -->

	<ItemType UNID="&nwiSMShotput;"
			name=				"SM1 Shotput"
			level=				"3"
			value=				"10"
			mass=				"50"
			frequency=			"common"
			numberAppearing=	"2d12"
			attributes=			"Consumable; Missile; NWA"
			showReference=		"true"

			description=		"This is a cheap warheadless hypervelocity missile designed for long range strategic bombardment."

			sortName=			"SM.1"
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="96" imageWidth="96" imageHeight="96"/>
	</ItemType>

	<ItemType UNID="&nwviSMShotput;"
			name=				"<SM1 virtual weapon>"
			virtual=			"true"
			>
		<Weapon
						type=			"missile"
						lifetime=		"120"
						damage=			"kinetic:8d8; momentum5; WMD7"
						missileSpeed=		"60"
						hitPoints=		"15"
						passthrough=		"100"
						
						directional=	"true"
						sound=			"&snMissileLauncher;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>
					<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>
		</Weapon>
	</ItemType>

	<!-- Hammer Tactical Missile  -->

	<ItemType UNID="&nwiTMHammer;"
			name=				"TM1 Hammer"
			level=				"4"
			value=				"20"
			mass=				"50"
			frequency=			"common"
			numberAppearing=	"2d12"
			attributes=			"Consumable; Missile; NWA"
			showReference=		"true"

			description=		"This is a short range fragmentation missile designed for defense against starfighters."

			sortName=			"TM.1"
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="96" imageWidth="96" imageHeight="96"/>
	</ItemType>

	<ItemType UNID="&nwviTMHammer;"
			name=				"<TM1 virtual weapon>"
			virtual=			"true"
			>
		<Weapon
						type=			"missile"
						lifetime=		"30"
						damage=			"blast:6d6; WMD3"
						missileSpeed=		"40"
						hitPoints=		"15"
						
						directional=	"true"
						sound=			"&snMissileLauncher;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>
					<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>
					<Fragment
							count=			"6d6"
							type=			"missile"
							lifetime=		"8"
							damage=			"blast:2d6; WMD2"
							missileSpeed=	"20-60"
							>
						<Effect>
							<ImageAndTail 
									imageID=			"&rsMissiles4;" 
									imageX=				"0" 
									imageY=				"0" 
									imageWidth=			"16" 
									imageHeight=		"16"
									imageFrameCount=	"4"
									imageTicksPerFrame=	"1"
									
									length=				"32"
									width=				"1"
									primaryColor=		"0xff, 0xff, 0xff"
									secondaryColor=		"0xc0, 0xc2, 0x85"
									/>
						</Effect>
					</Fragment>
					<Fragment 
							type=			"radius"
							lifetime=		"10"
							damage=			"blast:6d6; WMD3"
							missileSpeed=		"0"

							minRadius=		"1"
							maxRadius=		"3"

							canHitSource= "true"
							>
						<Effect>
							<Flare
									style=			"fadingBlast"
									radius=			"5"
									primaryColor=	"0xff, 0xf0, 0xe0"
									lifetime=		"8"
									/>
						</Effect>
					</Fragment>
		</Weapon>
	</ItemType>

	<!-- Javelin Tactical Missile  -->

	<ItemType UNID="&nwiTMJavelin;"
			name=				"TM2 Javelin"
			level=				"6"
			value=				"150"
			mass=				"80"
			frequency=			"common"
			numberAppearing=	"3d12"
			attributes=			"Consumable; Missile; NWA"
			showReference=		"true"

			description=		"This optical tracking missile carries a minimal U235 fission warhead."

			sortName=			"TM.2"
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="96" imageWidth="96" imageHeight="96"/>
	</ItemType>

	<ItemType UNID="&nwviTMJavelin;"
			name=				"<TM2 virtual weapon>"
			virtual=			"true"
			>
		<Weapon
						type=			"missile"
						lifetime=		"100"
						damage=			"thermo:8d8; momentum3; WMD5"
						missileSpeed=	"40"
						hitPoints=		"15"
						maneuverability="2"
						directional=	"true"
						sound=			"&snMissileLauncher;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>
					<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>
		</Weapon>
	</ItemType>

	<!-- Mjolnir Strategic Missile  -->

	<ItemType UNID="&nwiSMMjolnir;"
			name=				"SM2 Mjolnir"
			level=				"5"
			value=				"150"
			mass=				"100"
			frequency=			"uncommon"
			numberAppearing=	"1d8"
			attributes=			"Consumable; Missile; NWA"
			showReference=		"true"

			description=		"Mjolnir uses a hexagene pumped flux compression generator to generate a potent electromagnetic pulse."

			sortName=			"SM.2"
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="96" imageWidth="96" imageHeight="96"/>
	</ItemType>

	<ItemType UNID="&nwviSMMjolnir;"
			name=				"<SM2 virtual weapon>"
			virtual=			"true"
			>
		<Weapon
						type=			"missile"
						
						damage=			"blast:1d12; momentum6; WMD5"
						missileSpeed=	"40"
						hitPoints=		"60"
						lifetime=		"120"
						fragmentCount=	"1"		
						directional=	"true"

						sound=			"&snMissileLauncher;"
						hitEffect=		"&efFragmentationExplosion;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>
					<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>
					<Fragment 
							type=			"area"

							damage=			"ion:1d12; EMP3"
							expansionSpeed=	"100"
							missileSpeed=	"0"
							lifetime=		"10"
							>
						<Effect>
							<Shockwave
									fadeStart=	"70"
									>
								<Image imageID=				"&rsShatterShockwave;"
										imageX=				"0" 
										imageY=				"0" 
										imageWidth=			"512" 
										imageHeight=		"128"
										imageFrameCount=	"1"
										imageTicksPerFrame=	"1"/>
							</Shockwave>
						</Effect>
					</Fragment>
					<Fragment 
							type=			"radius"
							lifetime=		"10"
							damage=			"blast:1d12; WMD5"
							missileSpeed=		"0"

							minRadius=		"1"
							maxRadius=		"3"

							canHitSource= "true"
							>
						<Effect>
							<Flare
									style=			"fadingBlast"
									radius=			"5"
									primaryColor=	"0xff, 0xf0, 0xe0"
									lifetime=		"8"
									/>
						</Effect>
					</Fragment>
		</Weapon>
	</ItemType>

	<!-- Scythe Strategic Missile  -->

	<ItemType UNID="&nwiSMScythe;"
			name=				"SM3 Scythe"
			level=				"6"
			value=				"220"
			mass=				"250"
			frequency=			"common"
			numberAppearing=	"1d6"
			attributes=			"Consumable; Missile; NWA; Military"
			showReference=		"true"

			description=		"The Scythe deploys a score of submunitions that themselves have fragmentation jackets."

			sortName=			"SM.3"
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="96" imageWidth="96" imageHeight="96"/>
	</ItemType>

	<ItemType UNID="&nwviSMScythe;"
			name=				"<SM3 virtual weapon>"
			virtual=			"true"
			>
		<Weapon
						type=			"missile"
						lifetime=		"120"
						damage=			"blast:8d8; WMD5"
						missileSpeed=	"40"
						hitPoints=		"45"
						
						directional=	"true"
						hitEffect=		"&efFragmentationExplosion;"
						sound=			"&snMissileLauncher;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>

					<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>

					<Fragment
							count=			"12"
							type=			"missile"
							lifetime=		"20"
							damage=			"blast:6d6; WMD3"
							missileSpeed=	"40-60"
							>
						<Image imageID="&rsMissiles;" imageX="0" imageY="16" imageWidth="16" imageHeight="16" imageFrameCount="12" imageTicksPerFrame="3"/>
						<Fragment
								count=			"5d6"
								type=			"missile"
								lifetime=		"20"
								damage=			"kinetic:4d4; WMD1"
								missileSpeed=	"40-60"
								>
						<Image imageID="&rsMissiles;" imageX="0" imageY="0" imageWidth="16" imageHeight="16" imageFrameCount="0" imageTicksPerFrame="0"/>
						</Fragment>
						<Fragment 
								type=			"radius"
								lifetime=		"10"
								damage=			"blast:6d6; WMD3"
								missileSpeed=		"0"

								minRadius=		"1"
								maxRadius=		"3"

								canHitSource= "true"
								>
							<Effect>
								<Flare
										style=			"fadingBlast"
										radius=			"5"
										primaryColor=	"0xff, 0xf0, 0xe0"
										lifetime=		"8"
										/>
							</Effect>
						</Fragment>
					</Fragment>
					<Fragment 
							type=			"radius"
							lifetime=		"10"
							damage=			"blast:8d8; WMD5"
							missileSpeed=		"0"

							minRadius=		"1"
							maxRadius=		"3"

							canHitSource= "true"
							>
						<Effect>
							<Flare
									style=			"fadingBlast"
									radius=			"5"
									primaryColor=	"0xff, 0xf0, 0xe0"
									lifetime=		"8"
									/>
						</Effect>
					</Fragment>
		</Weapon>
	</ItemType>

	<!-- Odysseus Tactical Missile  -->

	<ItemType UNID="&nwiTMOdysseus;"
			name=				"TM3 Odysseus"
			level=				"8"
			value=				"350"
			mass=				"640"
			frequency=			"uncommon"
			numberAppearing=	"1d12"
			attributes=			"Consumable; Missile; NWA; Military"
			showReference=		"true"

			description=		"The Odysseus is a missile bus for 7 independently tracking missiles."

			sortName=			"TM.3"
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="96" imageWidth="96" imageHeight="96"/>
	</ItemType>

	<ItemType UNID="&nwviTMOdysseus;"
			name=				"<TM3 virtual weapon>"
			virtual=			"true"
			>
		<Weapon
						type=			"missile"
						lifetime=		"120"
						damage=			"blast:1d6+2; WMD1"
						missileSpeed=	"40"
						hitPoints=		"60"
						
						directional=	"true"
						hitEffect=		"&efFragmentationExplosion;"
						sound=			"&snMissileLauncher;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>

					<Effect>
						<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>
					</Effect>

					<Fragment
							count=			"7"
							type=			"missile"
							lifetime=		"80"
							damage=			"thermo:8d8; WMD3"
							maneuverability=	"2"
							missileSpeed=		"40"
							hitpoints=		"15"
							directional=	"true"
							multiTarget=		"true"
							autoAcquireTarget=	"true"
							>
							
					
						<effect>	
						<ImageAndTail 
								imageID=			"&rsMissiles3;" 
								imageX=				"48" 
								imageY=				"0" 
								imageWidth=			"16" 
								imageHeight=		"16"
									
								length=				"32"
								width=				"1"
								primaryColor=		"0xff, 0xff, 0xff"
								secondaryColor=		"0xc0, 0xc2, 0x85"
								/>
						</effect>
					</Fragment>
		</Weapon>
	</ItemType>

	<!-- Harrow Strategic Missile  -->

	<ItemType UNID="&nwiSMScythe2;"
			name=				"SM4 Harrow"
			level=				"9"
			value=				"400"
			mass=				"500"
			frequency=			"common"
			numberAppearing=	"1d12"
			attributes=			"Consumable; Missile; NWA; Military"
			showReference=		"true"

			description=		"The Harrow deploys a score of submunitions that produce a mass of overlapping blasts."

			sortName=			"SM.4"
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="96" imageWidth="96" imageHeight="96"/>
	</ItemType>

	<ItemType UNID="&nwviSMScythe2;"
			name=				"<SM4 virtual weapon>"
			virtual=			"true"
			>
		<Weapon
						type=			"missile"
						lifetime=		"120"
						damage=			"blast:8d8; WMD5"
						missileSpeed=	"40"
						hitPoints=		"45"
						
						directional=	"true"
						hitEffect=		"&efFragmentationExplosion;"
						sound=			"&snMissileLauncher;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>

					<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>

					<Fragment
							count=			"12"
							type=			"missile"
							lifetime=		"20"
							damage=			"thermo:4d4; WMD3"
							missileSpeed=	"40-60"
							>
						<Image imageID="&rsMissiles;" imageX="0" imageY="16" imageWidth="16" imageHeight="16" imageFrameCount="12" imageTicksPerFrame="3"/>
						<Fragment
								count=			"5d6"
								type=			"missile"
								lifetime=		"18"
								damage=			"plasma:3d3; WMD1"
								missileSpeed=	"40-60"
								>
							<Effect>
								<Image imageID="&rsMediumExplosions;" imageX="0" imageY="64" imageWidth="64" imageHeight="64" imageFrameCount="16" imageTicksPerFrame="1" blend="brighten" />
							</Effect>
						</Fragment>
					</Fragment>
		</Weapon>
	</ItemType>

	<!-- TM4 Mistletoe	-->

	<ItemType UNID="&nwiTMMistletoe;"
			name=				"TM4 Mistletoe"
			level=				"9"
			value=				"160"
			mass=				"100"
			frequency=			"veryrare"
			numberAppearing=	"1d30"
			attributes=			"Consumable; Missile; NWA; Military"
			showReference=		"true"

			description=		"Mistletoe is a meteorsteel jacketed missile that will cripple both your shield and your target's."

			sortName=			"TM.4"
			>
		<Image imageID="&rsItems1;" imageX="0" imageY="96" imageWidth="96" imageHeight="96"/>
	</ItemType>

	<ItemType UNID="&nwviTMMistletoe;"
			name=				"<TM4 virtual weapon>"
			virtual=			"true"
			>
		<Weapon
						type=			"missile"
						lifetime=		"160"
						damage=			"blast:6d6; momentum3; WMD3"
						missileSpeed=	"40"
						hitPoints=		"15"
						maneuverability="2"
						directional=	"true"
						sound=			"&snMissileLauncher;"
						vaporTrailLength="16"
						vaporTrailWidth="110"
						vaporTrailWidthInc="5"
						vaporTrailColor="0xd0, 0xd0, 0xd0"
						>
					<Image imageID="&rsMissiles2;" imageX="0" imageY="0" imageWidth="32" imageHeight="32" imageFrameCount="0" imageTicksPerFrame="0"/>
		</Weapon>
		<Events>
			<OnDamageShields>
				(block nil
					(dbgoutput "shieldsdown")
					(objDepleteShields gSource)
					aDamageHP
				)
			</OnDamageShields>
		</Events>
	</ItemType>

	<!-- Other Consumables -->

	<ItemType UNID="&nwiShieldFlash;"
			name=				"Flash Shield Booster"
			level=				"5"
			value=				"3000"
			mass=				"1000"
			frequency=			"uncommon"
			attributes=			"NWA; Consumable"

			description=		"These self contained shield emitters can quickly restore a depleted shield, but risk damaging all but the most advanced shields."
			>

		<Image imageID="&rsItems1;" imageX="288" imageY="384" imageWidth="96" imageHeight="96"/>

		<Invoke key="H">
			(block (charge depletion)
				(setq charge (random 50 150))
				(setq depletion (shpGetShieldDamage gSource))
				(if (and (gr 80 charge) (geq charge (multiply 2 depletion)))
					(objEnumItems gPlayerShip "sI &lt;=8" theItem
						(ShpDamageItem gSource theItem)
					)
					(shprechargeshield gSource (min charge depletion))
				)
				(objRemoveItem gSource gItem 1)
			)
		</Invoke>
	</ItemType>

<!-- Shields -->

	<ItemType UNID="&nwiCataphractAlpha;"
			name=				"Cataphract Type Alpha Shield"
			level=				"5"
			value=				"16000"
			mass=				"2000"
			frequency=			"rare"
			attributes=			"MajorItem; NWA"

			description=		"Northwind Armories' Cataphract line of shields are heavily optimized towards blocking energy weapons.  The Type Alpha Shield blocks particle weapons almost completely."
			>

		<Image imageID="&rsItems1;" imageX="192" imageY="0" imageWidth="96" imageHeight="96"/>

		<Shields
				hitPoints=		"80"
				hpBonus=		"+100, 0, +300, 0, +100, 0"
				absorbAdj=		"100,90,100,75, 100,90,100,100, 100,100,100,100, 100,100,100,100"
				regen=			"36"
				depletionDelay=	"60"
				powerUse=		"300"
				weaponSuppress=	"particle"
				/>


				<StaticData> 
					<WE_Suppress> 
						2 
					</WE_Suppress> 
				</StaticData>

	</ItemType>

	<ItemType UNID="&nwiCataphractBeta;"
			name=				"Cataphract Type Beta Shield"
			level=				"8"
			value=				"64000"
			mass=				"4000"
			frequency=			"rare"
			attributes=			"MajorItem; NWA; Military"

			description=		"Northwind Armories' Cataphract line of shields are heavily optimized towards blocking energy weapons.  The Type Beta Shield blocks ion weapons almost completely."
			>

		<Image imageID="&rsItems1;" imageX="192" imageY="0" imageWidth="96" imageHeight="96"/>

		<Shields
				hitPoints=		"170"
				hpBonus=		"0, 0, +100, 0, +300, 0, +100, 0"
				absorbAdj=		"100,100,100,90, 100,75,100,90, 100,100,100,100, 100,100,100,100"
				regen=			"60"
				depletionDelay=	"60"
				powerUse=		"1000"
				weaponSuppress=	"ion"
				/>


				<StaticData> 
					<WE_Suppress> 
						4 
					</WE_Suppress> 
				</StaticData>

	</ItemType>

	<ItemType UNID="&nwiCataphractGamma;"
			name=				"Cataphract Type Gamma Shield"
			level=				"10"
			value=				"200000"
			mass=				"6000"
			frequency=			"rare"
			attributes=			"MajorItem; NWA; Military"

			description=		"Northwind Armories' Cataphract line of shields are heavily optimized towards blocking energy weapons.  The Type Gamma Shield blocks positron weapons almost completely."
			>

		<Image imageID="&rsItems1;" imageX="192" imageY="0" imageWidth="96" imageHeight="96"/>

		<Shields
				hitPoints=		"280"
				hpBonus=		"0, 0, 0, 0, +100, 0, +300, 0, +100, 0"
				absorbAdj=		"100,100,100,100, 100,90,100,75, 100,90,100,100, 100,100,100,100"
				regen=			"84"
				depletionDelay=	"60"
				powerUse=		"2000"
				weaponSuppress=	"positron"
				/>

				<StaticData> 
					<WE_Suppress> 
						6 
					</WE_Suppress> 
				</StaticData>

	</ItemType>

	<ItemType UNID="&nwiVariableShieldOn;"
			name=				"Variable Absorption Shield (high)"
			level=				"7"
			value=				"40000"
			mass=				"2500"
			frequency=			"rare"
			attributes=			"MajorItem; NWA"

			description=		"The Variable Absorption Shield can trade recharge rate for damage absorption."
			>

		<Image imageID="&rsItems1;" imageX="192" imageY="0" imageWidth="96" imageHeight="96"/>

		<Shields
				hitPoints=		"200"
				absorbAdj=		"100,100, 100, 100,  100, 100, 100, 100,  100, 100, 100, 100,  100, 100, 100, 100"
				regen=			"0"
				depletionDelay=	"0"
				powerUse=		"500"
				/>
		<Invoke key="L" installedOnly="true">
		(block Nil
		(nwfSwitchshield (itmCreate &nwiVariableShieldOff; 1))
		(objSendMessage gSource Nil (cat "Shield Absorbtion Low"))
		)
		</Invoke>

		<Events>
			<OnAIUpdate>
				(if
					(gr (shpGetShieldDamage gsource) (divide (multiply (shpGetShieldMaxHitPoints gsource) 19) 20))
					(nwfSwitchshield (itmCreate &nwiVariableShieldOff; 1))
				)
			</OnAIUpdate>
		</Events>

	</ItemType>

	<ItemType UNID="&nwiVariableShieldOff;"
			name=				"Variable Absorption Shield (low)"
			level=				"7"
			value=				"40000"
			mass=				"2500"
			frequency=			"notrandom"
			attributes=			"MajorItem; NWA"

			description=		"The Variable Absorption Shield can trade recharge rate for damage absorption."
			>

		<Image imageID="&rsItems1;" imageX="192" imageY="0" imageWidth="96" imageHeight="96"/>

		<Shields
				hitPoints=		"200"
				absorbAdj=		"90,90, 90, 90,  85, 85, 85, 85,  75, 75, 75, 75,  60, 60, 60, 60"
				regen=			"120"
				depletionDelay=	"0"
				powerUse=		"500"
				/>
		<Invoke key="L" installedOnly="true">
		(block Nil
		(nwfSwitchshield (itmCreate &nwiVariableShieldOn; 1))
		(objSendMessage gSource Nil (cat "Shield Absorbtion High"))
		)
		</Invoke>

		<Events>
			<OnAIUpdate>
				(if
					(ls (shpGetShieldDamage gsource) (divide (shpGetShieldMaxHitPoints gsource) 20))
					(nwfSwitchshield (itmCreate &nwiVariableShieldOn; 1))
				)
			</OnAIUpdate>
		</Events>

	</ItemType>


	<!-- Agressive Shield -->

	<ItemType UNID="&nwiAgressiveShield;"
			name=				"Verloren Hoop shield"
			level=				"6"
			value=				"20000"
			mass=				"6000"
			frequency=			"uncommon"
			attributes=			"MajorItem; Specialty; NWA; Military"

			description=		"The Verloren Hoop shield can be overloaded to create a powerful gravitic burst.  "
			>

		<Image imageID="&rsItems1;" imageX="192" imageY="0" imageWidth="96" imageHeight="96"/>

		<Shields
				hitPoints=		"80"
				absorbAdj=		"100,100,100,100, 100,100,100,100, 100,100,100,100, 100,100,100,100"
				regenTime=		"6"
				regenHP=		"1"
				depletionDelay=	"5"
				powerUse=		"300"
				/>

		<Invoke key="L" installedOnly="true">
		(if (geq (subtract (shpGetShieldMaxHitPoints gSource) (shpGetShieldDamage gSource)) 10)
			(block (objVel iterator)
				(setq objVel (objGetVel gSource))
				(for iterator 1 (divide (subtract (shpGetShieldMaxHitPoints gSource) (shpGetShieldDamage gSource)) 10)
					(sysCreateWeaponFire &nwviAgressiveShield; gSource (objGetPos gSource) (sysVectorAngle objVel) (sysVectorSpeed objVel) Nil)
				)
				(objMakeParalyzed gSource (subtract (shpGetShieldMaxHitPoints gSource) (shpGetShieldDamage gSource)))
				(objDepleteShields gSource)
				(objSendMessage gSource Nil "Shield power surge!")
			)
		)
		</Invoke>

		<Events>
			<OnAIUpdate>
				(if
					(and
						(and
							(sysFindObject gSource "sEN:15")
							(not (sysfindobject gsource "TANF:20"))
						)
						(leq (shpGetShieldDamage gsource) (divide (shpGetShieldMaxHitPoints gsource) 2))
					)
					(block (objVel iterator)
						(setq objVel (objGetVel gSource))
						(for iterator 1 (divide (subtract (shpGetShieldMaxHitPoints gSource) (shpGetShieldDamage gSource)) 10)
							(sysCreateWeaponFire &nwviAgressiveShield; gSource (objGetPos gSource) (sysVectorAngle objVel) (sysVectorSpeed objVel) Nil )
						)
						(objDepleteShields gSource)
						(objMakeParalyzed gSource 50)
					)
					
				)
			</OnAIUpdate>
		</Events>

	</ItemType>

	<ItemType UNID="&nwviAgressiveShield;"
			name=				"Virtual Area Weapon"
			virtual=			"true"
			level=				"6"
			>

		<Weapon
				type=				"area"

				damage=				"graviton:4; WMD7; momentum7"
				fireRate=			"2"
				expansionSpeed=		"50"
				missileSpeed=		"0"
				lifetime=			"20"
				powerUse=			"0"


				areaDamageDensity=		"32"
				passthrough=			"100"
				>

			<Effect>
				<Shockwave
						style=			"glowRing"
						width=			"2"
						glowSize=		"12"
						primaryColor=	"0xdd, 0xff, 0xee"
						secondaryColor=	"0x77, 0x88, 0x99"
						/>
			</Effect>

		</Weapon>

	</ItemType>

	<ItemType UNID="&nwiRegenerator;"
			name=				"Nanite Shield"
			level=				"5"
			value=				"25000"
			mass=				"2000"
			frequency=			"rare"
			attributes=			"MajorItem; NWA; Military"

			description=		"This device isn't a shield.  It's a specialized nanite factory that rapidly repairs damage to your armor."
			>

		<Image imageID="&rsItems1;" imageX="192" imageY="0" imageWidth="96" imageHeight="96"/>

		<Shields
				hitPoints=		"1000"
				armorShield=		"1"
				absorbAdj=		"10,10,10,10, 10,10,10,10, 10,10,10,10, 10,10,10,10"
				regen=			"20"
				depletionDelay=		"0"
				powerUse=		"700"
				idlePowerUse=		"700"
				/>
		<Events>
			<OnInstall>
				(objSetData gSource "OverlayID_regenerator" (objAddOverlay gSource &nwoRegenerator; (ObjGetPos gSource) 0))
			</OnInstall>
			<OnUninstall>
				(block nil
					(if (objGetData gSource "OverlayID_regenerator") (objRemoveOverlay gSource (objGetData gSource "OverlayID_regenerator")))
					(objSetData gSource "OverlayID_regenerator" nil)
					(objSetData gSource "ShieldRegen" nil)
					(objSetData gSource "ShieldID" nil)
				)
			</OnUninstall>
		</Events>

	</ItemType>

	<ItemType UNID="&nwiAegisDeflector;"
			name=				"Aegis Deflector"
			level=				"9"
			value=				"150000"
			mass=				"6000"
			frequency=			"notrandom"
			attributes=			"MajorItem; NWA"

			description=		"The Aegis Deflector is a particularly powerful shield for its size. It pays for this with a tendancy to permit damage through and a reliance on vulnerable external booster emitters."
			>

		<Image imageID="&rsItems1;" imageX="192" imageY="0" imageWidth="96" imageHeight="96"/>

		<Shields
				hitPoints=		"1000"
				armorShield=		"10"
				hpBonus=		"0,0,0,0, +0,+200,+0,+50, +0,+0,+0,+0"
				absorbAdj=		"80,80,80,80, 80,80,80,80, 80,80,80,80, 80,80,80,80,"
				regen=			"50"
				depletionDelay=		"5"
				powerUse=		"3000"
				/>
	</ItemType>

	<ItemType UNID="&nwiDirectionalShield;"
			name=				"Hoplon shield"
			level=				"5"
			value=				"6000"
			mass=				"2000"
			frequency=			"rare"
			attributes=			"MajorItem; NWA"

			description=		"The Hoplon provides excellent protection for its mass and power requirements...  But only to the front."
			>

		<Image imageID="&rsItems1;" imageX="192" imageY="0" imageWidth="96" imageHeight="96"/>

		<Shields
				hitPoints=		"150"
				regen=			"48"
				depletionDelay=		"240"
				powerUse=		"100"
				idlePowerUse=		"25"
				/>
		<Events>
			<OnShieldDamage>
				(block (opacity relHitDir)
					(setq relHitDir (modulo (add 360 (subtract (shpGetDirection gSource) aHitDir)) 360))
					;distance from straight ahead
					(if (gr relHitDir 180)
						(setq opacity (subtract relHitDir 180))
						(setq opacity (subtract 180 relHitDir))
					)

					;Flatten front quadrant opacity curve
					(if (gr opacity 135) (setq opacity 135))
					;scale opacity to 100
					(setq opacity (divide (multiply opacity 100) 135))
					(list nil (divide (multiply aShieldDamageHP opacity) 100) (add aArmorDamageHP (divide (multiply aShieldDamageHP (subtract 100 opacity)) 100)))
				)
			</OnShieldDamage>
		</Events>
	</ItemType>

	<!-- devices -->

	<!-- Shield Booster Device
		ShieldID	The UNID of the shield for which regen data is stored
		ShieldRegen	The highest observed delta in hitpoints
		OldDamage	previous damage
		OverlayID
		Timer
	-->

	<ItemType UNID="&nwiShieldBooster;"
			name=				"Auxiliary Shield Generator"
			level=				"5"
			value=				"7500"
			mass=				"5000"
			frequency=			"rare"
			unknownType=		"&itUnknownEnhancer5;"
			attributes=			"MajorItem; NWA"

			description=		"This device pumps additional energy directly into a ship's shield. Most human designed shields will absorb this energy constructively."
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="192" imageWidth="96" imageHeight="96"/>

		<MiscellaneousDevice
				powerUse=		"200"
				/>
		<Events>
			<OnInstall>
				(objSetData gSource "OverlayID_shieldbooster" (objAddOverlay gSource &nwoShieldBooster; (ObjGetPos gSource) 0))
			</OnInstall>
			<OnUninstall>
				(block nil
					(if (objGetData gSource "OverlayID_shieldbooster") (objRemoveOverlay gSource (objGetData gSource "OverlayID_shieldbooster")))
					(objSetData gSource "OverlayID_shieldbooster" nil)
					(objSetData gSource "ShieldRegen" nil)
					(objSetData gSource "ShieldID" nil)
				)
			</OnUninstall>
			<OnEnable>
				(objSetData gSource "OverlayID_shieldbooster" (objAddOverlay gSource &nwoShieldBooster; (ObjGetPos gSource) 0))
			</OnEnable>
			<OnDisable>
								(block nil
					(if (objGetData gSource "OverlayID_shieldbooster") (objRemoveOverlay gSource (objGetData gSource "OverlayID_shieldbooster")))
					(objSetData gSource "OverlayID_shieldbooster" nil)
					(objSetData gSource "ShieldRegen" nil)
					(objSetData gSource "ShieldID" nil)
				)
			</OnDisable>
		</Events>

		<Invoke installedOnly="true">
			(block nil
				(objDepleteShields gSource)
				(objSetData gSource "ShieldRegen" 0)
				(objSetData gSource "OldDamage" (shpGetShieldDamage gSource))
				(objSetData gSource "Timer" 0)
				(objSendMessage gSource Nil (cat "Auxiliary Shield Generator Reboot commencing"))
			)
		</Invoke>

	</ItemType>

	<OverlayType UNID="&nwoShieldBooster;">
		<Events>
			<OnUpdate>
				(if (eq (objGetData gSource "Timer") 1)
					(block (oldDamage deltaDamage oldDeltaDamage ShieldUnid)
				; init1: get stored data, check for changed shield, and set defaults where appropriate
						(setq oldDamage (objGetData gSource "OldDamage"))
						(setq oldDeltaDamage (objGetData gSource "ShieldRegen"))
						(setq shieldUnid (objGetData gSource "ShieldID"))
						(if (not oldDeltaDamage) (setq oldDeltaDamage 0))
						(if (not oldDamage) (setq OldDamage 0))
						(if (not (eq shieldUnid (shpGetShieldItemUNID gSource)))
							(block nil	; shield doesn't match
								(setq oldDeltaDamage 0)
								(setq oldDamage 0)
								(objSetData gSource "ShieldID" (shpGetShieldItemUNID gSource))
							)	; end shield doesn't match
						)
				; end init1
				; init2: check for regeneration
						(setq deltaDamage (max oldDeltaDamage (subtract oldDamage (shpGetShieldDamage gSource))))
					; try to check for anomolously high delta that would come from a flash recharger and discount it
						(if (and (gr deltaDamage (add 50 oldDeltaDamage)) (gr oldDeltaDamage 0)) (setq deltaDamage oldDeltaDamage))
					; hack: check for superconducting shield generator
						(if (eq ShieldUnid &itSuperconductingShields;) (setq deltaDamage 2))
				; end init2
				; heal shield
						(shprechargeshield gSource (min (divide deltaDamage 2) (shpGetShieldDamage gSource)))
				; end heal shield
				; cleanup
						(objSetData gSource "ShieldRegen" deltaDamage)
						(objSetData gSource "OldDamage" (shpGetShieldDamage gSource))
						(objSetData gSource "Timer" (add 1 (objGetData gSource "Timer")))	; we still need to update the timer
				; end cleanup
					)	; end main block

					(block (timer)	; timer block: OnUpdate fires too frequently to get proper regen rate
						(setq timer (objGetData gSource "Timer"))
						(if (not timer) (setq timer 0))
						(setq timer (add 1 timer))
						(if (geq timer 3) (setq timer 0))
						(objSetData gSource "Timer" timer)
					)	; end timer block
				)
			</OnUpdate>
		</Events>
	</OverlayType>

	<OverlayType UNID="&nwoRegenerator;">
		<Events>
			<OnUpdate>
				(block (shieldHP)
					(setq ShieldHP (subtract (shpGetShieldMaxHitPoints gSource) (shpGetShieldDamage gSource)))
					(for iterator 0 (shpGetArmorCount gSource)
						(objRepairArmor gSource iterator (divide (add 9 ShieldHP) 10))
					)
				)
			</OnUpdate>
		</Events>
	</OverlayType>


	<!-- High-Speed Missile Loader 
Needs OR for criteria (indefinate future) Should be "l ^NWA ^NAMI ^Rasiermesser -EnergyWeapon" Currently negates all other manufacturers, which won't properly ignore launchers in mods.  
-->

	<ItemType UNID="&nwiMissileFeedSystem;"
			name=				"Improved Missile Feed System"
			level=				"6"
			value=				"18000"
			mass=				"2000"
			frequency=			"rare"
			unknownType=		"&itUnknownEnhancer5;"
			attributes=			"MajorItem; WeaponEnhancer; NWA"

			description=		"This missile feed system is compatible with most NAMI, Northwind, and Rasiermasser missile launchers."
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="192" imageWidth="96" imageHeight="96"/>

		<EnhancerDevice
				enhancementType="missilerLoader"
				
				criteria=		"l -Bushido -EI -Makayev -Alien -Taikon -Teraton -Urak -Dwarg -Heliotropes -Kobol -Ventari -SungSlavers -Ferian -Ares -Xenophobe -Ranx -EnergyWeapon;"
				activateAdj=	"80"

				powerUse=		"250"
				/>

	</ItemType>

	<!-- armors -->
	
	<ItemType UNID="&nwiMSLatticeLight;"
			name=				"[segment of ]light meteorsteel lattice"
			level=				"5"
			value=				"5000"
			frequency=			"rare"
			numberAppearing=	"1d3+1"
			mass=				"6000"
			attributes=			"MinorItem; Specialty; NWA"

			description=		"This segment of plasteel armor has a modified meteorsteel alloy woven into it. "

			firstPlural=		"true"
			sortName=			"meteorsteel lattice 1"
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="0" imageWidth="96" imageHeight="96"/>

		<Armor
				hitPoints=	"160"
				hpBonus=	" +150, +150,+150,+150,+100,+100"

				shieldInterference=	"true"
				radiationImmune="true"
				blindingDamageAdj=	"0"
				deviceDamageAdj=	"0"
				EMPDamageAdj=		"0"
				/>

		<StaticData> 
		         <WE_meteorsteel> 
				(block Nil) 
			</WE_meteorsteel> 
		</StaticData>


	</ItemType>
	
	<ItemType UNID="&nwiMSLatticeHeavy;"
			name=				"[segment of ]heavy meteorsteel lattice"
			level=				"6"
			value=				"6000"
			frequency=			"rare"
			numberAppearing=	"1d4"
			mass=				"10000"
			attributes=			"MinorItem; Specialty; NWA"

			description=		"This segment of plasteel armor has a modified meteorsteel alloy woven into it. "

			firstPlural=		"true"
			sortName=			"meteorsteel lattice 2"
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="0" imageWidth="96" imageHeight="96"/>

		<Armor
				hitPoints=	"320"
				hpBonus=	" +400, +400,+400,+400,+200,+200,+100,+100,+50,+50"

				shieldInterference=	"true"
				radiationImmune="true"
				blindingDamageAdj=	"0"
				deviceDamageAdj=	"0"
				EMPDamageAdj=		"0"
				/>

		<StaticData> 
		         <WE_meteorsteel> 
				(block Nil) 
			</WE_meteorsteel> 
		</StaticData>

	</ItemType>

	<ItemType UNID="&nwiMSLatticePowered;"
			name=				"[segment of ]powered meteorsteel lattice"
			level=				"9"
			value=				"10000"
			frequency=			"rare"
			numberAppearing=	"1d4"
			mass=				"5000"
			attributes=			"MinorItem; Specialty; NWA"

			description=		"This Northwind Armories powered armor is based on Bennin alloys.  It draws 20 MWs per segment."

			firstPlural=		"true"
			sortName=			"meteorsteel lattice 3"
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="0" imageWidth="96" imageHeight="96"/>

		<Armor
				hitPoints=	"160"
				hpBonus=	" +400, +400,+400,+400,+300,+300,+150,+150,+100,+100"
				repairTech=	"7"
				repairCost=	"10"
				installCostAdj="200"

				regen=		"12"
				powerUse=	"200"

				shieldInterference=	"true"
				radiationImmune="true"
				disintegrationImmune="true"
				blindingDamageAdj=	"0"
				deviceDamageAdj=	"0"
				EMPDamageAdj=		"0"
				/>

		<StaticData> 
		         <WE_meteorsteel> 
				(block Nil) 
			</WE_meteorsteel> 
		</StaticData>

	</ItemType>



	<!-- Active armor -->

	<ItemType UNID="&nwiActiveArmor;"
			name=				"[segment of ]Northwind Active Armor"
			level=				"7"
			value=				"8000"
			mass=				"5000"
			attributes=			"MinorItem; Specialty; NWA"
			frequency=			"notrandom"
			numberAppearing=	"1d4"

			description=		"Powerful energy fields permeate this armor, enhancing its durability, but slowly degrading its structure. It draws 5MW per segment"

			firstPlural=		"true"
			sortName=			"armor active"
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="0" imageWidth="96" imageHeight="96"/>

		<Armor
				hitPoints=	"130"
				hpBonus=	"  +100,  +100, +100, +100,  +100, +100, +100, +100, +100, +100"
				installCostAdj="200"

				radiationImmune="true"
				disintegrationImmune="true"
				blindingDamageAdj=	"0"
				deviceDamageAdj=	"0"
				EMPDamageAdj=		"0"

				powerUse=		"50"
				decay=			"1"
				/>

		<Invoke key="A" installedOnly="true">
		(block nil
		(nwfSwitchArmor (itmCreate &nwiInactiveArmor; 1))	
		(shpDecontaminate gsource)
		(objSendMessage gSource Nil (cat "Active Armor Deactivated"))
		)
		</Invoke>

		<Events>
			<OnAIUpdate>
				(if
					(ls (shpGetShieldDamage gsource) (divide (shpGetShieldMaxHitPoints gsource) 20))
					(nwfSwitchArmor (itmCreate &nwiInactiveArmor; 1))	
				)
			</OnAIUpdate>
		</Events>


	</ItemType>

	<ItemType UNID="&nwiInactiveArmor;"
			name=				"[segment of ]Northwind Inactive Armor"
			level=				"7"
			value=				"8000"
			mass=				"5000"
			attributes=			"MinorItem; Specialty; NWA"
			frequency=			"uncommon"
			numberAppearing=	"1d4"

			description=		"Powerful energy fields don't currently permeate this armor, enhancing its durability, but slowly degrading its structure. It draws 5MW per segment when active"

			firstPlural=		"true"
			sortName=			"armor active"
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="0" imageWidth="96" imageHeight="96"/>

		<Armor
				hitPoints=	"130"
				hpBonus=	"  +0,  +0, +0,+0,  +0, +0, +0, +0"
				installCostAdj="200"

				/>

		<Invoke key="A" installedOnly="true">
		(block nil
		(nwfSwitchArmor (itmCreate &nwiActiveArmor; 1))	
		(objSendMessage gSource Nil (cat "Inactive Armor Activated"))
		)
		</Invoke>

		<Events>
			<OnAIUpdate>
				(if
					(gr (shpGetShieldDamage gsource) (divide (multiply (shpGetShieldMaxHitPoints gsource) 19) 20))
					(nwfSwitchArmor (itmCreate &nwiActiveArmor; 1))	
				)
			</OnAIUpdate>
		</Events>
	</ItemType>

	<!-- Active armor -->

	<ItemType UNID="&nwiActiveArmor2;"
			name=				"[segment of ]Northwind Reinforced Active Armor"
			level=				"9"
			value=				"16000"
			mass=				"10000"
			attributes=			"MinorItem; Specialty; NWA; Military"
			frequency=			"notrandom"
			numberAppearing=	"1d4"

			description=		"Powerful energy fields permeate this armor, enhancing its durability, but slowly degrading its structure. It draws 10MW per segment"

			firstPlural=		"true"
			sortName=			"armor active 2"
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="0" imageWidth="96" imageHeight="96"/>

		<Armor
				hitPoints=	"300"
				hpBonus=	"  +100,  +100, +100, +100,  +100, +100, +100, +100, +100, +100"
				installCostAdj="200"

				radiationImmune="true"
				disintegrationImmune="true"
				blindingDamageAdj=	"0"
				deviceDamageAdj=	"0"
				EMPDamageAdj=		"0"

				powerUse=		"100"
				decay=			"1"
				/>

		<Invoke key="R" installedOnly="true">
		(block nil
		(nwfSwitchArmor (itmCreate &nwiInactiveArmor2; 1))	
		(shpDecontaminate gsource)
		(objSendMessage gSource Nil (cat "Active Armor Deactivated"))
		)
		</Invoke>

		<Events>
			<OnAIUpdate>
				(if
					(ls (shpGetShieldDamage gsource) (divide (shpGetShieldMaxHitPoints gsource) 20))
					(nwfSwitchArmor (itmCreate &nwiInactiveArmor2; 1))	
				)
			</OnAIUpdate>
		</Events>


	</ItemType>

	<ItemType UNID="&nwiInactiveArmor2;"
			name=				"[segment of ]Northwind Reinforced Inactive Armor"
			level=				"9"
			value=				"16000"
			mass=				"10000"
			attributes=			"MinorItem; Specialty; NWA; Military"
			frequency=			"uncommon"
			numberAppearing=	"1d4"

			description=		"Powerful energy fields don't currently permeate this armor, enhancing its durability, but slowly degrading its structure. It draws 10MW per segment when active"

			firstPlural=		"true"
			sortName=			"armor active 2"
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="0" imageWidth="96" imageHeight="96"/>

		<Armor
				hitPoints=	"300"
				hpBonus=	"  +0,  +0, +0,+0,  +0, +0, +0, +0"
				installCostAdj="200"

				radiationImmune="false"
				disintegrationImmune="false"
				blindingDamageAdj=	"100"
				deviceDamageAdj=	"100"
				EMPDamageAdj=		"100"

				/>

		<Invoke key="R" installedOnly="true">
		(block nil
		(nwfSwitchArmor (itmCreate &nwiActiveArmor2; 1))	
		(objSendMessage gSource Nil (cat "Inactive Armor Activated"))
		)
		</Invoke>

		<Events>
			<OnAIUpdate>
				(if
					(gr (shpGetShieldDamage gsource) (divide (multiply (shpGetShieldMaxHitPoints gsource) 19) 20))
					(nwfSwitchArmor (itmCreate &nwiActiveArmor2; 1))	
				)
			</OnAIUpdate>
		</Events>
	</ItemType>

	<!-- Segment of liquid metal armor -->

	<ItemType UNID="&nwiLiquidArmor;"
			name=				"[segment(s) of ]liquid metal armor"
			level=				"4"
			value=				"600"
			mass=				"3500"
			frequency=			"uncommon"
			numberAppearing=	"1d4"
			attributes=			"MinorItem; NWA"
			showReference=		"true"

			description=		"This exotic armor is composed of electrostaticly constrained liquid. It consumes 500kw per segment."

			sortName=			"armor liquid"
			>

		<Image imageID="&rsItems1;" imageX="0" imageY="0" imageWidth="96" imageHeight="96"/>

		<Armor
				hitPoints=	"70"
				hpBonus=	"  +100,-25,  +50, -25,  +50"
				repairCostAdj=	"75"
				powerUse=		"5"
				/>
		<Events>
			<OnUpdate>
				(if (gr (itmGetArmorInstalledLocation gItem) -1) 
				(block (location count total)
					(setq total 0)
					(setq count (shpGetArmorCount gSource))
					(for location 0 (subtract (shpGetArmorCount gSource) 1)
						(if (eq (itmgetUNID gItem) (itmgetUNID (ShpGetArmor gSource location)))
							(setq total (add total (objGetArmorDamage gSource location)))
							(setq count (subtract count 1))
						)
					)
					(for location 0 (subtract (shpGetArmorCount gSource) 1)
						(if (and (or (eq 1 (random 1 count)) (eq 0 (random 0 count))) (eq (itmgetUNID gItem) (itmgetUNID (ShpGetArmor gSource location))))
							(switch 
								(gr total (multiply count (objgetarmordamage gSource location)))
									(shpDamageArmor gSource location -1 
										(max 1
											(divide 
												(subtract total 
													(multiply count 																			(objgetarmordamage gSource location)
													)
												)
												(multiply 2 count)
											)
										)
									)
								(ls total (multiply count (objgetarmordamage gSource location)))
									(objRepairArmor gSource location 
										(max 1
											(divide 
												(subtract
													(multiply count 																			(objgetarmordamage gSource location)
													)
													total
												)
												(multiply 2 count)
											)
										)
									)
							)
						)
					)

				))
			</OnUpdate>
		</Events>

	</ItemType>

	<!-- Arms Dealers, Northwind -->

	<StationType UNID="&nwtNorthwindArmory1;"
			name=				"Northwind Armories"
			sovereign=			"&svCorporate;"
			dockScreen=			"&dsArmsDealerSpecial;"
			abandonedScreen=	"&dsAbandonedStation;"
			dockingPorts=		"8"
			canAttack=			"true"

			multiHull=			"true"
			armorID=			"&itBlastPlate;"
			maxHitPoints=		"350"
			hitPoints=			"350"
			repairRate=			"5"
			explosionType=		"&vtThermoExplosion1;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"corporate, corporateCustoms, independent,friendly,envAir,envEarth,envFire,envWater,populated"
			levelFrequency=		"-vrru ----- ----- ----- -----"
			locationCriteria=	"+planetary,-asteroids"

			noArticle=			"true"
			>

		<Image			imageID="&rsStations1;" imageX="256" imageY="384" imageWidth="128" imageHeight="128"/>

		<Ships>
			<Lookup count="2" table="&tbCorpDefenders;"/>
			<Lookup count="1d4" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Reinforcements minShips="4">
			<Table>
				<Lookup chance="75" table="&tbCorpDefenders;"/>
				<Lookup chance="25" table="&tbCommPrivateCrafts;"/>
			</Table>
		</Reinforcements>

		<Devices>
			<Device deviceID="&nwiPolybolos;"	omnidirectional="true"/>
		</Devices>

		<Items>
			<RandomItem count="1d12" 
					criteria=		"w +NWA; -NotForSale;"
					levelFrequency=	"ccccc rv"
					enhanced=		"10"
					enhancement=	"=(random (list 0x101 0x0102 0x0103 0x1002))"
					/>

			<RandomItem count="2d12" 
					criteria=		"s +NWA; -NotForSale;"
					levelFrequency=	"ccccc rv"
					enhanced=		"10"
					enhancement=	"=(random (list 0x0101 0x0102 0x0102 0x0103 0x0104 0x0105 0x0834 0x0f01 0x0f02 0x0f03))"
					/>

			<RandomItem count="2d12" 
					criteria=		"a +NWA; -NotForSale;"
					levelFrequency=	"ccccc rv"
					enhanced=		"10"
					enhancement=	"=(random (list 0x0101 0x0102 0x0102 0x0103 0x0104 0x0105 0x0834 0x0854 0x0602 0x0702))"
					/>

			<Item chance="95"	count="12d100"	item="&nwiSMBSLaser;" />
			<Item chance="95"	count="6d100"	item="&nwiSMBSParticle;" />
			<Item chance="95"	count="3d100"	item="&nwiSMBSEMP;" />
			<Item chance="75"	count="3d100"	item="&nwiSMBSIon;" />
			<Item chance="50"	count="3d100"	item="&nwiSMBSPositron;" />

			<Item chance="95"	count="12d100"	item="&nwiCVPLKinetic;" />
			<Item chance="95"	count="8d100"	item="&nwiCVPLBlast;" />
			<Item chance="95"	count="6d100"	item="&nwiCVPLThermo;" />
			<Item chance="80"	count="6d100"	item="&nwiCVPLPlasma;" />

			<Item chance="95"	count="6d100"	item="&nwiSMShotput;" />
			<Item chance="95"	count="6d100"	item="&nwiTMHammer;" />
			<Item chance="95"	count="6d100"	item="&nwiTMJavelin;" />
			<Item chance="95"	count="3d100"	item="&nwiSMMjolnir;" />
			<Item chance="75"	count="3d100"	item="&nwiSMScythe;" />
			<Item chance="50"	count="3d100"	item="&nwiTMOdysseus;" />
			<Item chance="50"	count="1d100"	item="&nwiSMScythe2;" />
			<Item chance="50"	count="1d100"	item="&nwiTMMistletoe;" />


		</Items>

		<Trade currency="credit" creditConversion="100" max="50000" replenish="2500">
			<Sell	criteria="m +NWA; -Illegal; -Military;" priceAdj="120" inventoryAdj="800"/>
			<Sell	criteria="*NU -Illegal; -ID; -NotForSale;"	priceAdj="120"/>
		</Trade>

		<Events>
			<OnContractGenerate>
				(intGenerateIndustrialRequestContract1)
			</OnContractGenerate>

			<OnContractQuery>True</OnContractQuery>

			<OnDestroy>
				(intCorporateOnDestroy)
			</OnDestroy>
		</Events>

		<StaticData>
			<LongName>"a Northwind Armories outlet"</LongName>
		</StaticData>

		<DockingPorts>
			<Port x="0"		y="70" />
			<Port x="0"		y="-70" />
			<Port x="50"	y="50" />
			<Port x="50"	y="-50" />
			<Port x="70"	y="0" />
			<Port x="-70"	y="0" />
			<Port x="-50"	y="50" />
			<Port x="-50"	y="-50" />
		</DockingPorts>

	</StationType>

	<StationType UNID="&nwtNorthwindArmory2;"
			name=				"Northwind Armories"
			sovereign=			"&svCorporate;"
			dockScreen=			"Main"
			abandonedScreen=	"&dsAbandonedStation;"
			dockingPorts=		"8"
			canAttack=			"true"

			multiHull=			"true"
			armorID=			"&itBlastPlate;"
			maxHitPoints=		"350"
			hitPoints=			"350"
			repairRate=			"5"
			explosionType=		"&vtThermoExplosion1;"
			ejectaType=			"&vtWreckEjecta;"

			attributes=			"corporate, corporateCustoms, independent,friendly,envAir,envEarth,envFire,envWater,populated"
			levelFrequency=		"----- urrv- ----- ----- -----"
			locationCriteria=	"+planetary,-asteroids"

			noArticle=			"true"
			>

		<Image			imageID="&rsStations1;" imageX="256" imageY="384" imageWidth="128" imageHeight="128"/>

		<Ships>
			<Lookup count="2" table="&tbCorpDefenders;"/>
			<Lookup count="1d4" table="&tbCommPrivateCrafts;"/>
		</Ships>

		<Reinforcements minShips="4">
			<Table>
				<Lookup chance="75" table="&tbCorpDefenders;"/>
				<Lookup chance="25" table="&tbCommPrivateCrafts;"/>
			</Table>
		</Reinforcements>

		<Devices>
			<Device deviceID="&nwiOxybeles;"	omnidirectional="true"/>
		</Devices>

		<Items>
			<RandomItem count="1d12" 
					criteria=		"w +NWA; -NotForSale;"
					levelFrequency=	"---ru ccurv"
					enhanced=		"10"
					enhancement=	"=(random (list 0x101 0x0102 0x0103 0x1002))"
					/>

			<RandomItem count="2d12" 
					criteria=		"s +NWA; -NotForSale;"
					levelFrequency=	"---ru ccurv"
					enhanced=		"10"
					enhancement=	"=(random (list 0x0101 0x0102 0x0102 0x0103 0x0104 0x0105 0x0834 0x0f01 0x0f02 0x0f03))"
					/>

			<RandomItem count="2d12" 
					criteria=		"a +NWA; -NotForSale;"
					levelFrequency=	"---ru ccurv"
					enhanced=		"10"
					enhancement=	"=(random (list 0x0101 0x0102 0x0102 0x0103 0x0104 0x0105 0x0834 0x0854 0x0602 0x0702))"
					/>

			<Item chance="75"	count="12d100"	item="&nwiSMBSLaser;" />
			<Item chance="95"	count="6d100"	item="&nwiSMBSParticle;" />
			<Item chance="95"	count="3d100"	item="&nwiSMBSEMP;" />
			<Item chance="95"	count="3d100"	item="&nwiSMBSIon;" />
			<Item chance="75"	count="3d100"	item="&nwiSMBSPositron;" />

			<Item chance="50"	count="12d100"	item="&nwiCVPLKinetic;" />
			<Item chance="95"	count="8d100"	item="&nwiCVPLBlast;" />
			<Item chance="95"	count="6d100"	item="&nwiCVPLThermo;" />
			<Item chance="95"	count="6d100"	item="&nwiCVPLPlasma;" />

			<Item chance="95"	count="6d100"	item="&nwiSMShotput;" />
			<Item chance="95"	count="6d100"	item="&nwiTMHammer;" />
			<Item chance="95"	count="6d100"	item="&nwiTMJavelin;" />
			<Item chance="95"	count="3d100"	item="&nwiSMMjolnir;" />
			<Item chance="75"	count="3d100"	item="&nwiSMScythe;" />
			<Item chance="50"	count="3d100"	item="&nwiTMOdysseus;" />
			<Item chance="50"	count="1d100"	item="&nwiSMScythe2;" />
			<Item chance="50"	count="1d100"	item="&nwiTMMistletoe;" />


		</Items>

		<Trade currency="credit" creditConversion="100" max="50000" replenish="2500">
			<Sell	criteria="m +NWA; -Illegal;" priceAdj="120" inventoryAdj="800"/>
			<Sell	criteria="*NU -Illegal; -ID; -NotForSale;"	priceAdj="120"/>
		</Trade>

		<Events>
			<OnContractGenerate>
				(intGenerateIndustrialRequestContract1)
			</OnContractGenerate>

			<OnContractQuery>True</OnContractQuery>

			<OnCreate>
				(if (not (objGetGlobalData gSource "GustavSystem"))
					(block Nil
						(objSetGlobalData gSource "GustavSystem" (sysGetNode))
						(objSetData gSource "Gustav" True)
					)
				)
			</OnCreate>

			<OnDestroy>
				(intCorporateOnDestroy)
			</OnDestroy>
		</Events>

		<StaticData>
			<LongName>"a Northwind Armories outlet"</LongName>
		</StaticData>
		<DockScreens>
			<Main>

				<OnScreenInit>
					(block Nil
						(if (scrIsFirstOnInit gScreen)
							(objSetData gSource "offered" Nil)
						)
					)
				</OnScreenInit>

				<Panes>
					<Default>
						<OnPaneInit>
							(scrSetDesc gScreen "Welcome to Northwind Armories! Purveyors of innovative military hardware for over thirty years.")
						</OnPaneInit>

						<Actions>
							<Action name="Research Lab" default="1" key="L">
								(if (objGetData gSource "Gustav" )
									(scrShowScreen gScreen "ResearchLab")
									(scrShowScreen gScreen "SecondaryLab")
									)
							</Action>

							<Action name="Buy items" key="B">
								(comShowBuyScreen 
									"*"						; items sold to player
									"Main"					; return screen
									
									'(	"d"					; install devices
										8					; of level 6 (and below)
										Nil					; no special tech modifiers
										True				; check for military ID
										0)					; install cost margin
									)
							</Action>

							<Action name="Dock Services" key="D">
								<ShowPane pane="DockServices"/>
							</Action>

							<Action name="Undock" cancel="1" key="U">
								<Exit/>
							</Action>
						</Actions>

					</Default>

					<DockServices
							desc=	"You are at the docking services terminal.">

						<Actions>
							<Action name="Refuel" key="R">
								(block Nil
;									(setq gPrevScreen "Main")
;									(setq gPrevPane "DockServices")
									(intSetCompatibleFuel '((&itXenotiteFuelRod; 160) (&itHeliumAssembly; 75) (&itHelium3FuelRod; 25)))
									(scrShowScreen gScreen "&dsRefuel;")
									)
							</Action>

							<Action name="Repair or replace armor" key="A" >
								(block Nil
;									(setq gPrevScreen "Main")
;									(setq gPrevPane "DockServices")
									(setq gTechLevel 9)
									(setq gArmorSegment 0)
									(setq gMargin 100)
									(scrShowScreen gScreen "&dsRepairArmor;")
									)
							</Action>

							<Action name="Install device" key="D" >
								(block Nil
;									(setq gPrevScreen "Main")
;									(setq gPrevPane "DockServices")
									(setq gTechLevel 8)
									(setq gTechModifier "NWA")
									(setq gCheckMilitaryID True)
									(setq gMargin 100)
									(scrShowScreen gScreen "&dsInstallDevice;")
									)
							</Action>

							<Action name="Remove device" key="V" >
								(block Nil
;									(setq gPrevScreen "Main")
;									(setq gPrevPane "DockServices")
									(scrShowScreen gScreen "&dsRemoveDevice;")
									)
							</Action>

							<Action name="Done" cancel="1" key="N">
								<ShowPane pane="Default"/>
							</Action>

						</Actions>

					</DockServices>

				</Panes>
			</Main>

			<ResearchLab>
				<Panes>
					<Default>
						<OnPaneInit>
							(block (desc)
								; Initialize
								(if (not (objGetData gSource "AlienShields"))
									(objSetData gSource "AlienShields" 0)
									)
								(setq alienShields (objGetData gSource "AlienShields"))

								(if (not (objGetData gSource "AlienArmor"))
									(objSetData gSource "AlienArmor" 0)
									)
								(setq alienArmor (objGetData gSource "AlienArmor"))

								; Description
								(switch
									(and (eq alienArmor 0) (eq alienShields 0))
										(setq desc (cat "When you enter the lab a tall blond haired man intercepts you.\n\n"
											"His name is Gustav North, the chief scientist for and one of the founding owners of the Northwind Corporation. " 
											"He approaches you. \"You've been called by Domina? That demoness took my niece Helga. You should turn around and head home.\" "
											"You tell him you can't not follow Domina's summons. "
											"\"The Iocrym killed her. Bring me examples of their defenses and I'll build the weapon that will humble them.\""
											))

									(and (geq alienArmor 1) (eq alienShields 0))
										(setq desc (cat "The center of the lab has a massive testing area; a segment of armor on a static frame is being subjected to intense energies.\n\n"
											"Gustav walks over to you and points to the test: \"We are making good progress.  As you can see high energy plasmas can damage the Iocrym armor. Positron beams are also effective, but we've had the best results from antiprotons. Of course we can't guarantee the weapon will effect their shields at all without one to examine.\""
											))

									(eq alienShields 1)
										(setq desc (cat "One side of the lab has a static frame holding a complex weapon; scientists and engineers work on it under Gustav's direction.\n\n"
											"Gustav walks over to you: \"Ah yes, We seem to have run into a wall with the Iocrym project. Critical components of the shield you provided are too damaged for analysis.\""
											))

									(and (eq alienArmor 0) (geq alienShields 2))
										(setq desc (cat "One side of the lab has a static frame holding a complex weapon; scientists and engineers work on it under Gustav's direction.\n\n"
											"Gustav walks over to you: \"We've confirmed a flaw in their shields similar to that found in human and neohuman shields. It may be fundamental to energy shielding in general.\""
											))

									(setq desc (cat "The center of the lab has a massive testing area; a dangerous-looking weapon attached to a static frame burns a hole in a sample of blast plate.\n\n"
										"Gustav walks over to you and points at the test: \"We have a breakthrough. Using a plasma sheath around an antiproton bolt even Iocrym shields can be penetrated."
										))
									)

								(scrSetDesc gScreen desc)
								)
						</OnPaneInit>

						<Actions>
							<Action name="Offer item" default="1" key="O">
								(scrShowScreen gScreen "OfferItem")
							</Action>

							<Action name="Leave" cancel="1" key="L">
								(scrShowScreen gScreen "Main")
							</Action>
						</Actions>
					</Default>
				</Panes>
			</ResearchLab>

			<OfferItem
				name=				"=(objGetName gSource)"
				type=				"itemPicker"
				backgroundID=		"&rsItemListScreen;"
				>

				<ListOptions
					dataFrom=	"player"
					list=		"asU +Alien"
					/>

				<Panes>
					<Default>
						<OnPaneInit>
							(block Nil
								(setq gItem (scrGetItem gScreen))
								(if gItem
									(scrSetDesc gScreen (cat "Offer " (itmGetName gItem 0x0004) "."))
									(block Nil
										(scrSetDesc gScreen "Gustav is not interested in any of the items in your cargo hold.")
										(scrEnableAction gScreen 0 Nil)
										)
									)
								)
						</OnPaneInit>

						<Actions>
							<Action name="Offer item" default="1" key="O">
								(block (code)
									(setq code 0)

									; Check if the item is an Iocrym shield
									(if (or (eq &itIocrymCocoon; (itmGetUNID gItem)) (eq &itIocrymVeil; (itmGetUNID gItem)))
											(objIncData gSource "AlienShields" (if (itmIsDamaged gItem)
											(block nil (setq code 1) 1)
											(block nil (setq code 2) 2)
											))
									)

									; Check if the item is an Iocrym armor
									(if (or (eq &itIocrymPlate; (itmGetUNID gItem)) (eq &itLightIocrymPlate; (itmGetUNID gItem)))
											(objIncData gSource "AlienArmor" (block nil (setq code 3) 1))
									)

									; figure out Gustav's response
									(switch
										(eq code 0)
											(setq gTitle (cat "Gustav is disappointed: \"This appears to be of neohuman manufacture. I don't think it will help me.\""))
										(eq code 1)
											(setq gTitle (cat "Gustav is pleased: \"This " (itmGetName gItem 0x0000) " is rather battered. It will help, but I will probably need another.\""))
										(eq code 2)
											(setq gTitle (cat "Gustav is impressed: \"This " (itmGetName gItem 0x0000) " looks to be completely intact! It will probably be sufficient to devise a countermeasure.\""))
										(eq code 3)
											(setq gTitle (cat "Gustav is pleased: \"This " (itmGetName gItem 0x0000) " will do nicely. There should be more than enough material here for testing.\""))
									)

									; Transfer the item
									(if (not(eq code 0)) (objRemoveItem gPlayerShip gItem 1))


									; Done
									(scrShowScreen gScreen "Reward")
									)
							</Action>

							<Action name="Cancel" cancel="1" key="C">
								(scrShowScreen gScreen "ResearchLab")
							</Action>
						</Actions>
					</Default>
				</Panes>
			</OfferItem>

			<Reward>
				<Panes>
					<Default>
						<OnPaneInit>
							(scrSetDesc gScreen gTitle)
						</OnPaneInit>

						<Actions>
							<Action name="Continue" default="1" cancel="1" key="C">
									(block Nil
										(if (and (and (geq (objGetData gSource "AlienArmor" ) 1) (geq (objGetData gSource "AlienShields" ) 2)) (not (objGetData gSource "GiftGiven")))
											(block nil
												(objAddItem gPlayerShip (itmCreate &nwiHoedhr; 1))
												(objSetData gSource "GiftGiven" True)
											(scrShowPane gScreen "Gift")
											)
									(scrShowScreen gScreen "ResearchLab")
									))
									
							</Action>
						</Actions>
					</Default>

					<Gift>
						<OnPaneInit>
							(block Nil
								(scrSetDesc gScreen (cat "Gustav thanks you for helping his research:\n\n"
									"\"Take this weapon. Go kill the Iocrym so Helga can rest in peace. And when you find Domina remember the blood on her hands.\""
										)
									)
								)
						</OnPaneInit>

						<Actions>
							<Action name="Continue" default="1" cancel="1" key="C">
								(scrShowScreen gScreen "Main")
							</Action>
						</Actions>
					</Gift>
				</Panes>
			</Reward>

			<SecondaryLab>
				<Panes>
					<Default
						desc=	"The lab is filled with racks of equipment and testing structures. A small number of researchers are testing the quality and reliability of various items."
						>
						<Actions>
							<Action name="Leave" default="1" cancel="1" key="L">
								(scrShowScreen gScreen "Main")
							</Action>
						</Actions>
					</Default>
				</Panes>
			</SecondaryLab>

		</DockScreens>

		<DockingPorts>
			<Port x="0"		y="70" />
			<Port x="0"		y="-70" />
			<Port x="50"	y="50" />
			<Port x="50"	y="-50" />
			<Port x="70"	y="0" />
			<Port x="-70"	y="0" />
			<Port x="-50"	y="50" />
			<Port x="-50"	y="-50" />
		</DockingPorts>

	</StationType>


<!-- Superconducting Shield recharge invocation moved from coil to shield to allow reuse of 'L' for other shield invocations-->

	<ItemType UNID="&itSuperconductingShields;"
			name=				"superconducting shield generator"
			level=				"5"
			value=				"8000"
			mass=				"1600"
			frequency=			"rare"
			attributes=			"MajorItem; Specialty"

			description=		"This generator uses an array of superconducting coils. Individual coils must be replaced to restore the field after damage is taken."
			>

		<Image imageID="&rsItems1;" imageX="192" imageY="0" imageWidth="96" imageHeight="96"/>

		<Shields
				hitPoints=		"200"
				hpBonus=		"+200,+200, +50, +50"
				regen=			"0"
				depletionDelay=	"0"
				powerUse=		"50"
				/>
	<Invoke key="L" installedonly="true">
		(if (objHasItem gPlayerShip (itmCreate &itSuperconductingCoil; 1) )
			(block Nil
				(shpRechargeShield gPlayerShip (random 40 60))
				(objRemoveItem gPlayerShip (itmCreate &itSuperconductingCoil; 1))
				(objSendMessage gPlayerShip Nil "Superconducting shields recharged")
			)
			(objSendMessage gSource nil "No Superconducting Coils")
		)
	</Invoke>

		</ItemType>

<ItemType UNID="&itSuperconductingCoil;"
		name=				"superconducting coil"
		level=				"4"
		value=				"50"
		mass=				"100"
		frequency=			"uncommon"
		numberAppearing=	"1d6+1"
		attributes=			"Consumable"

		description=		"This is a special type of coil used to repair superconducting shield generators."
		>

	<Image imageID="&rsItems1;" imageX="288" imageY="480" imageWidth="96" imageHeight="96"/>
	<Invoke>
		(switch
			; Does the ship have a superconducting shield? If not
			; then we can't do anything.
			(not (eq (shpGetShieldItemUNID gSource) &itSuperconductingShields;))
				(objSendMessage gSource Nil "Superconducting shields required")

			; Are the shields fully charged? If they are, then this
			; won't do anything.
			(eq (shpGetShieldDamage gSource) 0)
				(objSendMessage gSource Nil "Superconducting shields already fully charged")

			; Charge the shields
			(block Nil
				(shpRechargeShield gSource (random 40 60))
				(objRemoveItem gSource gItem 1)
				(objSendMessage gSource Nil "Superconducting shields recharged")
				)
			)
	</Invoke>

</ItemType>



<ItemTable UNID="&nwwrtStarfire;"> <!--General table for the Starfire MBS-->
	<Table>
		<Item chance="20" count="4d20"	item="&nwiSMBSLaser;" />
		<Item chance="20" count="4d20"	item="&nwiSMBSParticle;" />
		<Item chance="20" count="4d20"	item="&nwiSMBSEMP;" />
		<Item chance="20" count="4d20"	item="&nwiSMBSIon;" />
		<Item chance="20" count="4d20"	item="&nwiSMBSPositron;" />
	</Table>
</ItemTable>

<ItemTable UNID="&nwwrtClaymore;"> <!--General table for the Claymore launcher-->
	<Table>
		<Item chance="20" count="4d20"	item="&nwiCVPLKinetic;" />
		<Item chance="20" count="4d20"	item="&nwiCVPLRadio;" />
		<Item chance="20" count="4d20"	item="&nwiCVPLBlast;" />
		<Item chance="20" count="4d20"	item="&nwiCVPLThermo;" />
		<Item chance="20" count="4d20"	item="&nwiCVPLPlasma;" />
	</Table>
</ItemTable>

<ItemTable UNID="&nwwrtParthian;"> <!--General table for the Parthian and Trafalgar launchers-->
	<Table>
		<Item chance="12" count="4d20"	item="&nwiSMShotput;" />
		<Item chance="14" count="4d20"	item="&nwiTMHammer;" />
		<Item chance="14" count="4d20"	item="&nwiTMJavelin;" />
		<Item chance="12" count="4d20"	item="&nwiSMMjolnir;" />
		<Item chance="12" count="4d20"	item="&nwiSMScythe;" />
		<Item chance="12" count="4d20"	item="&nwiTMOdysseus;" />
		<Item chance="12" count="4d20"	item="&nwiSMScythe2;" />
		<Item chance="12" count="4d20"	item="&nwiTMMistletoe;" />
	</Table>
</ItemTable>

<!--	unknown type for the breacher	-->


	<ItemType UNID="&itBreacherUnknown;"
			name=				"unknown breacher cannon"
			virtual=			"true"
			level = "5"
			value=				"7000"

			description=		"This cannon fires specially designed munitions with shield penetrating capabilities."

			attributes=			"unknown"
			>

		<Names>
			Cannon labeled "Northwind"; Cannon labeled "Beuwulf"; Cannon labeled "E mare libertas"; 
			Cannon labeled "Das Ring des Nibelungs"; Cannon labeled "Roland"; Cannon labeled "Surtur"; 
			Cannon labeled "Dura lex, sed lex"; Cannon labeled "Dura necessitas"; Cannon labeled "Exitus acta probat"; 
		</Names>
	</ItemType>

</TranscendenceModule>
